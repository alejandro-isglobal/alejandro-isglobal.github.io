% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{book}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{plainnat}
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Statistical Data Analysis},
  pdfauthor={Alejandro Caceres},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Statistical Data Analysis}
\author{Alejandro Caceres}
\date{2023-10-23}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{about}{%
\chapter{About}\label{about}}

This book serves as the course material for statistical data analysis (SDA). The course is designed for students enrolled in the Master of Multidisciplinary Research in Experimental Sciences program at the Barcelona Institute of Science and Technology (\href{https://bist.eu/}{BIST}).

The primary objective of the course is to provide students with a comprehensive and unified understanding of statistical thinking. Emphasis is placed on both conceptual and know-how levels of comprehension. Students are expected to have prior exposure to basic statistical concepts at the degree level and/or related mathematical courses.

Statistics is expressed in mathematical language and implemented using programming languages. While we will utilize both languages, this is not a mathematics or programming course. The main goal is to grasp the application of statistical thinking and its solutions in scientific inquiry. Having clarified this, the course aims to help develop a proficient use of both mathematical concepts and programming functions without focusing on theorem demonstrations or code compilations.

Our focus lies in understanding nature, and we need the right prose to effectively communicate about it.

\hypertarget{how}{%
\section{How}\label{how}}

The course is typically divided into \textbf{theory} and \textbf{practical} classes (Bootcamps). The classes on theory are subdivided into statistics (the present material) and complemented with introduction to machine learning, and Bayesian inference.

The statistics theory is covered in three weeks of intense work. They comprise a total of 30 hours: 24 plenary lectures (24 hours) divided in

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Descriptive statistics and probability (4 days)
\item
  Group work session 1 (3 hours)
\item
  Inference (4 days)
\item
  Group work session 2 (3 hours)
\end{enumerate}

Evaluation: There will be a written exam (\(60\%\)) on the \textbf{31st of October} and a report of group practicals (\(40\%\)). These grades will constitute the \(64\%\) of the SDA grade. Machine learning (\(18\%\)) and Bayesian statistics (\(18\%\)) modules comprise the rest.

Evaluation objectives:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Knowledge on how to describe and interpret data in tables and figures using Python.
\item
  Understanding of joint probability, conditional probability and Bayes theorem. Ability to read off information from contingency and conditional tables.
\item
  Knowledge on how to identify probability models and ability to compute their probabilities in Python.
\item
  Understanding the distributions of the sample mean and sample sum, and the concept of estimators. knowledge of the central limit theorem and when to apply it.
\item
  Understanding and know how to compute confidence intervals in python.
\item
  Ability to formulate hypothesis tests in different situations. Interpretation of the p-value.
\item
  Ability to perform and interpret the results using Python commands and output for different statistical tests depending of the type of data.
\end{enumerate}

The theory test will combine multiple choice questions and the solution of exercises.

\hypertarget{schedule}{%
\section{Schedule}\label{schedule}}

Statistics theory classes are shown in the orange blocks with the chapters within.

\includegraphics{./figures/calendario.png}

\hypertarget{recommended-reading-list}{%
\section{Recommended reading list}\label{recommended-reading-list}}

If further reading is desired for more applications with good mathematical background, I suggest:

\begin{itemize}
\tightlist
\item
  Douglas C. Montgomery and George C. Runger. ``Applied Statistics and Probability for Engineers'' 4th Edition. Wiley 2007.
\end{itemize}

If you are looking for mathematical demonstrations but keeping an eye on applications:

\begin{itemize}
\tightlist
\item
  Irwin Miller and Marylees Miller. ``John E. Freund's Mathematical Statistics'' 8th Edition.
\end{itemize}

\hypertarget{data-description}{%
\chapter{Data description}\label{data-description}}

In this chapter, we will introduce tools for describing data.

We will do so using tables, figures, and descriptive statistics of central tendency and dispersion.

We will also introduce key concepts in statistics such as random experiments, observations, outcomes, and absolute and relative frequencies.

\hypertarget{scientific-method}{%
\section{Scientific method}\label{scientific-method}}

One of the goals of the scientific method is to provide a framework for solving problems that arise in the study of natural phenomena or in the design of new technologies.

Modern humans have developed a \textbf{method} over thousands of years that is still in development.

The method has three main human activities:

\begin{itemize}
\tightlist
\item
  \emph{Observation} characterized by the acquisition of \textbf{data}
\item
  \emph{Reason} characterized by the development of mathematical \textbf{models}
\item
  \emph{Action} characterized by the development of new \textbf{experiments} (technology)
\end{itemize}

Their complex interaction and results are the basis of \emph{scientific activity}.

\includegraphics{./figures/stats.JPG}

\textbf{Statistics} deals with the interaction between \emph{models} and \emph{data} (the bottom part of the figure).

The statistical questions are:

\begin{itemize}
\tightlist
\item
  What is the best model for my data (inference)?
\item
  What are the data that a certain model (prediction) would produce?
\end{itemize}

\hypertarget{data}{%
\section{Data}\label{data}}

The data is presented in the form of observations.

An \textbf{Observation} or \textbf{Realization} is the acquisition of a number or characteristic of an experiment.

For example, let's take the series of numbers produced by repeating an experiment (1: success, 0: failure).

\ldots{} 1 0 0 1 0 \textbf{1} 0 1 1 \ldots{}

The number in bold is \textbf{an observation} in a repeat of the experiment

An \textbf{outcome} is a \textbf{possible} observation that is the result of an experiment.

\textbf{1} is one result, \textbf{0} is the other result of the experiment.

Remember that the observation is \textbf{concrete} is the number you get one day in the laboratory. The \textbf{abstract} result is one of the characteristics of the type of experiment you are running.

\hypertarget{result-types}{%
\section{Result types}\label{result-types}}

In statistics we are mainly interested in two types of results.

\begin{itemize}
\item
  \textbf{Categorical}: If the result of an experiment is a quality. They can be nominal (binary: yes, no; multiple: colors) or ordinal when the qualities can be ranked (severity of a disease).
\item
  \textbf{Numeric}: If the result of an experiment is a number. The number can be discrete (number of emails received in an hour, number of leukocytes in the blood) or continuous (battery charge status, engine temperature).
\end{itemize}

\hypertarget{random-experiments}{%
\section{Random experiments}\label{random-experiments}}

It can be said that the subject of study of statistics is random experiments, the means by which we produce data.

\textbf{Definition:}

A \textbf{random experiment} is an experiment that gives different results when repeated in the same way.

Random experiments are of different types, depending on how they are conducted:

\begin{itemize}
\tightlist
\item
  on the same object (person): temperature, sugar levels.
  different objects but of the same size: the weight of an animal.
\item
  about events: the number of hurricanes per year.
\end{itemize}

\hypertarget{absolute-frequencies}{%
\section{Absolute frequencies}\label{absolute-frequencies}}

When we repeat a Random experiment with \textbf{categorical} results, we record a list of results.

We summarize observations by counting how many times we saw a particular result.

\textbf{Absolute frecuency}:

\[ n_i \]

is the number of times we observe the result \(i\).

\textbf{Example (leukocytes)}

Let's take a leukocyte from \textbf{a} donor and write down its type. Let's repeat the experiment \(N=119\) times.

\begin{verbatim}
(T cell, T cell, Neutrophil, ..., B cell)
\end{verbatim}

The second \textbf{T cell} in bold is the second observation. The last \textbf{B cell} is observation number 119.

We can list the \textbf{results} (categories) in a \textbf{frequency table}:

\begin{verbatim}
##      outcome ni
## 1     T Cell 34
## 2     B cell 50
## 3   basophil 20
## 4   Monocyte  5
## 5 Neutrophil 10
\end{verbatim}

From the table, we can say that, for example, \(n_1=34\) is the total number of T cells observed in the repeat experiment. We also note that the total number of repetitions \(N=\sum_i n_i = 119\).

\hypertarget{relative-frequencies}{%
\section{Relative frequencies}\label{relative-frequencies}}

We can also summarize observations by calculating the \textbf{proportion} of how many times we saw a particular result.

\[ f_i = n_i /N\] where \(N\) is the total number of observations

In our example, \(n_1=34\) T cells were recorded, so we asked about the proportion of T cells out of the total \(119\). We can add these proportions \(f_i\) in the frequency table.

\begin{verbatim}
##      outcome ni         fi
## 1     T Cell 34 0.28571429
## 2     B cell 50 0.42016807
## 3   basophil 20 0.16806723
## 4   Monocyte  5 0.04201681
## 5 Neutrophil 10 0.08403361
\end{verbatim}

Relative frequencies are \textbf{fundamental} in statistics. They give the proportion of one result in relation to the other results. Later we will understand them as the observations of probabilities.

For absolute and relative frequencies we have the properties

\begin{itemize}
\tightlist
\item
  \(\sum_{i=1..M} n_i = N\)
\item
  \(\sum_{i=1..M} f_i = 1\)
\end{itemize}

where \(M\) is the number of results.

\hypertarget{bar-chart}{%
\section{Bar chart}\label{bar-chart}}

When we have a lot of results and want to see which ones are most likely, we can use a bar chart that is a number of \(n_i\) Vs the results.

\includegraphics{_main_files/figure-latex/unnamed-chunk-3-1.pdf}

\hypertarget{pie-chart-pie}{%
\section{Pie chart (pie)}\label{pie-chart-pie}}

We can also visualize the relative frequencies with a pie chart.

The area of the circle represents 100\% of the observations (proportion = 1) and the sections the relative frequencies of each result.

\includegraphics{_main_files/figure-latex/unnamed-chunk-4-1.pdf}

\hypertarget{ordinal-categorical-variables}{%
\section{Ordinal categorical variables}\label{ordinal-categorical-variables}}

The leukocyte type in the above examples is a \textbf{categorical} nominal variable. Each observation belongs to a category (quality). The categories do not always have a certain order .

Sometimes \textbf{categorical} variables can be \textbf{sorted} when they meet a natural ranking. This allows you to compute \textbf{cumulative frequencies}.

\textbf{Example (Misophonia)}

This is a clinical study on 123 patients who were examined for their degree of misophonia. Misophnia is uncontrolled anxiety/anger produced by certain sounds .

Each patient was evaluated with a questionnaire (AMISO) and they were classified into 4 different groups according to severity.

The results of the study are

\begin{verbatim}
##   [1] 4 2 0 3 0 0 2 3 0 3 0 2 2 0 2 0 0 3 3 0 3 3 2 0 0 0 4 2 2 0 2 0 0 0 3 0 2
##  [38] 3 2 2 0 2 3 0 0 2 2 3 3 0 0 4 3 3 2 0 2 0 0 0 2 2 0 0 2 3 0 1 3 2 4 3 2 3
##  [75] 0 2 3 2 4 1 2 0 2 0 2 0 2 2 4 3 0 3 0 0 0 2 2 1 3 0 0 3 2 1 3 0 4 4 2 3 3
## [112] 3 0 3 2 1 2 3 3 4 2 3 2
\end{verbatim}

Each observation is the result of a Random experiment: measurement of the level of misophonia in a patient. This data series can be summarized in terms of the results in the frequency table

\begin{verbatim}
##   outcome ni         fi
## 1       0 41 0.33333333
## 2       1  5 0.04065041
## 3       2 37 0.30081301
## 4       3 31 0.25203252
## 5       4  9 0.07317073
\end{verbatim}

\hypertarget{absolute-and-relative-cumulative-frequencies}{%
\section{Absolute and relative cumulative frequencies}\label{absolute-and-relative-cumulative-frequencies}}

Misophonia severity is \textbf{categorical} \textbf{ordinal} because its results can be ordered relative to its degree.

When the results can be ordered, it is useful to ask how many observations were obtained up to a given result. We call this number the \textbf{absolute cumulative frequency} up to the result \(i\):
\[N_i =\sum_{k= 1..i } n_k\]
It is also useful for calculating the \textbf{proportion} of observations up to a given result.

\[F_i =\sum_{k= 1..i } f_k\]

We can add these frequencies in the \textbf{frequency table}

\begin{verbatim}
##   outcome ni         fi  Ni        Fi
## 0       0 41 0.33333333  41 0.3333333
## 1       1  5 0.04065041  46 0.3739837
## 2       2 37 0.30081301  83 0.6747967
## 3       3 31 0.25203252 114 0.9268293
## 4       4  9 0.07317073 123 1.0000000
\end{verbatim}

Therefore, \textbf{67\%} of patients had misophonia up to severity \textbf{2} and \textbf{37\%} of patients had severity less than or equal to \textbf{1}.

\hypertarget{cumulative-frequency-graph}{%
\section{Cumulative frequency graph}\label{cumulative-frequency-graph}}

\(F_i\) is an important quantity because it allows us to define the accumulation of probabilities down to intermediate levels.

The probability of an intermediate level \(x\) (\(i\leq x< i+1\)) is just the accumulation up to the lower level \(F_x = F_i\).

\(F_x\) is therefore a function on a \textbf{continuous} range of values. We can draw it with respect to the results.

\includegraphics{_main_files/figure-latex/unnamed-chunk-8-1.pdf}

Therefore, we can say that \textbf{67\%} of the patients had misophonia up to severity \(2.3\), although \(2.3\) is not an observed outcome.

\hypertarget{numeric-variables}{%
\section{Numeric variables}\label{numeric-variables}}

The result of a random experiment can produce a number. If the number is \textbf{discrete}, we can generate a frequency table, with absolute, relative, and cumulative frequencies, and illustrate them with bar, pie, and cumulative charts.

When the number is \textbf{continuous} the frequencies are not useful, we are most likely to observe or not observe a particular continuous number.

\textbf{Example (misophonia)}

The researchers wondered if the convexity of the jaw would affect the severity of misophonia. The scientific hypothesis is that the angle of convexity of the jaw can influence hearing and its sensitivity. These are the mandibular convexity results (degrees) for each patient:

\begin{verbatim}
##   [1]  7.97 18.23 12.27  7.81  9.81 13.50 19.30  7.70 12.30  7.90 12.60 19.00
##  [13]  7.27 14.00  5.40  8.00 11.20  7.75  7.94 16.69  7.62  7.02  7.00 19.20
##  [25]  7.96 14.70  7.24  7.80  7.90  4.70  4.40 14.00 14.40 16.00  1.40  9.76
##  [37]  7.90  7.90  7.40  6.30  7.76  7.30  7.00 11.23 16.00  7.90  7.29  6.91
##  [49]  7.10 13.40 11.60 -1.00  6.00  7.82  4.80 11.00  9.00 11.50 16.00 15.00
##  [61]  1.40 16.80  7.70 16.14  7.12 -1.00 17.00  9.26 18.70  3.40 21.30  7.50
##  [73]  6.03  7.50 19.00 19.01  8.10  7.80  6.10 15.26  7.95 18.00  4.60 15.00
##  [85]  7.50  8.00 16.80  8.54  7.00 18.30  7.80 16.00 14.00 12.30 11.40  8.50
##  [97]  7.00  7.96 17.60 10.00  3.50  6.70 17.00 20.26  6.64  1.80  7.02  2.46
## [109] 19.00 17.86  6.10  6.64 12.00  6.60  8.70 14.05  7.20 19.70  7.70  6.02
## [121]  2.50 19.00  6.80
\end{verbatim}

\hypertarget{transforming-continuous-data}{%
\section{Transforming continuous data}\label{transforming-continuous-data}}

Since continuous outcomes cannot be counted (informatively), we transform them into ordered categorical variables.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  First we cover the range of observations in regular intervals of the same size (bins)
\end{enumerate}

\begin{verbatim}
## [1] "[-1.02,3.46]" "(3.46,7.92]"  "(7.92,12.4]"  "(12.4,16.8]"  "(16.8,21.3]"
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  Then we map each observation to its interval: creating a categorical variable \textbf{ordered}; in this case with 5 possible outcomes
\end{enumerate}

\begin{verbatim}
##   [1] "(7.92,12.4]"  "(16.8,21.3]"  "(7.92,12.4]"  "(3.46,7.92]"  "(7.92,12.4]" 
##   [6] "(12.4,16.8]"  "(16.8,21.3]"  "(3.46,7.92]"  "(7.92,12.4]"  "(3.46,7.92]" 
##  [11] "(12.4,16.8]"  "(16.8,21.3]"  "(3.46,7.92]"  "(12.4,16.8]"  "(3.46,7.92]" 
##  [16] "(7.92,12.4]"  "(7.92,12.4]"  "(3.46,7.92]"  "(7.92,12.4]"  "(12.4,16.8]" 
##  [21] "(3.46,7.92]"  "(3.46,7.92]"  "(3.46,7.92]"  "(16.8,21.3]"  "(7.92,12.4]" 
##  [26] "(12.4,16.8]"  "(3.46,7.92]"  "(3.46,7.92]"  "(3.46,7.92]"  "(3.46,7.92]" 
##  [31] "(3.46,7.92]"  "(12.4,16.8]"  "(12.4,16.8]"  "(12.4,16.8]"  "[-1.02,3.46]"
##  [36] "(7.92,12.4]"  "(3.46,7.92]"  "(3.46,7.92]"  "(3.46,7.92]"  "(3.46,7.92]" 
##  [41] "(3.46,7.92]"  "(3.46,7.92]"  "(3.46,7.92]"  "(7.92,12.4]"  "(12.4,16.8]" 
##  [46] "(3.46,7.92]"  "(3.46,7.92]"  "(3.46,7.92]"  "(3.46,7.92]"  "(12.4,16.8]" 
##  [51] "(7.92,12.4]"  "[-1.02,3.46]" "(3.46,7.92]"  "(3.46,7.92]"  "(3.46,7.92]" 
##  [56] "(7.92,12.4]"  "(7.92,12.4]"  "(7.92,12.4]"  "(12.4,16.8]"  "(12.4,16.8]" 
##  [61] "[-1.02,3.46]" "(12.4,16.8]"  "(3.46,7.92]"  "(12.4,16.8]"  "(3.46,7.92]" 
##  [66] "[-1.02,3.46]" "(16.8,21.3]"  "(7.92,12.4]"  "(16.8,21.3]"  "[-1.02,3.46]"
##  [71] "(16.8,21.3]"  "(3.46,7.92]"  "(3.46,7.92]"  "(3.46,7.92]"  "(16.8,21.3]" 
##  [76] "(16.8,21.3]"  "(7.92,12.4]"  "(3.46,7.92]"  "(3.46,7.92]"  "(12.4,16.8]" 
##  [81] "(7.92,12.4]"  "(16.8,21.3]"  "(3.46,7.92]"  "(12.4,16.8]"  "(3.46,7.92]" 
##  [86] "(7.92,12.4]"  "(12.4,16.8]"  "(7.92,12.4]"  "(3.46,7.92]"  "(16.8,21.3]" 
##  [91] "(3.46,7.92]"  "(12.4,16.8]"  "(12.4,16.8]"  "(7.92,12.4]"  "(7.92,12.4]" 
##  [96] "(7.92,12.4]"  "(3.46,7.92]"  "(7.92,12.4]"  "(16.8,21.3]"  "(7.92,12.4]" 
## [101] "(3.46,7.92]"  "(3.46,7.92]"  "(16.8,21.3]"  "(16.8,21.3]"  "(3.46,7.92]" 
## [106] "[-1.02,3.46]" "(3.46,7.92]"  "[-1.02,3.46]" "(16.8,21.3]"  "(16.8,21.3]" 
## [111] "(3.46,7.92]"  "(3.46,7.92]"  "(7.92,12.4]"  "(3.46,7.92]"  "(7.92,12.4]" 
## [116] "(12.4,16.8]"  "(3.46,7.92]"  "(16.8,21.3]"  "(3.46,7.92]"  "(3.46,7.92]" 
## [121] "[-1.02,3.46]" "(16.8,21.3]"  "(3.46,7.92]"
\end{verbatim}

Therefore, instead of saying that the first patient had an angle of convexity of \(7.97\), we say that his angle was between the interval (or \textbf{bin}) \((7.92,12.4]\).

No other patients had an angle of \(7.97\), but many had angles between \((7.92,12.4]\).

\hypertarget{frequency-table-for-a-continuous-variable}{%
\section{Frequency table for a continuous variable}\label{frequency-table-for-a-continuous-variable}}

For a given regular partition of the interval of results into intervals, we can produce a frequency table as before

\begin{verbatim}
##        outcome ni         fi  Ni         Fi
## 1 [-1.02,3.46]  8 0.06504065   8 0.06504065
## 2  (3.46,7.92] 51 0.41463415  59 0.47967480
## 3  (7.92,12.4] 26 0.21138211  85 0.69105691
## 4  (12.4,16.8] 20 0.16260163 105 0.85365854
## 5  (16.8,21.3] 18 0.14634146 123 1.00000000
\end{verbatim}

\hypertarget{histogram}{%
\section{Histogram}\label{histogram}}

The histogram is the graph of \(n_i\) or \(f_i\) Vs the results in intervals (bins). The histogram depends on the size of the bins .

\includegraphics{_main_files/figure-latex/unnamed-chunk-13-1.pdf}

This is a histogram with 20 bins .

\includegraphics{_main_files/figure-latex/unnamed-chunk-14-1.pdf}

We see that most people have angles within \((7, 8]\)

\hypertarget{cumulative-frequency-graph-1}{%
\section{Cumulative frequency graph}\label{cumulative-frequency-graph-1}}

We can also plot \(F_x\) against the results. Since \(F_x\) is of continuous range, we can order the observations (\(x_1 <... x_j < x_{j+1} < x_n\)) and therefore

\[F_x = \frac{k}{ n}\]

for \(x_{k} \leq x < x_{k+ 1}\) .

\(F_x\) is known as the \textbf{distribution} of the data. \(F_x\) does not depend on the size of the bin. However, its \textbf{resolution} depends on the amount of data.

\includegraphics{_main_files/figure-latex/unnamed-chunk-15-1.pdf}

\hypertarget{summary-statistics}{%
\section{Summary Statistics}\label{summary-statistics}}

Summary statistics are numbers calculated from the data that tell us important characteristics of the numerical variables (discrete or continuous).

For example, we have statistics that describe extreme values:

\begin{itemize}
\tightlist
\item
  \textbf{minimum}: the minimum result observed
\item
  \textbf{maximum}: the maximum result observed
\end{itemize}

\hypertarget{average-sample-mean}{%
\section{Average (sample mean)}\label{average-sample-mean}}

An important statistic that describes the central value of the results (where to expect most observations) is the \textbf{average}

\[\bar{x}=\frac{1}{N} \sum_{j= 1..N } x_j \]

where \(x_j\) is the \textbf{observation} \(j\) out of a total of \(N\).

\textbf{Example (Misophonia)}

The average convexity can be calculated directly from the \textbf{observations} in the usual way

\(\bar{x}= \frac{1}{ N}\sum_j x_j\)

\(= \frac{1}{ N}( 7.97 + 18.23 + 12.27... + 6.80) = 10.19894\)

For \textbf{categorically ordered} variables, we can \textbf{also} use the relative frequencies to calculate the average

\(\bar{x}=\frac{1}{ N}\sum_{i=1...N} x_j =\frac{1}{N}\sum_{i=1...M} x_i n_ {i}=\)
\[\sum_{i=1...M} x_i f_{i}\]

where we went from adding \(N\) \textbf{observations} to adding \(M\) \textbf{results}.

The form \(\bar{x}= \sum_{i = 1...M} x_i f_i\) shows that the average is the \textbf{center of gravity} of the results. As if each result had a mass density given by \(f_i\).

\textbf{Example (Misophonia)}

The average \textbf{severity} of misophonia in the study can be calculated from the relative frequencies of the \textbf{outcomes}

\begin{verbatim}
##   outcome ni         fi
## 1       0 41 0.33333333
## 2       1  5 0.04065041
## 3       2 37 0.30081301
## 4       3 31 0.25203252
## 5       4  9 0.07317073
\end{verbatim}

\(\bar{x}=0*f_ {0}+ 1*f_{1}+2*f_{2}+3*f_{3}+4*f_{4}=1.691057\)

The average is also the center of gravity for continuous variables. That is the point where the relative frequencies balance.

\includegraphics{_main_files/figure-latex/unnamed-chunk-17-1.pdf}

\hypertarget{median}{%
\section{Median}\label{median}}

Another measure of centrality is the median. The median \(x_m\), or \(q_{0.5}\), is the value below which we find half of the observations. When we order the observations \(x_1 <... x_j < x_{j+1} < x_N\), we count them until we find half of them. Therefore, \(x_m\) is the observation such that \(m\) satisfies

\[\sum_{i\leq m} 1 = \frac{N}{2}\]
\textbf{Example (Misophonia)}

If we order the angles of convexity, we see that \(62\) observations (individuals) (\(N/2 \sim 123/2\)) are below \(7.96\). The \textbf{median convexity} is therefore \(q_{0.5}= x_{62}=7.96\)

\begin{verbatim}
##  [1] -1.00 -1.00  1.40  1.40  1.80  2.46  2.50  3.40  3.50  4.40  4.60  4.70
## [13]  4.80  5.40  6.00  6.02  6.03  6.10  6.10  6.30  6.60  6.64  6.64  6.70
## [25]  6.80  6.91  7.00  7.00  7.00  7.00  7.02  7.02  7.10  7.12  7.20  7.24
## [37]  7.27  7.29  7.30  7.40  7.50  7.50  7.50  7.62  7.70  7.70  7.70  7.75
## [49]  7.76  7.80  7.80  7.80  7.81  7.82  7.90  7.90  7.90  7.90  7.90  7.94
## [61]  7.95  7.96
\end{verbatim}

\begin{verbatim}
##  [1]  7.96  7.97  8.00  8.00  8.10  8.50  8.54  8.70  9.00  9.26  9.76  9.81
## [13] 10.00 11.00 11.20 11.23 11.40 11.50 11.60 12.00 12.27 12.30 12.30 12.60
## [25] 13.40 13.50 14.00 14.00 14.00 14.05 14.40 14.70 15.00 15.00 15.26 16.00
## [37] 16.00 16.00 16.00 16.14 16.69 16.80 16.80 17.00 17.00 17.60 17.86 18.00
## [49] 18.23 18.30 18.70 19.00 19.00 19.00 19.00 19.01 19.20 19.30 19.70 20.26
## [61] 21.30
\end{verbatim}

We cut the data at

\begin{verbatim}
## [1] 7.96
\end{verbatim}

to split them in half.

In terms of frequencies, \(q_{0.5}\) makes the cumulative frequency \(F_x\) equal to \(0.5\)

\[\sum_{i = 0, ... m} f_i =F_{q_{0.5}}=0.5\]
that is

\[q_{ 0.5}= F^{-1}(0.5)\]

This last equation means that, in the distribution graph, the median \(q_{ 0.5}\) is the value of \(x\) at which we have climbed half of the total height of \(F\).

\includegraphics{_main_files/figure-latex/unnamed-chunk-21-1.pdf}

The mean and median are not always the same.

\includegraphics{_main_files/figure-latex/unnamed-chunk-22-1.pdf}

\hypertarget{dispersion}{%
\section{Dispersion}\label{dispersion}}

Other important summary statistics for observations are the \textbf{spread} statistics.

Many experiments may share their mean, but differ in how \textbf{sparse} the values are.

The dispersion of the observations is a measure of the \textbf{noise}.

\includegraphics{_main_files/figure-latex/unnamed-chunk-23-1.pdf} \includegraphics{_main_files/figure-latex/unnamed-chunk-23-2.pdf}

\hypertarget{sample-variance}{%
\section{Sample variance}\label{sample-variance}}

The dispersion about the mean is measured by the sample variance

\[s^2=\frac{ 1}{ N-1} \sum_{j=1..N} ( x_j -\bar{x})^2\]

This number measures the average squared distance of the \textbf{observations} from the average. The reason for \(N-1\) will be explained when we talk about inference, when we study the spread of \(\bar{x}\), as well as the spread of the observations.

In terms of the frequencies of the variables that are \textbf{categorical and ordered}, we can \textbf{also} calculate the sample variance as

\[s^2=\frac{N}{N-1} \sum_{i=1... M} (x_i -\bar{x})^2 f_i\]

\(s^2\) can be considered as the \textbf{moment of inertia} of the observations.

The square root of the sample variance, \(s\), is called \textbf{standard deviation} of the sample.

\textbf{Example (Misophonia)}

The standard deviation of the angle of convexity is

\(s= [\frac{ 1}{123-1}((7.97-10.19894)^2+ (18.23-10.19894)^2\)
\[+ (12.27-10.19894 )^ 2 + ...)]^{1/2} = 5.086707\]

The jaw convexity deviates from its mean by \(5.086707\).

\hypertarget{interquartile-range-iqr}{%
\section{Interquartile range (IQR)}\label{interquartile-range-iqr}}

The spread of the data can also be measured with respect to the median using the \textbf{interquartile range}:

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  We define the \textbf{first} quartile as the value \(x_m\) that makes the cumulative frequency \(F_{q_{0.25}}\) equal to \(0.25\) (or the value of \(x\) where we have accumulated a quarter of the observations, or the value that splits the first quarter of the observations)
\end{enumerate}

\[q_{0.25}=F^{-1}(0.25)\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  We define the \textbf{third} quartile as the value \(x_m\) that makes the cumulative frequency \(F_{q_{0.75}}\) equal to \(0.75\) (or the value of \(x\) where we have accumulated three quarters of observations)
\end{enumerate}

\[q_{0.75}=F^{-1}(0.75)\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  The \textbf{interquartile range} (IQR) is \[IQR=q_{0.75} - q_{0.25}\]
\end{enumerate}

This is the distance between the third and first quartiles and captures the central \(50\%\) of the observations

\includegraphics{_main_files/figure-latex/unnamed-chunk-24-1.pdf}

\hypertarget{boxplot}{%
\section{Boxplot}\label{boxplot}}

The interquartile range, median, and \(5\%\) and \(95\%\) of the data can be displayed in a \textbf{box plot}.

In the boxplot, the values of the results are on the y-axis. The IQR is the box, the median is the middle line, and the whiskers mark the \(5\%\) and \(95\%\) of the data.

\includegraphics{_main_files/figure-latex/unnamed-chunk-25-1.pdf}

\hypertarget{questions}{%
\section{Questions}\label{questions}}

\textbf{1)} In the following boxplot, the first quartile and second quartile of the data are:

\textbf{\(\qquad\)a:} \((-1.00, 21.30)\); \textbf{\(\qquad\)b:} \((-1.00, 7.02)\); \textbf{\(\qquad\)c:} \((7.02, 7.96)\); \textbf{\(\qquad\)d:} \((7.02, 14.22)\)

\includegraphics{./figures/box.png}

\textbf{2)} The main disadvantage of a histogram is that:

\textbf{\(\qquad\) a :} Depends on the size of the bin ; \textbf{\(\qquad\)b :} Cannot be used for categorical variables;
\textbf{\(\qquad\) c :} Cannot be used when the bin size is small;
\textbf{\(\qquad\) d :} Used only for relative frequencies;

\textbf{3)} If the relative cumulative frequencies of a random experiment with outcomes \(\{1,2,3,4\}\) are: \(F(1)=0.15, \qquad F(2)=0.60, \qquad F(3)=0.85, \qquad F(4)=1\).

Then the relative frequency for the outcome \(3\) is

\textbf{\(\qquad\)a:} \(0.15\); \textbf{\(\qquad\)b:} \(0.85\); \textbf{\(\qquad\)c:} \(0.45\); \textbf{\(\qquad\)d:} \(0.25\)

\textbf{4)} In a sample of size \(10\) from a random experiment we obtained the following data:

\(8, \qquad 3, \qquad 3, \qquad 7, \qquad 3, \qquad 6, \qquad 5, \qquad 10, \qquad 3, \qquad 8\).

The first quartile of the data is:

\textbf{\(\qquad\)a:} \(3.5\); \textbf{\(\qquad\)b:} \(4\); \textbf{\(\qquad\)c:} \(5\); \textbf{\(\qquad\)d:} \(3\)

\textbf{5)} Imagine that we collect data for two quantities that are not mutually exclusive, for example, the gender and nationality of passengers on a flight. If we want to make a single pie chart for the data, which of these statements is true?

\textbf{\(\qquad\)a :} We can \textbf{only} make a nationality pie chart because it has more than two possible outcomes;

\textbf{\(\qquad\)b :} We can make a pie graph for a new variable marking gender \textbf{and} nationality;

\textbf{\(\qquad\)c :} We can make a pie chart for the variable sex \textbf{or} the variable nationality;

\textbf{\(\qquad\)d :} We can only choose \textbf{whether} to make a pie chart for gender \textbf{or} a pie chart for nationality.

\hypertarget{exercises}{%
\section{Exercises}\label{exercises}}

\hypertarget{exercise-1}{%
\subsubsection{Exercise 1}\label{exercise-1}}

We have performed an experiment 8 times with the following results

\begin{verbatim}
## [1]  3  3 10  2  6 11  5  4
\end{verbatim}

Answer the following questions:

\begin{itemize}
\tightlist
\item
  Calculate the relative frequencies of each result.
\item
  Calculate the cumulative frequencies of each result.
\item
  What is the average of the observations?
\item
  What is the median?
\item
  What is the third quartile?
\item
  What is the first quartile?
\end{itemize}

\hypertarget{exercise-2}{%
\subsubsection{Exercise 2}\label{exercise-2}}

We have performed an experiment 10 times with the following results

\begin{verbatim}
##  [1] 2.875775 7.883051 4.089769 8.830174 9.404673 0.455565 5.281055 8.924190
##  [9] 5.514350 4.566147
\end{verbatim}

Consider 10 bins of size 1: {[}0,1{]}, (1,2{]} \ldots( 9,10).

Answer the following questions:

\begin{itemize}
\item
  Calculate the relative frequencies of each result and draw the histogram
\item
  Calculate the cumulative frequencies of each result and draw the cumulative graph.
\item
  Draw a box plot .
\end{itemize}

\hypertarget{practice}{%
\section{Practice}\label{practice}}

Load misophonia data from \url{https://alejandro-isglobal.github.io/SDA/data/data_0.txt}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Extract misophonia variable (Misofonia.dic)
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Do a bar plot and a pie chart
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Extract convexity angle variable (Angulo\(\_\)convexidad)
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Calculate its mean, standard deviation and make a histogram
\item
  Calculate its median and inter-quartile range
\item
  Draw a boxplot
\end{itemize}

\hypertarget{probability}{%
\chapter{Probability}\label{probability}}

In this chapter we will introduce the concept of probability from relative frequencies.

We will define the events as the elements on which the probability is applied. Composite events will be defined using set algebra.

Then we will discuss the concept of conditional probability derived from the joint probability of two events.

\hypertarget{random-experiments-1}{%
\section{Random experiments}\label{random-experiments-1}}

Let's remember the basic objective of statistics. Statistics deals with data that is presented in the form of observations.

\begin{itemize}
\tightlist
\item
  An \textbf{observation} is the acquisition of a number or characteristic from an experiment
\end{itemize}

Observations are realizations of \textbf{results}.

\begin{itemize}
\tightlist
\item
  An \textbf{outcome} is a possible observation that is the result of an experiment.
\end{itemize}

When conducting experiments, we often get different results. The description of the variability of the results is one of the objectives of statistics.

\begin{itemize}
\tightlist
\item
  A \textbf{random experiment} is an experiment that gives different results when repeated in the same way.
\end{itemize}

The philosophical question behind it is how can we know something if every time we look at it it changes?

\hypertarget{measurement-probability}{%
\section{Measurement probability}\label{measurement-probability}}

We would like to have a measure for the outcome of a randomized experiment that tells us \textbf{how sure} we are of observing the outcome when we perform a \textbf{future} randomized experiment.

We will call this measure the probability of the outcome and assign values to it:

\begin{itemize}
\item
  0, when we are sure that the observation will \textbf{not} occur.
\item
  1, when we are sure that the observation will happen.
\end{itemize}

\hypertarget{classical-probability}{%
\section{Classical probability}\label{classical-probability}}

\textbf{As long as} a random experiment has \(M\) possible outcomes that are all \textbf{equally likely}, the probability of each \(i\) outcome is \[P_i =\frac{1}{ M}\].

Classical probability was defended by Laplace (1814).

Since every outcome is \textbf{equally likely} in this type of experiment, we declare complete ignorance and the best we can do is equally distribute the same probability for each outcome.

\begin{itemize}
\tightlist
\item
  We do not observe \(P_i\)
\item
  We deduce \(P_i\) from our ratio and we don't need to carry out any experiment to know it.
\end{itemize}

\textbf{Example (dice):}

What is the probability that we will get \(2\) on the roll of a die?

\(P_2=1/6=0.166666\).

\hypertarget{relative-frequencies-1}{%
\section{Relative frequencies}\label{relative-frequencies-1}}

What about random experiments whose possible outcomes are \textbf{not} equally likely?

How then can we define the probabilities of the outcomes?

\textbf{Example (random experiment)}

Imagine that we repeat a random experiment \(8\) times and obtain the following observations

8 4 12 7 10 7 9 12

\begin{itemize}
\tightlist
\item
  How sure are we of obtaining the result \(12\) in the following observation?
\end{itemize}

The frequency table is

\begin{verbatim}
##   outcome ni    fi
## 1       4  1 0.125
## 2       7  2 0.250
## 3       8  1 0.125
## 4       9  1 0.125
## 5      10  1 0.125
## 6      12  2 0.250
\end{verbatim}

\includegraphics{_main_files/figure-latex/unnamed-chunk-29-1.pdf}

The \textbf{relative frequency} \(f_i =\frac{ n_ i }{ N}\) seems like a reasonable probability measure because

\begin{itemize}
\tightlist
\item
  is a number between \(0\) and \(1\).
\item
  measures the proportion of the total number of observations that we observe of a particular result.
\end{itemize}

Since \(f_{12}=0.25\) then we would be one quarter sure, one out of every 4 observations, of getting \(12\).

\textbf{Question}: How good is \(f_i\) as a measure of certainty of the result \(i\)?

\textbf{Example (random experiment with more repetitions)}

Let's say we repeat the experiment 100,000 more times:

The frequency table is now

\begin{verbatim}
##    outcome    ni      fi
## 1        2  2807 0.02807
## 2        3  5607 0.05607
## 3        4  8435 0.08435
## 4        5 11070 0.11070
## 5        6 13940 0.13940
## 6        7 16613 0.16613
## 7        8 13806 0.13806
## 8        9 10962 0.10962
## 9       10  8402 0.08402
## 10      11  5581 0.05581
## 11      12  2777 0.02777
\end{verbatim}

and the barplot is

\includegraphics{_main_files/figure-latex/unnamed-chunk-31-1.pdf}

New results came out and \(f_{12}\) is now only \(0.027\), and so we are only \(\sim 3\%\) sure to get \(12\) in the next experiment. The probabilities measured by \(f_i\) change with \(N\).

\hypertarget{relative-frequencies-at-infinity}{%
\section{Relative frequencies at infinity}\label{relative-frequencies-at-infinity}}

A crucial observation is that if we measure the probabilities of \(f_i\) in increasing values of \(N\) they \textbf{converge}!

In this graph each vertical section gives the relative frequency of each observation. We see that after \(N=1000\) (\(log10(N)=3\)) the proportions hardly change with more \(N\).

\includegraphics{_main_files/figure-latex/unnamed-chunk-32-1.pdf}

We find that each of the relative frequencies \(f_i\) converges to a constant value

\[lim_{N\rightarrow \infty} f_i = P_i\]

\hypertarget{frequentist-probability}{%
\section{Frequentist probability}\label{frequentist-probability}}

We call \textbf{Probability} \(P_i\) the limit as \(N \rightarrow \infty\) of the \textbf{relative frequency} of observing the outcome \(i\) in a random experiment.

Defended by Venn (1876), the frequentist definition of probability is derived from (empirical) data/experience.

\begin{itemize}
\tightlist
\item
  We do not observe \(P_i\), we observe \(f_i\)
\item
  \textbf{We estimate} \(P_i\) with \(f_i\) (usually when \(N\) is large), we write: \[\hat {P_ i}= f_i\]
\end{itemize}

Similar to the relationship between \textbf{observation} and \textbf{result}, we have the relationship between \textbf{relative frequency} and \textbf{probability} as a concrete value of an abstract quantity.

\hypertarget{classical-and-frequentist-probabilities}{%
\section{Classical and frequentist probabilities}\label{classical-and-frequentist-probabilities}}

We have situations where classical probability can be used to find the limit of relative frequencies:

\begin{itemize}
\tightlist
\item
  If the results are \textbf{equally probable}, the classical probability gives us the limit:
\end{itemize}

\[P_i=lim_{N\rightarrow \infty} \frac{n_i}{N}=\frac{1}{M}\]

\begin{itemize}
\tightlist
\item
  If the results in which we are interested can be derived from other \textbf{equally probable} results. We will see more about this when we study probability models.
\end{itemize}

\textbf{Example (sum of two dice)}

Our previous example is based on the \textbf{sum of two dice}.
Although we perform the experiment many times, write down the results, and calculate the \textbf{relative frequencies}, we can know the exact value of probability.

This probability \textbf{follows} from the fact that the outcome of each die is \textbf{equally likely}. From this assumption, we can find that (Exercise 1)

\[
    P_i =
\begin{cases}
\frac{i-1}{36},& i \in \{2,3,4,5,6, 7\} \\
\frac{13-i}{36},& i \in \{8,9,10,11,12\} \\
\end{cases}
\]

The motivation of the frequentist definition is \textbf{empirical} (data) while that of the classical definition is \textbf{rational} (models). We often combine both approaches (inference and deduction) to find out the probabilities of our random experiment.

\includegraphics{./figures/prob.JPG}

\hypertarget{definition-of-probability}{%
\section{Definition of probability}\label{definition-of-probability}}

A probability is a number that is assigned to each possible outcome of a random experiment and satisfies the following properties or \textbf{axioms}:

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  when the results \(E_1\) and \(E_2\) are mutually exclusive; that is, only one of them can occur, so the probability of observing \(E_1\) \textbf{or} \(E_1\), written as \(E_1\cup E_2\), is their sum:
  \[ P( E_1\cup E_2) = P(E_1) + P(E_2)\]
\item
  when \(S\) is the set of all possible outcomes, then its probability is \(1\) (at least something is observed): \[P(S)=1\]
\item
  The probability of any outcome is between 0 and 1 \[P(E) \in [0,1]\]
\end{enumerate}

Proposed by Kolmogorov's less than 100 years ago (1933)

\hypertarget{probabilities-table}{%
\section{Probabilities Table}\label{probabilities-table}}

Kolmogorov properties are the basic rules for building a \textbf{probability table}, similar to the relative frequency table.

\textbf{Example (dice)}

The probability table for the throw of a dice

\begin{longtable}[]{@{}cc@{}}
\toprule\noalign{}
result & probability \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(1\) & 1/6 \\
\(2\) & 1/6 \\
\(3\) & 1/6 \\
\(4\) & 1/6 \\
\(5\) & 1/6 \\
\(6\) & 1/6 \\
\(P( 1 \cup 2\cup ... \cup 6)\) & 1 \\
\end{longtable}

Let's verify the axioms:

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  Where \(1 \cup 2\) is, for example, the \textbf{event} of rolling a \(1\) \textbf{or} a \(2\). So \[ P( 1 \cup 2)=P(1)+P(2)=2/6\]
\item
  Since \(S= \{ 1,2,3,4,5,6\}\) is made up of \textbf{mutually exclusive} outcomes, then
\end{enumerate}

\[P(S)=P(1\cup 2\cup ... \cup 6) = P(1)+P(2)+ ...+P(n)=1\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  The probabilities of each outcome are between \(0\) and \(1\).
\end{enumerate}

\hypertarget{sample-space}{%
\section{Sample space}\label{sample-space}}

The set of all possible outcomes of a random experiment is called the \textbf{sample space} and is denoted \(S\).

The sample space can be made up of categorical or numerical outcomes.

\emph{For example:}

\begin{itemize}
\tightlist
\item
  human temperature: \(S = (36, 42)\) degrees Celsius.
\item
  sugar levels in humans: \(S =( 70-80) mg/ dL\)
\item
  the size of a production line screw: \(S =( 70-72) mm\)
\item
  number of emails received in an hour: \(S = \{ 1, ...\infty \}\)
\item
  the throw of a dice: \(S= \{ 1, 2, 3, 4, 5, 6\}\)
\end{itemize}

\hypertarget{events}{%
\section{Events}\label{events}}

An \textbf{event} \(A\) is a \textbf{subset} of the sample space. It is a \textbf{collection} of posible results.

\emph{Examples of events:}

\begin{itemize}
\tightlist
\item
  The event of a healthy temperature: \(A=37-38\) degrees Celsius
\item
  The event of producing a screw with a size: \(A=71.5mm\)
\item
  The event of receiving more than 4 emails in an hour: \(A= \{ 4, \infty \}\)
\item
  The event of obtaining a number less than or equal to 3 in the roll of a says: \(A= \{ 1,2,3\}\)
\end{itemize}

An event refers to a possible set of \textbf{outcomes}.

\hypertarget{algebra-of-events}{%
\section{Algebra of events}\label{algebra-of-events}}

For two events \(A\) and \(B\), we can construct the following derived events using the basic set operations:

\begin{itemize}
\tightlist
\item
  Complement \(A'\): the event of \textbf{not} \(A\)
\item
  Union \(A \cup B\): the event of \(A\) \textbf{or} \(B\)
\item
  Intersection \(A \cap B\): the event of \(A\) \textbf{and} \(B\)
\end{itemize}

\textbf{Example (dice)}

Let's roll a die and look at the events (result set):

\begin{itemize}
\tightlist
\item
  a number less than or equal to three \(A:\{ 1,2,3\}\)
\item
  an even number \(B:\{ 2,4,6\}\)
\end{itemize}

Let's see how we can build new events with set operations:

\begin{itemize}
\tightlist
\item
  a number not less than three: \(A ':\{4,5,6\}\)
\item
  a number less than or equal to three \textbf{or} even: \(A \cup B: \{ 1,2,3,4,6\}\)
\item
  a number less than or equal to three \textbf{and} even \(A \cap B: \{ 2\}\)
\end{itemize}

\hypertarget{mutually-exclusive-results}{%
\section{Mutually exclusive results}\label{mutually-exclusive-results}}

Outcomes like rolling \(1\) and \(2\) on a die are events that cannot occur at the same time. We say that they are \textbf{mutually exclusive}.

In general, two events denoted as \(E_1\) and \(E_2\) are mutually exclusive when

\[E_1\cap E_2=\emptyset\]

\emph{Examples:}

\begin{itemize}
\item
  The result of having a misophonia severity of \(1\) and a severity of \(4\).
\item
  The results of obtaining \(12\) and \(5\) by adding the throw of two dice.
\end{itemize}

According to the Kolmogorov properties, only \textbf{mutually exclusive} outcomes can be arranged in \textbf{probability tables}, as in relative frequency tables.

\hypertarget{joint-probabilities}{%
\section{Joint probabilities}\label{joint-probabilities}}

The \textbf{joint probability} of \(A\) and \(B\) is the probability of \(A\) and \(B\). That's \[P( A \cap B)\] or \(P(A,B)\).

To write joint probabilities of non mutually exclusive events (\(A \cap B \neq \emptyset\)) into a probability table, we note that we can always decompose the sample space into \textbf{mutually exclusive} sets involving the intersections:

\(S=\{A\cap B, A \cap B', A'\cap B, A'\cap B'\}\)

\textbf{Let's consider the Ven diagram} for the example where \(A\) is the event that corresponds to drawing a number less than or equal to 3 and \(B\) corresponds to an even number:

\includegraphics{./figures/Venn.JPG}

The \textbf{marginals} of \(A\) and \(B\) are the probability of \(A\) and the probability of \(B\), respectively:

\begin{itemize}
\tightlist
\item
  \(P(A)=P(A\cap B') + P(A \cap B)=2/6+1/6=3/6\)
\item
  \(P(B)=P(A'\cap B) +P(A \cap B)=2/6+1/6=3/6\)
\end{itemize}

We can now write the \textbf{probability table} for the joint probabilities

\begin{longtable}[]{@{}cc@{}}
\toprule\noalign{}
Result & probability \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\((A\cap B)\) & \(P(A \cap B)=1/6\) \\
\((A\cap B')\) & \(P(A \cap B')=2/6\) \\
\((A'\cap B)\) & \(P(A' \cap B)=2/6\) \\
\((A'\cap B')\) & \(P(A' \cap B')=1/6\) \\
sum & \(1\) \\
\end{longtable}

Each result has \(two\) values (one for the feature of type \(A\) and one for type \(B\))

\hypertarget{contingency-table}{%
\section{Contingency table}\label{contingency-table}}

The joint probability table can also be written in a \textbf{contingency table}

\begin{longtable}[]{@{}cccc@{}}
\toprule\noalign{}
& \(B\) & \(B'\) & sum \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(A\) & \(P(A \cap B )\) & \(P(A\cap B' )\) & \(P(A)\) \\
\(A'\) & \(P(A'\cap B )\) & \(P(A'\cap B' )\) & \(P(A')\) \\
sum & \(P(B)\) & \(P(B')\) & 1 \\
\end{longtable}

Where the marginals are the sums in the margins of the table, for example:

\begin{itemize}
\tightlist
\item
  \(P(A)=P(A \cap B') + P(A \cap B)\)
\item
  \(P(B)=P(A' \cap B) +P(A \cap B)\)
\end{itemize}

In our example, the contingency table is

\begin{longtable}[]{@{}cccc@{}}
\toprule\noalign{}
& \(B\) & \(B'\) & sum \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(A\) & \(1/6\) & \(2/6\) & \(3/6\) \\
\(A'\) & \(2/6\) & \(1/6\) & \(3/6\) \\
sum & \(3/6\) & \(3/6\) & \(1\) \\
\end{longtable}

\hypertarget{the-addition-rule}{%
\section{The addition rule:}\label{the-addition-rule}}

The addition rule allows us to calculate the probability of \(A\) or \(B\), \(P( A \cup B)\), in terms of the probability of \(A\) and \(B\), \(P(A \cup B )\). We can do this in three equivalent ways:

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  Using the marginals and the joint probability
  \[P(A \cup B)=P(A) + P(B) - P(A\cap B)\]
\item
  Using only joint probabilities
  \[P( A \cup B)=P(A \cap B)+P(A\cap B')+P(A'\cap B)\]
\item
  Using the complement of joint probability
  \[P(A \cup B)=1-P(A'\cap B')\]
\end{enumerate}

\textbf{Example (dice)}

Take the events \(A:\{ 1,2,3\}\), rolling a number less than or equal to \(3\), and \(B:\{2,4,6\}\), rolling an even number on the roll of a dice.

Therefore:

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  \(P( A \cup B)=P(A) + P(B) - P(A\cap B)=3/6+3/6-1/6=5/6\)
\item
  \(P(A \cup B)=P(A \cap B)+P(A\cap B')+P(A'\cap B)=1/6+2/6+2/6=5/6\)
\item
  \(P(A \cup B)=1-P(A'\cap B')= 1-1/6=5/6\)
\end{enumerate}

In the contingency table \(P( A \cup B)\) corresponds to the three cells in bold (method 2 above). That is all cells but 1/6 from the bottom right (method 3).

\begin{longtable}[]{@{}ccc@{}}
\toprule\noalign{}
& \(B\) & \(B'\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(A\) & \textbf{1/6} & \textbf{2/6} \\
\(A'\) & \textbf{2/6} & \emph{1/6} \\
\end{longtable}

\hypertarget{questions-1}{%
\section{Questions}\label{questions-1}}

We collect the age and category of 100 athletes in a competition

\begin{longtable}[]{@{}ccc@{}}
\toprule\noalign{}
& \(age:junior\) & \(age:senior\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(category:1st\) & \(14\) & \(12\) \\
\(category:2nd\) & \(21\) & \(18\) \\
\(category:3rd\) & \(22\) & \(13\) \\
\end{longtable}

\textbf{1)} What is the estimated probability that an athlete is 2nd category and senior?

\textbf{\(\qquad\)a:} \(18/100\); \textbf{\(\qquad\)b:} \(18/43\); \textbf{\(\qquad\)c:} \(18\); \textbf{\(\qquad\)d:} \(18/39\)

\textbf{2)} What is the estimated probability that the athlete is not in the third category and is senior?

\textbf{\(\qquad\)a:} \(35/100\); \textbf{\(\qquad\)b:} \(30/100\); \textbf{\(\qquad\)c:} \(22/100\); \textbf{\(\qquad\)d:} \(13/100\)

\textbf{3)} What is the marginal probability of the third category?

\textbf{\(\qquad\)a:} \(13/100\); \textbf{\(\qquad\)b:} \(35/100\); \textbf{\(\qquad\)c:} \(22/100\); \textbf{\(\qquad\)d:} \(13/22\)

\textbf{4)} What is the marginal probability of being senior?

\textbf{\(\qquad\)a:} \(13/100\); \textbf{\(\qquad\)b:} \(43/100\); \textbf{\(\qquad\)c:} \(43/57\); \textbf{\(\qquad\)d:} \(57/100\)

\textbf{5)} What is the probability of being senior or third category?

\textbf{\(\qquad\)a:} \(65/100\); \textbf{\(\qquad\)b:} \(86/100\); \textbf{\(\qquad\)c:} \(78/100\); \textbf{\(\qquad\)d:} \(13/100\)

\hypertarget{exercises-1}{%
\section{Exercises}\label{exercises-1}}

\hypertarget{classical-probability-exercise-1}{%
\subsubsection{Classical probability: Exercise 1}\label{classical-probability-exercise-1}}

\begin{itemize}
\item
  Write the table of \textbf{joint probability} for the \textbf{results} of rolling two dice; In the rows write the results of the first die and in the columns the results of the second die.
\item
  What is the probability of drawing \((3, 4)\) ? (R:1/36)
\item
  What is the probability of rolling \(3\) and \(4\) with any of the two dice? (R:2/36)
\item
  What is the probability of rolling \(3\) on the first die or \(4\) on the second? (To:11/36)
\item
  What is the probability of rolling \(3\) or \(4\) with any dice? (R:20/36)
\item
  Write the \textbf{probability table} for the result of the \textbf{add} of two dice. Assume that the outcome of each die is \textbf{equally likely}. Verify that it is:
\end{itemize}

\[
P_i=
\begin{cases}
\frac{i-1}{36},& i \in \{2,3,4,5,6, 7\} \\
\frac{13-i}{36},& i \in \{8,9,10,11,12\} \\
\end{cases}
\]

\hypertarget{frequentist-probability-exercise-2}{%
\subsubsection{Frequentist probability: Exercise 2}\label{frequentist-probability-exercise-2}}

The result of a randomized experiment is to measure the severity of misophonia \textbf{and} the state of depression of a patient.

Misophonia

\begin{itemize}
\tightlist
\item
  severity: \(S_M:\{M_ 0,M _1,M_2,M_3,M_4\}\)
\item
  Depression: \(S_ D:\{ D', D\}\))
\end{itemize}

Write the contingency table for the absolute frequencies (\(n_{ M,D }\)) for a study on a total of 123 patients in which it was observed

\begin{itemize}
\tightlist
\item
  100 individuals did not have depression.
\item
  No individual with misophonia 4 and without depression.
\item
  5 individuals with grade 1 misophonia and no depression.
\item
  The same number as the previous case for individuals with depression and without misophonia .
\item
  25 individuals without depression and grade 3 misophonia .
\item
  The number of misophonics without depression for grades 2 and 0 were distributed equally .
\item
  The number of individuals with depression and misophonia increased progressively
  in multiples of three, starting at 0 individuals for grade 1.
\end{itemize}

Answer the following questions:

\begin{itemize}
\tightlist
\item
  How many individuals had misophonia ? (A:83)
\item
  How many individuals had grade 3 misophonia ? (R:31)
\item
  How many individuals had grade 2 misophonia without depression? (R:35)
\end{itemize}

Write down the contingency table for relative frequencies \(f_{ M,D }\). Suppose \(N\) is large and the absolute frequencies \textbf{estimate} the probabilities \(f_{ M,D }=\hat {P}(M \cap D)\). Answer the following questions:

\begin{itemize}
\tightlist
\item
  What is the marginal probability of severity 2 misophonia ? (R: 0.3)
\item
  What is the probability of not being misophonic \textbf{and} not being depressed? (R:0.284)
\item
  What is the probability of being misophonic \textbf{or} depressed? (R: 0.715)
\item
  What is the probability of being misophonic \textbf{and} being depressed? (R: 0.146)
\item
  Describe in spoken language the results with probability 0.
\end{itemize}

\hypertarget{exercise-3}{%
\subsubsection{Exercise 3}\label{exercise-3}}

We have carried out a randomized experiment \(10\) times, which consists of recording the sex and vital status of patients with some type of cancer after 10 years of diagnosis. We got the following results

\begin{verbatim}
##           A     B
## 1     male   dead
## 2     male   dead
## 3     male   dead
## 4   female  alive
## 5     male   dead
## 6   female  alive
## 7   female   dead
## 8   female  alive
## 9     male  alive
## 10    male  alive
\end{verbatim}

\begin{itemize}
\tightlist
\item
  Create the contingency table for the number (\(n_{ i,j }\)) of observations of each result (\(A,B\))
\item
  Create the contingency table for the relative frequency (\(f_{ i,j }\)) of the results
\item
  What is the marginal frequency of being a man? (R/0.6)
\item
  What is the marginal frequency of being alive? (R/0.5)
\item
  What is the frequency of being alive \textbf{or} being a woman? (R/0.6)
\end{itemize}

\hypertarget{theory-exercise-4}{%
\subsubsection{Theory: Exercise 4}\label{theory-exercise-4}}

\begin{itemize}
\item
  From the second form of the addition rule, obtain the first and the third form.
\item
  What is the third form addition rule for the probability of three events \(P(A \cup B \cup C)\)?
\end{itemize}

\hypertarget{practice-1}{%
\section{Practice}\label{practice-1}}

Load misophonia data \url{https://alejandro-isglobal.github.io/SDA/data/data_0.txt}

\begin{itemize}
\item
  Compute the contingency table of absolute frequencies for misophonia diagnosis (Misofonia.dic) and depression (depresion.dic)
\item
  Compute the contingency table of relative frequencies for misophonia diagnosis (Misofonia.dic) and depression (depresion.dic)
\item
  Compare the differences with exercise 2.
\end{itemize}

\hypertarget{conditional-probability}{%
\chapter{Conditional probability}\label{conditional-probability}}

In this chapter, we will introduce conditional probability.

We will use conditional probability to define statistical independence.

We will discuss Bayes' theorem and we will discuss one of its main applications, which is the predictive efficiency of a diagnostic tool.

\hypertarget{joint-probability}{%
\section{Joint probability}\label{joint-probability}}

Recall that the joint probability of two events \(A\) and \(B\) is defined as their intersection

\[P( A ,B )=P(A \cap B)\]

Now imagine randomized experiments that measure two different types of outcomes.

\begin{itemize}
\item
  height and weight of an individual: \((h, w)\)
\item
  time and position of an electric charge: \((p, t)\)
\item
  the throw of two dice: (\(n_1\), \(n_2\))
\item
  cross two green traffic lights: (\(\bar{ R_ 1}\) , \(\bar{R_2}\))
\end{itemize}

We are often interested in whether the values of one result \textbf{condition} the values of the other.

\hypertarget{statistical-independence}{%
\section{Statistical independence}\label{statistical-independence}}

In many cases, we are interested in whether two events often tend to occur together. We want to be able to discern between two cases.

\begin{itemize}
\item
  \textbf{Independence} between events. For example, rolling a 1 on one die does not make it more likely to roll another 1 on a second die.
\item
  \textbf{Correlation} between events. For example, if a man is tall, he is probably heavy.
\end{itemize}

\textbf{Example (conductor)}

We conducted an experiment to find out if observing structural flaws in a material affects its conductivity.

The data would look like

\begin{longtable}[]{@{}ccc@{}}
\toprule\noalign{}
Conductor & Structure & conductivity \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(c_1\) & flaws & low \\
\(c_2\) & no flaws & high \\
\(c_3\) & flaws & low \\
\ldots{} & \ldots{} & \ldots{} \\
\(c_i\) & no flaws & low* \\
\ldots{} & \ldots{} & \ldots{} \\
\ldots{} & \ldots{} & \ldots{} \\
\(c_n\) & flaws & high* \\
\end{longtable}

We can expect low conductivity to occur more often with flaws than without flaws if the flaws affect conductivity.

Let's imagine that from the data we obtain the following contingency table of \textbf{estimated joint probabilities}

\begin{longtable}[]{@{}cccc@{}}
\toprule\noalign{}
& with flaws (F) & no flaws (F') & sum \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
low (L) & \(0.005\) & \(0.045\) & \(0.05\) \\
high (L') & \(0.095\) & \(0.855\) & \(0.95\) \\
sum & \(0.1\) & \(0.9\) & 1 \\
\end{longtable}

where, for example, the joint probability of \(L\) and \(F\) is

\begin{itemize}
\tightlist
\item
  \(P(L,F )=0.005\)
\end{itemize}

and the marginal probabilities are

\begin{itemize}
\tightlist
\item
  \(P(L)=P(L, F) + P(L, F')=0.05\)
\item
  \(P(F)=P(L, F) + P(L', F)= 0.1\).
\end{itemize}

\hypertarget{the-conditional-probability}{%
\section{The conditional probability}\label{the-conditional-probability}}

Low conductivity is \textbf{independent} of having structural flaws if the probability of having low conductivity (\(L\)) is the same \textbf{whether} it has flaws (\(F\)) or not (\(F'\) ) .

Let us first consider only the materials that have flaws.

Among those materials that have flaws (\(F\)), what is the estimated probability that they have low conductivity?

\(\hat{P}(L| F)= \frac{n_{L,F}}{n_{F}}=\frac{n_{L,F}/n}{n_{F}/n}= \frac{f_{L,F}}{f_{F}}\)
\[= \frac{\hat{P}( L,F )}{\hat{P}(F)}\]
Therefore, in the limit when \(N \rightarrow \infty\), we have

\[P(L| F)= \frac{P(L,F)}{P(D)}=\frac{P(L\cap F)}{P(D)}\]
\textbf{Definition:}

The \emph{conditional probability} of an event \(B\) given an event \(A\), denoted \(P(A| B)\) , is

\[P(A|B) = \frac{P(A\cap B)}{P(B)}\]

We can prove that conditional probability satisfies the axioms of probability. The conditional probability can be understood as a probability with a sample space given by \(B\): \(S_B\). In our example, the materials with stuctural flaw.

\hypertarget{conditional-contingency-table}{%
\section{Conditional contingency table}\label{conditional-contingency-table}}

If we divide the columns of the joint probability table by the marginal probabilities of the conditioning effects (\(F\) and \(F'\)), we can write \textbf{a conditional contingency table}

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3438}}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3438}}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3125}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\centering
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
F
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
F'
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
L & P( L {\textbar{}} F) & P(L {\textbar{}} F') \\
L' & P(L' {\textbar{}} F) & P(L' {\textbar{}} F') \\
sum & 1 & 1 \\
\end{longtable}

where the column probabilities sum to one. The first column shows the probabilities of low conductivity or not only of the materials that have flaws (first condition: \(F\)). The second column shows the probabilities only for the materials that have no flaws (second condition: \(F'\)).

Conditional probabilities are the probabilities of the event within each condition. We read them as:

\begin{itemize}
\tightlist
\item
  \(P(L| F)\): Probability of having low conductivity \textbf{if} it has flaws
\item
  \(P(L'| F)\): Probability of not having low conductivity \textbf{if} it has flaws
\item
  \(P(L|F ')\): Probability of having low conductivity \textbf{if} it has no flaws
\item
  \(P(L'|F ')\): Probability of not having low conductivity \textbf{if} it has no flaws
\end{itemize}

\hypertarget{statistical-independence-1}{%
\section{Statistical independence}\label{statistical-independence-1}}

In our example, the conditional contingency table is

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3438}}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3438}}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3125}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\centering
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
F
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
F'
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
L & P(L{\textbar{}}F) = 0.05 & P(L{\textbar{}}F')= 0.05 \\
L' & P(L'{\textbar{}}F)=0.95 & P(L'{\textbar{}}F')=0.95 \\
sum & 1 & 1 \\
\end{longtable}

We note that the marginal and conditional probabilities are the same!

\begin{itemize}
\tightlist
\item
  \(P(L| F)= P(L|F')=P(L)\)
\item
  \(P(L'| F)= P(L'|F')=P(L')\)
\end{itemize}

This means that the probability of observing a low conductivity is \textbf{not} dependent on having a structural flaw or not.

We conclude that low conductivity is not affected by having a structural flaw.

\textbf{Definition}

Two events \(A\) and \(B\) are statistically independent if either of the equivalent cases occurs.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  \(P(A| B)= P(A)\); \(A\) is independent of \(B\)
\item
  \(P(B| A)= P(B)\); \(B\) is independent of \(A\)
\end{enumerate}

and by the definition of conditional probability

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  \(P(A\cap B)=P(A|B)P(B)=P(A)P(B)\)
\end{enumerate}

This third form is a statement about joint probabilities. It says that we can obtain joint probabilities by multiplying the marginal ones.

In our original joint probability table

\begin{longtable}[]{@{}cccc@{}}
\toprule\noalign{}
& F & F' & sum \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
L & \(0.005\) & \(0.045\) & \(0.05\) \\
L' & \(0.095\) & \(0.855\) & \(0.95\) \\
sum & \(0.1\) & \(0.9\) & 1 \\
\end{longtable}

we can confirm that all the entries of the matrix are the product of the marginal ones. For example: \(P(F)P(L)= P( L \cap F)\) and \(P(L')P(F')=P(L' \cap F')\). Therefore, low conductivity is independent of having a structural flaw.

\textbf{Example (Coins)}

We want to confirm that the results of tossing two coins are independent. We consider all outcomes to be equally likely:

\begin{longtable}[]{@{}cc@{}}
\toprule\noalign{}
result & probability \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(( H,T )\) & 1/4 \\
\(( H,H )\) & 1/4 \\
\(( T,T )\) & 1/4 \\
\(( T, H )\) & 1/4 \\
sum & 1 \\
\end{longtable}

where \(( H,T )\) is, for example, the event of heads on the first coin and tails on the second coin. The contingency table for the joint probabilities is:

\begin{longtable}[]{@{}cccc@{}}
\toprule\noalign{}
& H & T & sum \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
H & \(1/4\) & \(1/4\) & \(1/2\) \\
T & \(1/4\) & \(1/4\) & \(1/2\) \\
sum & \(1/2\) & \(1/2\) & 1 \\
\end{longtable}

From this table, we see that the probability of getting a head and then a tail is the product of the marginals \(P( H, T)=P(H)*P(T)=1/4\). Therefore, the events of heads in the first coin and tails in the second are independent.

If we build the conditional contingency table on the toss of the first coin, we will see that obtaining tails in the second coin is not conditioned by having obtained heads in the first coin: \(P(T| H)= P(T) =1 / 2\)

\hypertarget{statistical-dependency}{%
\section{Statistical dependency}\label{statistical-dependency}}

An important example of statistical dependency is found in the performance of \textbf{diagnostic tools}, where we want to determine the state of a system(s) with results

\begin{itemize}
\tightlist
\item
  satisfactory (yes)
\item
  unsatisfactory (not)
\end{itemize}

with a test (t) with results

\begin{itemize}
\tightlist
\item
  positive
\item
  negative
\end{itemize}

For example, we test a battery to see how long it can last. We load a cable to find out if it resists carrying a certain load. We run a PCR to see if someone is infected.

\hypertarget{diagnostic-test}{%
\section{Diagnostic test}\label{diagnostic-test}}

Let's consider diagnosing an infection with a new test. Infection status:

\begin{itemize}
\tightlist
\item
  yes (infected)
\item
  no (not infected)
\end{itemize}

Test:

\begin{itemize}
\tightlist
\item
  positive
\item
  negative
\end{itemize}

The \textbf{conditional contingency table} is what we get in a controlled environment (laboratory)

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3438}}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3438}}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3125}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\centering
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Infection: yes
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Infection: No
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Test: positive & P(positive {\textbar{}} yes) & P(positive {\textbar{}} no) \\
Test: negative & P(negative {\textbar{}} yes) & P(negative {\textbar{}} no) \\
sum & 1 & 1 \\
\end{longtable}

Let's look at the table entries
1) Rate of true positives (Sensitivity): The probability of testing positive \textbf{if} you have the disease \(P(positive| yes)\)

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\item
  Rate of true negatives (Specificity): The probability of testing negative \textbf{if} you do not have the disease \(P(negative| no)\)
\item
  False positive rate: the probability of testing positive \textbf{if} you do not have the disease \(P(positive| no)\)
\item
  False negative rate: the probability of testing negative \textbf{if} you have the disease \(P(negative| yes)\)
\end{enumerate}

High correlation (statistical dependence) between test and infection means high values for probabilities 1 and 2 \textbf{and} low values for probabilities 3 and 4.

\textbf{Example (COVID)}

Now let's consider a real situation. In the early days of the coronavirus pandemic, there was no measure of the effectiveness of PCRs in detecting the virus. One of the first published studies (\url{https://www.nejm.org/doi/full/10.1056/NEJMp2015897}) found that

\begin{itemize}
\tightlist
\item
  The PCR had a sensitivity of 70\%, in infection condition.
\item
  The PCR had a specificity of 94\%, in non-infected condition.
\end{itemize}

The conditional contingency table is

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3438}}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3438}}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3125}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\centering
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Infection: yes
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Infection: No
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Test: positive & P(positive{\textbar{}} yes)= 0.7 & P(positive{\textbar{}}no)=0.06 \\
Test: negative & P(negative{\textbar{}} yes)= 0.3 & P(negative{\textbar{}}no)=0.94 \\
sum & 1 & 1 \\
\end{longtable}

Therefore, the errors in the diagnostic tests were:

\begin{itemize}
\tightlist
\item
  The false positive rate is \(P(positive| no)= 0.06\)
\item
  The false negative rate is \(P(negative| yes)= 0.3\)
\end{itemize}

\hypertarget{inverse-probabilities}{%
\section{Inverse probabilities}\label{inverse-probabilities}}

We are interested in finding the probability of being infected if the test is positive: \[P(si| positive)\]

For that:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  We recover the contingency table for joint probabilities, multiplying by the marginal \(P(yes)\) and \(P(no)\) that we need to know
\end{enumerate}

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2619}}
  >{\centering\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2619}}
  >{\centering\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2381}}
  >{\centering\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2381}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\centering
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Infection: yes
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Infection: No
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
sum
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Test: positive & P( positive {\textbar{}} yes)P(yes) & P(positive {\textbar{}} no)P(no) & P(positive) \\
Test: negative & P( negative {\textbar{}} yes)P(yes) & P(negative {\textbar{}} no) P(no) & P(negative) \\
sum & P(yes) & P(no) & 1 \\
\end{longtable}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  We use the definition of conditional probabilities for rows instead of columns (we divide by the marginal of the test results)
\end{enumerate}

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2619}}
  >{\centering\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2619}}
  >{\centering\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2381}}
  >{\centering\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2381}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\centering
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Infection: yes
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Infection: No
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
sum
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Test: positive & P(yes{\textbar{}}positive) & P(no{\textbar{}}positive) & 1 \\
Test: negative & P(yes{\textbar{}}negative) & P(no{\textbar{}}negative) & 1 \\
\end{longtable}

For example:

\[P(yes| positive)= \frac{P(positive|yes)P(yes)}{P(positive)}\]

To apply this formula we need the marginals \(P(yes)\) (prevalence) and \(P(positive)\).

\begin{itemize}
\item
  The prevalence \(P(yes)\) needs to be given from another study. The first prevalence study in Spain showed that during confinement \(P(yes)=0.05\), \(P(no)=0.95\), before the summer of 2020.
\item
  To find the marginal of positives \(P(positive)\), we can then use the definition of marginal and conditional probability:
\end{itemize}

\(P(positive)= P(positive \cap yes) + P(positive \cap no)\)
\[= P(positive| yes)P (yes)+P(positive|no)P(no)\]
This last relation of the marginals is called \textbf{rule of total probability}.

\hypertarget{bayes-theorem}{%
\section{Bayes' Theorem}\label{bayes-theorem}}

After substituting the total probability rule into \(P(yes| positive)\) , we have

\[P(yes| positive)= \frac{P(positive|yes)P(yes)}{P(positive|yes)P(yes)+P(positive|no)P(no)}\]
This expression is known as \textbf{Bayes' theorem}. It allows us to reverse the conditionals:

\[P(positive|yes) \rightarrow P(yes| positive)\]
Or \textbf{assess} a test in a controlled condition (infection) and then use it to \textbf{infer} the probability of the condition when the test is positive.

\textbf{Example (COVID)}:

The test performance was:

\begin{itemize}
\item
  Sensitivity: \(P(positive| yes)= 0.70\)
\item
  False positive rate: \(P(positive| no)= 1- P(negative|no)=0.06\)
\end{itemize}

The study in the Spanish population gave:

\begin{itemize}
\tightlist
\item
  \(P(yes)=0.05\)
\item
  \(P(no)=1-P(yes)=0.95\).
\end{itemize}

Therefore, the probability of being infected in case of testing positive was:

\[P(yes| positive)= 0.38\]

We concluded that at that time PCR was not very good at \textbf{confirming} infections.

However, let us now apply Bayes' theorem to the probability of not being infected if the test was negative.

\[P(no|negative) = \frac{P(negative|no) P(no )}{ P(negative|no) P(no)+P(negative|yes)P(yes)}\]

Substituting all values gives

\[P(no| negative)= 0.98\]

So the tests were good for \textbf{ruling out} infections and a fair requirement for travel.

\textbf{Bayes's theorem}

In general, we can have more than two conditioning events. Therefore, Baye's theorem says:

If \(E1, E2, ..., Ek\) are \(k\) mutually exclusive and exhaustive events and \(B\) is any event, then the probability inverse \(P(Ei| B)\) is

\[P(Ei| B)= \frac{P(B|Ei)P(Ei)}{P(B|E1)P(E1) +...+ P(B|Ek)P(Ek)}\]
The denominator is the total probability rule for the marginal \(P(B)\), in terms of the marginals \(P(E1), P(E2), ... P(Ek)\).

\[P(B)=P(B|E 1)P (E1) +...+ P(B|Ek)P(Ek)\]

\textbf{Conditional tree}

The total probability rule can also be illustrated using a \textbf{conditional} tree.

\includegraphics{./figures/treetot.PNG}

\textbf{Rule of total probability} for the marginal of \(B\): In how many ways can I get the result \(B\)?

\(P(B)=P(B|A)P(A)+P(B|A')P(A')\)

\hypertarget{questions-2}{%
\section{Questions}\label{questions-2}}

We collect the age and category of 100 athletes in a competition

\begin{longtable}[]{@{}ccc@{}}
\toprule\noalign{}
& \(junior\) & \(senior\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(1st\) & \(14\) & \(12\) \\
\(2nd\) & \(21\) & \(18\) \\
\(3rd\) & \(22\) & \(13\) \\
\end{longtable}

\textbf{1)} What is the estimated probability that the athlete is in the third category if the athlete is a junior?

\textbf{\(\qquad\)a:} \(22\); \textbf{\(\qquad\)b:} \(22/100\); \textbf{\(\qquad\)c:} \(22/57\); \textbf{\(\qquad\)d:} \(22/35\);

\textbf{2)} What is the estimated probability that the athlete is a junior and is in the 1st category if the athlete is not in the 3rd category?

\textbf{\(\qquad\)a:} \(14/35\); \textbf{\(\qquad\)b:} \(14/65\); \textbf{\(\qquad\)c:} \(14/100\); \textbf{\(\qquad\)d:} \(14/26\)

\textbf{3)} A diagnostic test has a probability of \(8/9\) of detecting a disease if the patients are sick and a probability of \(3/9\) of detecting the disease if the patients are healthy. If the probability of being sick is \(1/9\). What is the probability that a patient is sick if a test detects the disease?

\textbf{\(\qquad\)a:} \(\frac{8/9}{8/9+3/9}*1/9\);
\textbf{\(\qquad\)b:} \(\frac{3/9}{8/9+3/9}*1/9\);
\textbf{\(\qquad\)c:} \(\frac{3/9*8/9}{8/9*1/9+3/9*8/9}\); \textbf{\(\qquad\)d:} \(\frac{8/9*1/9}{8/9*1/9+3/9*8/9}\);

\textbf{4)} As discussed in the notes, a PCR test for coronavirus had a sensitivity of 70\% and a specificity of 94\% and in Spain during confinement there was an incidence of 5\%. With these data, what was the probability of testing positive in Spain (\(P(positive)\))

\textbf{\(\qquad\)a:} \(0.035\); \textbf{\(\qquad\)b:} \(0.092\); \textbf{\(\qquad\)c:} \(0.908\); \textbf{\(\qquad\)d:} \(0.95\)

\textbf{5)} With the same data as in question 4, testing positive in the PCR and being infected are not independent events because:

\textbf{\(\qquad\) a:} Sensitivity is 70\%;
\textbf{\(\qquad\)b:} Sensitivity and false positive rate are different;
\textbf{\(\qquad\)c:} The false positive rate is 0.06\%; \textbf{\(\qquad\)d:} the specificity is 96\%

\hypertarget{exercises-2}{%
\section{Exercises}\label{exercises-2}}

\hypertarget{exercise-1-1}{%
\subsubsection{Exercise 1}\label{exercise-1-1}}

A machine is tested for its performance in producing high-quality turning rods. These are the test results

\begin{longtable}[]{@{}ccc@{}}
\toprule\noalign{}
& Rounded: yes & Rounded: No \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
smooth surface: yes & 200 & 1 \\
smooth surface: no & 4 & 2 \\
\end{longtable}

\begin{itemize}
\item
  What is the estimated probability that the machine will produce a rod that does not satisfy any quality control? (A: 2/207)
\item
  What is the estimated probability that the machine will produce a rod that fails at least one quality check? (A: 7/207)
\item
  What is the estimated probability that the machine will produce rods with a rounded and smooth surface? (A: 200/207)
\item
  What is the estimated probability that the bar is rounded if the bar is smooth? (A: 200/201)
\item
  What is the estimated probability that the rod is smooth if it is rounded? (A: 200/204)
\item
  What is the estimated probability that the rod is neither smooth nor rounded if it does not satisfy at least one quality check? (A: 2/7)
\item
  Are smoothness and roundness independent events? (No)
\end{itemize}

\hypertarget{exercise-2-1}{%
\subsubsection{Exercise 2}\label{exercise-2-1}}

We developed a test to detect the presence of bacteria in a lake. We found that if the lake contains the bacteria, the test is positive 70\% of the time. If there are no bacteria, the test is negative 60\% of the time. We implemented the test in a region where we know that 20\% of the lakes have bacteria.

\begin{itemize}
\tightlist
\item
  What is the probability that a lake that tests positive is contaminated with bacteria? (R: 0.30)
\end{itemize}

\hypertarget{exercise-3-1}{%
\subsubsection{Exercise 3}\label{exercise-3-1}}

Two machines are tested for their performance in producing high-quality turning rods. These are the test results

\textbf{Machine 1}

\begin{longtable}[]{@{}ccc@{}}
\toprule\noalign{}
& Rounded: yes & Rounded: No \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
smooth surface: yes & 200 & 1 \\
smooth surface: no & 4 & 2 \\
\end{longtable}

\textbf{Machine 2}

\begin{longtable}[]{@{}ccc@{}}
\toprule\noalign{}
& Rounded: yes & Rounded: No \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
smooth surface: yes & 145 & 4 \\
smooth surface: no & 8 & 6 \\
\end{longtable}

\begin{itemize}
\tightlist
\item
  What is the probability that the bar is rounded? (A: 357/370)
\item
  What is the probability that the rod was produced by machine 1? (A: 207/370)
\item
  What is the probability that the rod is not smooth? (R: 20/370)
\item
  What is the probability that the rod is smooth or rounded or produced by machine 1? (A: 364/370)
\item
  What is the probability that the rod will be rounded if it is smoothed and from machine 1? (A: 200/201)
\item
  What is the probability that the rod is not rounded if it is not smooth and it is from machine 2? (A: 6/14)
\item
  What is the probability that the rod has come out of machine 1 if it is smooth and rounded? (R: 200/345)
\item
  What is the probability that the rod came from machine 2 if it fails at least one of the quality controls? (R:0.72)
\end{itemize}

\hypertarget{exercise-4}{%
\subsubsection{Exercise 4}\label{exercise-4}}

A quality test on a random brick is defined by the events:

\begin{itemize}
\tightlist
\item
  Pass the quality test: \(E\), fail the quality test: \(\bar{E}\)
\item
  Defective: \(D\), non-defective: \(\bar{D}\)
\end{itemize}

If the diagnostic test has sensitivity \(P(E|\bar{D })= 0.99\) and specificity \(P(\bar{E}|D)=0.98\), and the probability of passing the test is \(P(E) =0.893\) then

\begin{itemize}
\item
  What is the probability that a randomly chosen brick is defective \(P(D)\)? (R:0.1)
\item
  What is the probability that a brick that has passed the test is actually defective? (R:0.022)
\item
  The probability that a brick is not defective \textbf{and} that it fails the test (R:0.009)
\item
  Are \(D\) and \(\bar{E}\) statistically independent? (No)
\end{itemize}

\hypertarget{practice-2}{%
\section{Practice}\label{practice-2}}

Load misophonia data from \url{https://alejandro-isglobal.github.io/SDA/data/data_0.txt}

\begin{itemize}
\item
  Compute the conditional probability table of misophophonia (Misofonia.dic) given marital status (Estado). What is the estimated probability of having misophonia if the patient is married?
\item
  Compute the conditional probability table of marital status (Estado) given misophonia (Misofonia.dic). What is the estimated probability of being married if the patient is misophonic?
\end{itemize}

\hypertarget{discrete-random-variables}{%
\chapter{Discrete Random Variables}\label{discrete-random-variables}}

\hypertarget{objective}{%
\section{Objective}\label{objective}}

In this chapter we will define a random variables and study discrete random variables.

We will define the probability mass function and its main properties of mean and variance. Following the abstraction process of the relative frequencies into probabilities we also define the probability distribution as the limiting case of the relative cumulative frequency.

\hypertarget{relative-frequencies-2}{%
\section{Relative frequencies}\label{relative-frequencies-2}}

Relative frequencies of the outcomes of a random experiment are a measure of their propensity. We can used them as estimators of their probabilities, when the we repeat the random experiment a lot of times (\(n \rightarrow \infty\)).

We defined central tendency (average), dispersion (sample variance) and the frequency distribution the data (\(F_i\)).

In terms of probabilities, how are this quantities defined?

\includegraphics{./figures/randomvar.JPG}

\hypertarget{random-variable}{%
\section{Random variable}\label{random-variable}}

We defined the relative frequencies on the \textbf{observations} of the experiments. We now define the equivalent quantities for probabilities in terms of the \textbf{outcomes} of the experiments. We will deal with numerical outcomes only.

A \textbf{random variable} is a symbol that represents a \textbf{numerical outcome} of a random experiment. We write the random variable in \textbf{capitals} (i.e.~\(X\)).

\textbf{Definition:}

A \textbf{random variable} is a function that assigns a real \textbf{number} to an \textbf{event} from the sample space of a random experiment.

Remember than an event can be an outcome or a collection of outcomes.

When the random variable takes a \textbf{value}, it indicates the realization of an \textbf{event} of a random experiment.

\emph{Example:}

If \(X \in \{0,1\}\), we then say \(X\) is a random variable that can take the values \(0\) or \(1\).

\hypertarget{events-of-observing-a-random-variable}{%
\section{Events of observing a random variable}\label{events-of-observing-a-random-variable}}

We make the distinction between variables in the model space with capital letters, as abstract entities, and the realization of a particular event or outcome. For instance:

\begin{itemize}
\tightlist
\item
  \(X=1\) is the \textbf{event} of observing the random variable \(X\) with value \(1\)
\item
  \(X=2\) is the \textbf{event} of observing the random variable \(X\) with value \(2\)
\end{itemize}

\ldots{}

\textbf{In general:}

\begin{itemize}
\tightlist
\item
  \(X=x\) is the \textbf{event} of observing the random variable \(X\) (big \(X\)) with value \(x\) (little \(x\)).
\end{itemize}

\hypertarget{probability-of-random-variables}{%
\section{Probability of random variables}\label{probability-of-random-variables}}

We are interested in assigning probabilities to the events of observing a particular value of a random variable.

For instance for the dice we will write the probability table as

\begin{longtable}[]{@{}cc@{}}
\toprule\noalign{}
\(X\) & Probability \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(1\) & \(P(X=1)=1/6\) \\
\(2\) & \(P(X=2)=1/6\) \\
\(3\) & \(P(X=3)=1/6\) \\
\(4\) & \(P(X=4)=1/6\) \\
\(5\) & \(P(X=5)=1/6\) \\
\(6\) & \(P(X=6)=1/6\) \\
\end{longtable}

where we make explicit the events that the variable takes a given outcome \(X=x\).

\hypertarget{probability-functions}{%
\section{Probability functions}\label{probability-functions}}

Because (little) \(x\) is a numerical variable, the probabilities of the random variable can be plotted

\includegraphics{_main_files/figure-latex/unnamed-chunk-36-1.pdf}

or written as the mathematical function

\[f(x)=P(X=x)=1/6\]

\hypertarget{probability-functions-1}{%
\section{Probability functions}\label{probability-functions-1}}

We can \textbf{create} any type of probability function if we satisfy Kolmogorov's probability rules:

For a discrete random variable \(X \in \{x_1 , x_2 , .. , x_M\}\), a \textbf{probability mass function} that is used to compute probabilities

\begin{itemize}
\tightlist
\item
  \(f(x_i)=P(X=x_i)\)
\end{itemize}

is always positive

\begin{itemize}
\tightlist
\item
  \(f(x_i)\geq 0\)
\end{itemize}

and its sum over all the values of the variable is \(1\):

\begin{itemize}
\tightlist
\item
  \(\sum_{i=1}^M f(x_i)=1\)
\end{itemize}

Where \(M\) is the number of possible outcomes.

Note that the definition of \(X\) and its probability mass function is general \textbf{without reference} to any experiment. The functions live in the model (abstract) space.

Here is an example

\includegraphics{_main_files/figure-latex/unnamed-chunk-37-1.pdf}

\(X\) and \(f(x)\) are abstract objects that may or may not map to an experiment. We have the freedom to construct them as we want as long as we respect their definition.

Probability mass functions have some \textbf{properties} that are derived exclusively from their definition.

\hypertarget{probabilities-and-relative-frequencies}{%
\section{Probabilities and relative frequencies}\label{probabilities-and-relative-frequencies}}

\textbf{Consider the example}

Make following set-up: In one urn put \(8\) balls and:

\begin{itemize}
\tightlist
\item
  mark \(1\) ball with \(-2\)
\item
  mark \(2\) balls with \(-1\)
\item
  mark \(2\) balls with \(0\)
\item
  mark \(2\) balls with \(1\)
\item
  mark \(1\) ball with \(2\)
\end{itemize}

And consider performing the following random \textbf{experiment:} Take one ball and read the number.

From the classical probability, we can write the probability table, for which we do not need to run any experiment

\begin{longtable}[]{@{}cc@{}}
\toprule\noalign{}
\(X\) & \(P(X=x)\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(-2\) & \(1/8=0.125\) \\
\(-1\) & \(2/8=0.25\) \\
\(0\) & \(2/8=0.25\) \\
\(1\) & \(2/8=0.25\) \\
\(2\) & \(1/8=0.125\) \\
\end{longtable}

Now, let's perform the experiment \(30\) times and write the frequency table

\begin{longtable}[]{@{}cc@{}}
\toprule\noalign{}
\(X\) & \(f_i\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(-2\) & \(0.132\) \\
\(-1\) & \(0.262\) \\
\(0\) & \(0.240\) \\
\(1\) & \(0.248\) \\
\(2\) & \(0.118\) \\
\end{longtable}

The frequentist probability tells us
\[lim_{N \rightarrow \infty} f_i = f(x_i)=P(X=x_i)\]
Then, if we did not know the set up of the experiment (black box), the best we can do is to \textbf{estimate} the probabilities with the frequencies, obtained from \(N\) repetitions of the random experiment:

\[f_i = \hat{P}_i\]

\includegraphics{_main_files/figure-latex/unnamed-chunk-38-1.pdf}

Everytime we estimate the probabilities, our estimates \(\hat{P}_i=f_i\) change. But \(P_i\) is an abstract quantity that never changes. As \(N\) increases we get closer to it.

\hypertarget{mean-or-expected-value}{%
\section{Mean or expected value}\label{mean-or-expected-value}}

When we discussed summary statistics of data, we defined the centre of the observations as a value around which the outcome frequencies are concentrated.

We used the \textbf{average} to measure the centre of gravity of the \textbf{data}. In terms of the relative frequencies of the values of discrete outcomes, we wrote the average as

\(\bar{x}= \sum_{i=1}^M x_i \frac{n_i}{N}=\) \[\sum_{i=1}^M x_i f_i\]

\textbf{Definition}

The \textbf{mean} (\(\mu\)) or expected value of a discrete random variable \(X\), \(E(X)\), with mass function \(f(x)\) is given by

\[ \mu = E(X)= \sum_{i=1}^M x_i f(x_i) \]

\includegraphics{./figures/mu.png}

It is the center of gravity of the \textbf{probabilities}: The point where probability loading on a road are balanced.

From the definition we have

\[\bar{x} \rightarrow \mu\] in the \textbf{limit} when
\(N \rightarrow \infty\) as the frequency tends to the probability mass fucntion \(f_i \rightarrow f(x_i)\).

\textbf{Example}

What is the mean of \(X\) if its probability mass function \(f(x)\) is given by

\begin{longtable}[]{@{}cc@{}}
\toprule\noalign{}
\(X\) & \(f(x)=P(X=x)\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(0\) & \(1/16\) \\
\(1\) & \(4/16\) \\
\(2\) & \(6/16\) \\
\(3\) & \(4/16\) \\
\(4\) & \(1/16\) \\
\end{longtable}

\includegraphics{_main_files/figure-latex/unnamed-chunk-39-1.pdf}

\[ \mu =E(X)=\sum_{i=1}^m x_i f(x_i) \]

\(E(X)=\)\textbf{0} * 1/16 + \textbf{1} * 4/16 + \textbf{2} * 6/16 + \textbf{3} * 4/16 + \textbf{4} * 1/16 =2

The mean \(\mu\) is the centre of gravity of the probability mass function \textbf{it does not change}. However, the average \(\bar{x}\) is the centre of gravity of the observations (relative frequencies) it \textbf{changes} with different data.

\hypertarget{variance}{%
\section{Variance}\label{variance}}

When we discussed summary statistics of data, we also defined the spread of the observations as an average distance from the data average.

\textbf{Definition}

The variance, written as \(\sigma^2\) or \(V(X)\), of a discrete random variable \(X\) with mass function \(f(x)\) is given by

\[\sigma^2 = V(X)= \sum_{i=1}^M (x_i-\mu)^2 f(x_i)\]
\(\sigma=\sqrt{V(X)}\) is called the \textbf{standard deviation} of the random variable.

Teh variance is the spread of the \textbf{probabilities} about the mean: The moment of inertia of probabilities about the mean.

\textbf{Example}

What is the variance of \(X\) if its probability mass function \(f(x)\) is given by

\begin{longtable}[]{@{}cc@{}}
\toprule\noalign{}
\(X\) & \(f(x)=P(X=x)\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(0\) & \(1/16\) \\
\(1\) & \(4/16\) \\
\(2\) & \(6/16\) \\
\(3\) & \(4/16\) \\
\(4\) & \(1/16\) \\
\end{longtable}

\[\sigma^2 =V(X)=\sum_{i=1}^m (x_i-\mu)^2 f(x_i)\]

\(V(X)=\)\textbf{(0-2)}\(^2\)* 1/16 + \textbf{(1-2)}\(^2\)* 4/16 + \textbf{(2-2)}\(^2\)* 6/16 + \textbf{(3-2)}\(^2\)* 4/16 + \textbf{(4-2)}\(^2\)* 1/16 =1

\[V(X)=\sigma^2=1\]
\[\sigma=1\]

\hypertarget{probability-functions-for-functions-of-x}{%
\section{\texorpdfstring{Probability functions for functions of \(X\)}{Probability functions for functions of X}}\label{probability-functions-for-functions-of-x}}

In many occasions, we will be interested in outcomes that are function of the random variables. Perhaps, we are interested in the square of the number of flu infections, or on the square root of the number of emails in an hour.

\textbf{Definition}

For any function \(h\) of a random variable \(X\), with mass function \(f(x)\), its expected value is given by

\[ E[h(X)]= \sum_{i=1}^M h(x_i) f(x_i) \]

This is an important definition that allows us to prove three frequently used properties of the mean and variance:

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  The mean of a linear function is the linear function fo the mean: \[E(a\times X +b)= a\times E(X) +b\] for \(a\) and \(b\) scalars (numbers).
\item
  The variance of a linear function of \(X\) is:\[V(a\times X +b)= a^2\times V(X)\]
\item
  The variance \textbf{about the origin} is the variance \textbf{about the mean} plus the mean squared: \[E(X^2)=V(X)+E(X)^2\]
\end{enumerate}

\textbf{Example}

What is the variance \(X\) about the origin, \(E(X^2)\), if its probability mass function \(f(x)\) is given by

\begin{longtable}[]{@{}cc@{}}
\toprule\noalign{}
\(X\) & \(f(x)=P(X=x)\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(0\) & \(1/16\) \\
\(1\) & \(4/16\) \\
\(2\) & \(6/16\) \\
\(3\) & \(4/16\) \\
\(4\) & \(1/16\) \\
\end{longtable}

\[E(X^2) =\sum_{i=1}^m x_i^2 f(x_i)\]

\(E(X^2)=\)\textbf{(0)}\(^2\)* 1/16 + \textbf{(1)}\(^2\)* 4/16 + \textbf{(2)}\(^2\)* 6/16 + \textbf{(3)}\(^2\)* 4/16 + \textbf{(4)}\(^2\)* 1/16 =5

We can also verify:

\[E(X^2)=V(X)+E(X)^2\]

\(5=1+2^2\)

\hypertarget{probability-distribution}{%
\section{Probability distribution}\label{probability-distribution}}

When we discussed summary statistics of data, we also defined the frequency distribution (or the relative cumulative frequency) \(F_i\). \(F_i\) is an important quantity because it is a continuous function \(F_x\) is therefore a \textbf{continuous} function, even if the outcomes are discrete.

\textbf{Definition:}

The \textbf{probability distribution} function is defined as

\[F(x)=P(X\leq x)=\sum_{x_i\leq x} f(x_i) \]

That is the accumulated probability up to a given value \(x\)

\(F(x)\) satisfies therefore satisifies:

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  \(0\leq F(x) \leq 1\)
\item
  If \(x \leq y\), then \(F(x) \leq F(y)\)
\end{enumerate}

For the probability mass function:

\begin{longtable}[]{@{}cc@{}}
\toprule\noalign{}
\(X\) & \(f(x)=P(X=x)\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(0\) & \(1/16\) \\
\(1\) & \(4/16\) \\
\(2\) & \(6/16\) \\
\(3\) & \(4/16\) \\
\(4\) & \(1/16\) \\
\end{longtable}

The probability distribution is:

\[
    F(x)=
\begin{cases}
    1/16,& \text{if } 0 \leq x < 1\\
    5/16,& 1\leq x < 2\\
    11/16,& 2\leq x < 3\\
    15/16,& 4\leq x < 5\\
    16/16,&  x \leq 5\\
\end{cases}
\]

For\(X \in \mathbb{Z}\)

\includegraphics{_main_files/figure-latex/unnamed-chunk-40-1.pdf}

\hypertarget{probability-function-and-probability-distribution}{%
\section{Probability function and probability distribution}\label{probability-function-and-probability-distribution}}

The probability function and distribution are equivalent. We can get one from the other and vice-versa

\[f(x_i)=F(x_i)-F(x_{i-1})\]

with

\[f(x_1)=F(x_1)\]

for \(X\) taking values in \(x_1 \leq x_2 \leq ... \leq x_n\)

\textbf{Example}

From probability distribution:

\[
    F(x)=
\begin{cases}
    1/16,& \text{if } 0 \leq x < 1\\
    5/16,& 1\leq x < 2\\
    11/16,& 2\leq x < 3\\
    15/16,& 4\leq x < 5\\
    16/16,&  x \leq 5\\
\end{cases}
\]

We can obtain the probability mas function.

\(f(0)=F(0)=1/16\)
\(f(1)=F(1)-f(0)=5/32-1/32=4/16\)
\(f(2)=F(2)-f(1)-f(0)=F(2)-F(1)=6/16\)
\(f(3)=F(3)-f(2)-f(1)-f(0)=F(3)-F(2)=4/16\)
\(f(4)=F(4)-F(3)=1/16\)

\hypertarget{quantiles}{%
\section{Quantiles}\label{quantiles}}

Finally, we can use the probability distribution \(F(x)\) to define the median and the quartiles of the radom variable \(X\).

In general, we define the \textbf{q-quantile} as the value \(x_{p}\) \textbf{under} which we have accumulated q*100\% of the probability

\[q=\sum_{i=1}^p f(x_i) = F (x_p)\]

\begin{itemize}
\tightlist
\item
  The \textbf{median} is value \(x_m\) such that \(q=0.5\)
\end{itemize}

\[F(x_{m})=0.5\]

\begin{itemize}
\tightlist
\item
  The \(0.05\)-quantile is the value \(x_{r}\) such that \(q=0.05\)
\end{itemize}

\[F(x_{r})=0.05\]

\begin{itemize}
\tightlist
\item
  The \(0.25\)-quantile is \textbf{first quartile} the value \(x_{s}\) such that \(q=0.25\)
\end{itemize}

\[F(x_{s})=0.25\]

\hypertarget{summary}{%
\section{Summary}\label{summary}}

\includegraphics{./figures/randomvarsum.JPG}

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.4348}}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3043}}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.2609}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\centering
quantity names
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
model (unobserved)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
data (observed)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
probability mass function // relative frequency & \(f(x_i)=P(X=x_i)\) & \(f_i=\frac{n_i}{N}\) \\
probability distribution // cumulative relative frequency & \(F(x_i)=P(X \leq x_i)\) & \(F_i=\sum_{k\leq i} f_k\) \\
mean // average & \(\mu=E(X)=\sum_{i=1}^M x_i f(x_i)\) & \(\bar{x}=\sum_{j=1}^N x_j/N\) \\
variance // sample variance & \(\sigma^2=V(X)=\sum_{i=1}^M (x_i-\mu)^2 f(x_i)\) & \(s^2=\sum_{j=1}^N (x_j-\bar{x})^2/(N-1)\) \\
standard deviation // sample sd & \(\sigma=\sqrt{V(X)}\) & \(s\) \\
variance about the origin // 2nd sample moment & \(E(X^2)=\sum_{i=1}^M x_i^2 f(x_i)\) & \(m_2= \sum_{j=1}^N x_j^2/n\) \\
\end{longtable}

Note that:

\begin{itemize}
\tightlist
\item
  \(i=1...M\) is an \textbf{outcome} of the random variable \(X\).
\item
  \(j=1...N\) is an \textbf{observation} of the random variable \(X\).
\end{itemize}

Properties:

\begin{itemize}
\tightlist
\item
  \(\sum_{i=1...N} f(x_i)=1\)
\item
  \(f(x_i)=F(x_i)-F(x_{i-1})\)
\item
  \(E(a\times X +b)= a\times E(X) +b\); for \(a\) and \(b\) scalars.
\item
  \(V(a\times X +b)= a^2\times V(X)\)
\item
  \(E(X^2)=V(X)+E(X)^2\)
\end{itemize}

\hypertarget{questions-3}{%
\section{Questions}\label{questions-3}}

\textbf{1)} For a probability mass function is not true that

\textbf{\(\qquad\)a:} the addition of their image values is 1; \textbf{\(\qquad\)b:} its values can be interpreted as probabilities of events;
\textbf{\(\qquad\)c:} it is always positive;
\textbf{\(\qquad\)d:} cannot take value 1;

\textbf{2)} A value of a random variable is

\textbf{\(\qquad\)a:} an observation of a random experiment; \textbf{\(\qquad\)b:} the frequency of an outcome of a random experiment;
\textbf{\(\qquad\)c:} an outcome of a random experiment;
\textbf{\(\qquad\)d:} a probability of an outcome;

\textbf{3)} The estimated value of a probability \(\hat{P_i}\) is equal to the probability \(P_i\) when the number of repetitions of the random experiment is

\textbf{\(\qquad\)a:} large; \textbf{\(\qquad\)b:} infinite;
\textbf{\(\qquad\)c:} small
\textbf{\(\qquad\)d:} zero;

\textbf{4)} If a probability mass function is symmetric around \(x=0\)

\textbf{\(\qquad\)a:} The mean is lower than the median; \textbf{\(\qquad\)b:} The mean is greater than the median;
\textbf{\(\qquad\)c:} The mean and the median are equal;
\textbf{\(\qquad\)d:} The mean and the median are different from 0;

\textbf{5)} The mean and variance

\textbf{\(\qquad\)a:} are inversely proportional; \textbf{\(\qquad\)b:} are expected values of functions of \(X\);
\textbf{\(\qquad\)c:} of a linear function are the linear function of the mean and the linear function of the variance;
\textbf{\(\qquad\)d:} change when we repeat the random experiment;

\hypertarget{exercises-3}{%
\section{Exercises}\label{exercises-3}}

\hypertarget{exercise-1-2}{%
\subsubsection{Exercise 1}\label{exercise-1-2}}

Consider the following random variable \(X\) over the outcomes

\begin{longtable}[]{@{}cc@{}}
\toprule\noalign{}
outcome & \(X\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(a\) & 0 \\
\(b\) & 0 \\
\(c\) & 1.5 \\
\(d\) & 1.5 \\
\(e\) & 2 \\
\(f\) & 3 \\
\end{longtable}

\begin{enumerate}
\def\labelenumi{\alph{enumi})}
\item
  If each outcome is equally probable then what is the probability mass function of \(x\)?
\item
  Find:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  \(P(X>3)\)
\item
  \(P(X=0\, \cup \, X=2 )\)
\item
  \(P(X \leq 2)\)
\end{itemize}

\hypertarget{exercise-2-2}{%
\subsubsection{Exercise 2}\label{exercise-2-2}}

Given the probability mass function

\begin{longtable}[]{@{}cc@{}}
\toprule\noalign{}
\(x\) & \(f(x)=P(X=x)\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
10 & 0.1 \\
12 & 0.3 \\
14 & 0.25 \\
15 & 0.15 \\
17 & ? \\
20 & 0.15 \\
\end{longtable}

\begin{itemize}
\tightlist
\item
  what is its expected value and standard deviation? (R: 14.2; 2.95)
\end{itemize}

\hypertarget{exercise-3-2}{%
\subsubsection{Exercise 3}\label{exercise-3-2}}

Given the probability distribution for a discrete variable \(X\)

\[
    F(x)= 
\begin{cases}
0, & x < -1 \\
0.2,& x \in [-1,0)\\
0.35,& x \in [0,1)\\
0.45,& x \in [1,2)\\
1,& x \geq 2\\
\end{cases}
\]

\begin{itemize}
\tightlist
\item
  find \(f(x)\)
\item
  find \(E(X)\) and \(V(X)\) (R:1; 1.5)
\item
  what is the expected value and variance of \(Y=2X+3\) (R: 6)
\item
  what is the median and the first and third quartiles of \(X\)? (R:2,0,2)
\end{itemize}

\hypertarget{exercise-4-1}{%
\subsubsection{Exercise 4}\label{exercise-4-1}}

We are testing a system to transmit digital pictures. We first consider the experiment of sending \(3\) pixels and having as \textbf{possible} outcomes events such like \((0,1,1)\). This is the event of receiving the first pixel with no error, the second with error and third with error.

\begin{itemize}
\item
  List in one column the sample space of the random experiment.
\item
  In the a second column assign the random variable that counts the number of errors transmitted for each outcome
\end{itemize}

Consider that we have a totally noisy channel, that is any outcome of three pixels is equally likely.

\begin{itemize}
\item
  What is the probability of receiving \(0\), \(1\), \(2\), or \(3\) errors in the transmission of \(3\) pixels? (R: 1/8; 3/8; 3/8; 1/8)
\item
  Sketch the probability mass function for the number of errors
\item
  What is the expected value for the number of errors? (R:1.5)
\item
  What is its variance? (R: 0.75)
\item
  Sketch the probability distribution
\item
  What is the probability of transmitting at least 1 error? (R:7/8)
\end{itemize}

\hypertarget{continous-random-variables}{%
\chapter{Continous Random Variables}\label{continous-random-variables}}

\hypertarget{objective-1}{%
\section{Objective}\label{objective-1}}

In this chapter we will study continous random variables.

We will define the probability density function, its mean and variance and, similar to discrete random variables, we will define the probability distribution function.

\hypertarget{continuous-random-variables}{%
\section{Continuous random variables}\label{continuous-random-variables}}

In the last chapter we used the probabilities of discrete random variables to define the probability mass function \[f(x)=P(X= x)\]

Where the probability that the random variable takes the value \(x\) is understood as the value of its relative frequency, when the number of repetitions of the random experiment tends to infinity.

When we talked about continuous data, we saw that we had to transform them into discrete variables (bins) to produce relative frequency tables or histograms. Let's see how to define the probabilities of continuous variables taking these partitions into account.

\textbf{Example (misophonia)}

Let us reconsider the angle of convexity of patients with misophonia (Section 2.21). The angle of convexity of 123 patients was measured. We understood each measurement as the result of a random experiment that we repeated 123 times and that we could describe in a frequency table or in a histogram.

To do this, we redefine the results as small regular intervals (bins) and calculate the relative frequency of each interval.

\begin{verbatim}
##        outcome ni         fi
## 1 [-1.02,3.46]  8 0.06504065
## 2  (3.46,7.92] 51 0.41463415
## 3  (7.92,12.4] 26 0.21138211
## 4  (12.4,16.8] 20 0.16260163
## 5  (16.8,21.3] 18 0.14634146
\end{verbatim}

\hypertarget{relative-frequencies-3}{%
\section{relative frequencies}\label{relative-frequencies-3}}

Relative frequencies for the intervals are the probabilities when \(N \rightarrow \infty\)

\[f_i=\frac{n_i}{N} \rightarrow P(x_i \leq X  \leq x_i + \Delta x)\]

The probability depends now on the length of the bins \(\Delta x\). If we make the bins smaller and smaller then the frequencies get smaller and therefore

\[P(x_i \leq X  \leq x_i + \Delta x) \rightarrow 0\] when \(\Delta x \rightarrow 0\), because \(n_i \rightarrow 0\)

Let's see how the frequencies get smaller when we divide the range of \(X\) into \(20\) bins

\begin{verbatim}
##          outcome ni         fi
## 1  [-1.02,0.115]  2 0.01626016
## 2   (0.115,1.23]  0 0.00000000
## 3    (1.23,2.34]  3 0.02439024
## 4    (2.34,3.46]  3 0.02439024
## 5    (3.46,4.58]  2 0.01626016
## 6    (4.58,5.69]  4 0.03252033
## 7     (5.69,6.8] 11 0.08943089
## 8     (6.8,7.92] 34 0.27642276
## 9    (7.92,9.04] 12 0.09756098
## 10   (9.04,10.2]  4 0.03252033
## 11   (10.2,11.3]  3 0.02439024
## 12   (11.3,12.4]  7 0.05691057
## 13   (12.4,13.5]  2 0.01626016
## 14   (13.5,14.6]  6 0.04878049
## 15   (14.6,15.7]  4 0.03252033
## 16   (15.7,16.8]  8 0.06504065
## 17     (16.8,18]  4 0.03252033
## 18     (18,19.1]  9 0.07317073
## 19   (19.1,20.2]  3 0.02439024
## 20   (20.2,21.3]  2 0.01626016
\end{verbatim}

\hypertarget{probability-density-function}{%
\section{probability density function}\label{probability-density-function}}

We define a quantity at a point \(x\) that is the amount of probability per unit distance that we would find in an \textbf{infinitesimal} bin \(dx\) at \(x\)

\[f(x)= \frac{P(x\leq X \leq x+dx)}{dx}\]

\(f(x)\) is called the probability \textbf{density} function.

Therefore, the probability of observing \(x\) between \(x\) and \(x+dx\)
is given by

\[P(x\leq X \leq x+dx)= f(x) dx\]

\textbf{Definition}

For a continuous random variable \(X\), a \textbf{probability density} function is such that

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  The function is positive:
\end{enumerate}

\[f(x) \geq 0\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  The probability of observing \textbf{any} value is 1:
\end{enumerate}

\[\int_{-\infty}^{\infty} f(x) dx = 1\]
3) The probability of observing a value within an interval is the \textbf{area under the curve}:

\[P(a\leq X \leq b)=\int_{a}^{b} f(x) dx\]

The properties make sure that \(f(x)dx\) satisfy Kolmogorov's properties of a probability measure.

The probability density function is a step forward in the abstraction of probabilities: we add the continuous limit

\[dx \rightarrow 0\]

All the properties of probabilities are translated in terms of densities

\[\sum \rightarrow \int\]

Probability densities are mathematical quantities that do not necessarily represent random experiments.

A fundamental interest in statistics is to describe the densities that describe our particular random experiment.

\hypertarget{total-area-under-the-curve}{%
\section{Total area under the curve}\label{total-area-under-the-curve}}

\textbf{Example (raindrop fall)}

take the \textbf{probability density} that may describe the random variable that measures where a raindrop falls in a rain gutter of length \(100cm\).

\[
    f(x)= 
\begin{cases}
    \frac{1}{100},& \text{if } x\in (0,100)\\
    0,& otherwise 
\end{cases}
\]

Let us verify that the function satisfies the three properties of a probability density.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  it is evident from the definition that \(f(x) \geq 0\)
\item
  The probability of observing \textbf{anything} is the total \textbf{area under the curve}
\end{enumerate}

\(P(-\infty\leq X \leq \infty)= \int_{-\infty}^{\infty} f(x) dx = 100*0.01= 1\)

\includegraphics{_main_files/figure-latex/unnamed-chunk-43-1.pdf}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  The probability of observing \(x\) in an interval is the \textbf{area under the curve} within the interval
\end{enumerate}

\begin{itemize}
\tightlist
\item
  \(P(20 \leq X \leq 60) = \int_{20}^{60} f(x) dx = (60-20)*0.01=0.4\)
\end{itemize}

\includegraphics{_main_files/figure-latex/unnamed-chunk-44-1.pdf}

\hypertarget{probabilities-of-continous-variables}{%
\section{Probabilities of continous variables}\label{probabilities-of-continous-variables}}

For continuous variables, we compute the probability that the variable is in a given interval. That is

\[P(a \leq X \leq b)\]
We saw that for continuous variables, the probability that the experiment gives us a particular real number is zero: \(P(X=a)=0\)

The \(P(a \leq X \leq b)\) is the area under the curve of \(f(x)\) between \(a\) and \(b\)

\begin{itemize}
\tightlist
\item
  \(P(a \leq X \leq b) = \int_{a}^{b} f(x) dx\)
\end{itemize}

\includegraphics{_main_files/figure-latex/unnamed-chunk-45-1.pdf}

\hypertarget{probability-distribution-1}{%
\section{Probability distribution}\label{probability-distribution-1}}

The \textbf{probability distribution} \(F(c)\) defined as the accumulation of probability up to the outcome \(C\)

\(F(c) = P(X \leq c)\)

can be used to compute the probability \(P(a \leq X \leq b)\).

Consider:

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  that the probability accumulated up to \(b\) is given by
\end{enumerate}

\begin{itemize}
\tightlist
\item
  \(F(b) = P(X \leq b)=\int_{-\infty}^bf(x)dx\)
\end{itemize}

\includegraphics{_main_files/figure-latex/unnamed-chunk-46-1.pdf}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  that the probability accumulated up to \(a\) is
\end{enumerate}

\begin{itemize}
\tightlist
\item
  \(F(a) = P(X \leq a)\)
\end{itemize}

\includegraphics{_main_files/figure-latex/unnamed-chunk-47-1.pdf}

Then the probability between \(a\) and \(b\) is given by the difference in the value of the probability distribution

\begin{itemize}
\tightlist
\item
  \(P(a\leq X \leq b) = \int_a^b f(x)dx=F(b)-F(a)\)
\end{itemize}

\includegraphics{_main_files/figure-latex/unnamed-chunk-48-1.pdf}

\textbf{Definition}

The \textbf{probability distribution} of a continuous random variable is defined as

\[F(a)=P(X\leq a) =\int_{-\infty} ^a f(x)dx\]

and have the properties:

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  It is between \(0\) and \(1\):
\end{enumerate}

\[F(-\infty)= 0 \,\, and \,\,F(\infty)=1\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  It always increases:
\end{enumerate}

\[F(a)\leq F(b)\]

if \(a\leq b\)

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  It can be used to compute probabilities:
\end{enumerate}

\[P(a \leq X \leq b)=F(b)-F(a)\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{3}
\tightlist
\item
  It recovers the probability density:
\end{enumerate}

\[f(x)=\frac{dF(x)}{dx}\]

We use \textbf{probability distributions} to \textbf{compute probabilities} of a random variable within intervals, and its derivative is the probability density function.

\textbf{Example (raindrop fall)}

For the uniform density function:

\[
    f(x)= 
\begin{cases}
    \frac{1}{100},& \text{if } x\in (0,100)\\
    0,& otherwise 
\end{cases}
\]

We find that the probability distribution is

\[
    F(a)= 
\begin{cases}
    0,& a \leq 0 \\
    \frac{a}{100},& \text{if } a\in (0,100)\\
    1, & 10 \leq a \\
    \\
\end{cases}
\]

\newpage

\hypertarget{probability-plots}{%
\section{Probability plots}\label{probability-plots}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  We can plot the the probability of a random variable in an interval as the \emph{area} under the \textbf{density} curve. For instance
\end{enumerate}

\[P(20<X<60)\]

\includegraphics{_main_files/figure-latex/unnamed-chunk-49-1.pdf}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  Equivalenty, we can plot the probability \(P(20<X<60)\) as the \emph{difference} in \textbf{distribution} values
\end{enumerate}

\includegraphics{_main_files/figure-latex/unnamed-chunk-50-1.pdf}

\hypertarget{mean}{%
\section{Mean}\label{mean}}

As in the discrete case, the \textbf{mean} measures the center of mass of probabilities

\textbf{Definition}

Suppose \(X\) is a continuous random variable with probability \textbf{density} function \(f(x)\). The mean or expected value of \(X\), denoted as \(\mu\) or \(E(X)\), is

\[\mu=E(X)=\int_{-\infty}^\infty x f(x) dx\]

It is the continuous version of the center of mass.

\textbf{Example (raindrop fall)}

The random variable with probability density

\[
    f(x)= 
\begin{cases}
    \frac{1}{100},& \text{if } x\in (0,100)\\
    0,& otherwise 
\end{cases}
\]

Has an expected value at

\[E(X)=50\]

\includegraphics{_main_files/figure-latex/unnamed-chunk-51-1.pdf}

\hypertarget{variance-1}{%
\section{Variance}\label{variance-1}}

As in the discrete case, the variance measures the dispersion of probabilities about the mean

\textbf{Definition}

Suppose \(X\) is a continuous random variable with probability density function \(f(x)\). The variance of \(X\), denoted as \(\sigma^2\) or \(V(X)\), is

\[\sigma^2=V(X)=\int_{-\infty}^\infty (x-\mu)^2 f(x) dx\]

It is the continuous version of the moment of inertia.

\hypertarget{functions-of-x}{%
\section{\texorpdfstring{Functions of \(X\)}{Functions of X}}\label{functions-of-x}}

In many occasions, we will be interested in outcomes that are function of the random variables. Perhaps, we are interested in the square of the elongation of a spring, or on the square root of the temperature of an engine.

\textbf{Definition}

For any function \(h\) of a random variable \(X\), with mass function \(f(x)\), its expected value is given by

\[E[h(X)]= \int_{-\infty}^{\infty} h(x) f(x)dx\]

From this definition we recover the same properties as in the discrete case

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  The mean of a linear function is the linear function fo the mean: \[E(a\times X +b)= a\times E(X) +b\] for \(a\) and \(b\) scalars.
\item
  The variance of a linear function of \(X\) is:\[V(a\times X +b)= a^2\times V(X)\]
\item
  The variance about the origin is the variance about the mean plus the mean squared: \[E(X^2)=V(X)+E(X)^2\]
\end{enumerate}

\hypertarget{exercises-4}{%
\section{Exercises}\label{exercises-4}}

\hypertarget{exercise-1-3}{%
\subsubsection{Exercise 1}\label{exercise-1-3}}

For the probability density

\[
    f(x)= 
\begin{cases}
    \frac{1}{100},& \text{if } x\in (0,100)\\
    0,& otherwise 
\end{cases}
\]

\begin{itemize}
\tightlist
\item
  compute the mean (R:50)
\item
  compute variance using \(E(X^2)=V(X)+E(X)^2\) (R:100\^{}2/12)
\item
  compute \(P(\mu-\sigma\leq X \leq \mu+\sigma)\) (R: 0.57)
\item
  What are the first and third quartiles? (R: 25; 75)
\end{itemize}

\includegraphics{_main_files/figure-latex/unnamed-chunk-52-1.pdf}

\hypertarget{exercise-2-3}{%
\subsubsection{Exercise 2}\label{exercise-2-3}}

Given
\[
    f(x)= 
\begin{cases}
0, & x < 0 \\
ax, & x \in [0,3] \\
b, & x \in (3,5) \\
\frac{b}{3}(8-x),& x \in [5,8]\\
0, & x > 8 \\
\end{cases}
\]

\begin{itemize}
\item
  What are the values of \(a\) and \(b\) such that \(f(x)\) is a continous probability density function? (R: 1/15; 1/5)
\item
  what is the mean of \(X\)? (R:4)
\end{itemize}

\hypertarget{exercise-3-3}{%
\subsubsection{Exercise 3}\label{exercise-3-3}}

For the probability density

\[
    f(x)= 
\begin{cases}
    \lambda e^{-\lambda x},& \text{if } x \geq 0\\
    0,& otherwise 
\end{cases}
\]

\begin{itemize}
\tightlist
\item
  Confirm that this is a probability density
\item
  Compute the mean (R: 1/\(\lambda\))
\item
  Compute the expected value of \(X^2\) (R: 2/\(\lambda^2\))
\item
  Compute variance (R: 1/\(\lambda^2\))
\item
  Find the probability distribution \(F(a)\) (R: \(1-exp(-\lambda a)\))
\item
  Find the median (R: \(\log{2}\)/\(\lambda\))
\end{itemize}

\hypertarget{exercise-4-2}{%
\subsubsection{Exercise 4}\label{exercise-4-2}}

Given the cumulative distribution for a random variable X

\[
    F(x)= 
\begin{cases}
0, & x  < -1 \\
\frac{1}{80}(17+16x-x^2),& x \in [-1,7)\\
1,& x \geq 7\\
\end{cases}
\]

compute:

\begin{itemize}
\tightlist
\item
  \(P(X>0)\) (R:63/80)
\item
  \(E(X)\) (R:1.93)
\item
  \(P(X>0|X<2)\) (R:28/45)
\end{itemize}

\hypertarget{discrete-probability-models}{%
\chapter{Discrete Probability Models}\label{discrete-probability-models}}

\hypertarget{objective-2}{%
\section{Objective}\label{objective-2}}

In this chapter we will see some probability mass functions that are used to describe common random experiments.

We will introduce the concept of parameter and thus parametric models.

In particular, we will discuss the uniform and Bernoulli probability functions and how they are used to derive the binomial and negative binomial probability functions.

\hypertarget{probability-mass-function}{%
\section{Probability mass function}\label{probability-mass-function}}

Let us remenber that a probability mass function of a \textbf{discrete random variable} \(X\) with possible values \(x_1 , x_2 , .. , x_M\) is \textbf{any function} such that

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  It Allows us to compute probabilities for all outcomes
\end{enumerate}

\[f(x_i)=P(X=x_i)\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  It is always positive:
\end{enumerate}

\[f(x_i)\geq 0\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  The probability of of obtaining anything in the random experiment is \(1\)
\end{enumerate}

\[\sum_{i=1}^M f(x_i)=1\]

We studied two important \textbf{properties:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  The mean as a measure of central tendency:
\end{enumerate}

\[E(X)= \sum_{i=1}^M x_i f(x_i)\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  The variance as a measure of dispersion:
\end{enumerate}

\[V(X)= \sum_{i=1}^M (x_i-\mu)^2 f(x_i)\]

\hypertarget{probability-model}{%
\section{Probability model}\label{probability-model}}

A \textbf{probability model} is a probability mass function that may represent the probabilities of a random experiment.

\textbf{Examples:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  The probability mass function defined by
\end{enumerate}

\begin{longtable}[]{@{}cc@{}}
\toprule\noalign{}
\(X\) & \(f(x)\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(-2\) & \(1/8\) \\
\(-1\) & \(2/8\) \\
\(0\) & \(2/8\) \\
\(1\) & \(2/8\) \\
\(2\) & \(1/8\) \\
\end{longtable}

Represents the probability of drawing \textbf{one} ball from an urn where there are two balls with labels: \(-1, 0, 1\) and one ball with labels: \(-2, 2\).

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  \(f(x)=P(X=x)=1/6\) represents the probability of the outcomes of \textbf{one} throw of a dice.
\end{enumerate}

\hypertarget{parametric-models}{%
\section{Parametric models}\label{parametric-models}}

When we have a random experiment with \(M\) possible outcomes, we need to find \(M\) numbers to determine the probability mass function. As in the previous example 1, we needed \(5\) values in the column \(f(x)\) of the probability table.

However, \textbf{in many cases}, we can formulate probability functions \(f(x)\) that depend on \textbf{very few} numbers only. As in the previous example 2, we only needed to know how many possible outcomes the throw of a dice has.

\textbf{Example (classical probability):}

A random experiment with \(M\) equally likely outcomes has a probability mass function:
\[f(x)=P(X=x)=1/M\]

We only need to know \(M\).

The numbers we \textbf{need to know} to fully determine a probability function are called \textbf{parameters}.

\hypertarget{uniform-distribution-one-parameter}{%
\section{Uniform distribution (one parameter)}\label{uniform-distribution-one-parameter}}

The previous example is the classical interpretation of probability, and defines our first parametric model.

\textbf{Definition}

A random variable \(X\) with outcomes \(\{1,...M\}\) has a discrete \textbf{uniform distribution} if all its \(M\) outcomes have the same probability

\[f(x)=\frac{1}{M}\]

\(M\) is the natural parameter of the model. Once we define \(M\) for an experiment, we choose a particular probability mass function. The function above is really a family of functions that depend on \(M\): \(f(x; M)\).

The mean and variance of a variable that follows a uniform distribution are:

\[E(X)= \frac{M+1}{2}\]

and

\[V(X)= \frac{M^2-1}{12}\]

Note: \(E(X)\) and \(V(X)\) are also \textbf{parameters}. If we know any of them then we can fully determine the distribution. For instance:

\[f(x)=\frac{1}{2E(X)-1}\]
Let's look at some probability mass functions in the family of uniform parametric models:

\includegraphics{_main_files/figure-latex/unnamed-chunk-53-1.pdf}

\hypertarget{uniform-distribution-two-parameters}{%
\section{Uniform distribution (two parameters)}\label{uniform-distribution-two-parameters}}

Let's introduce a new \textbf{uniform} probability model with \textbf{two parameters}: The minimum and maximum outcomes.

If the random variable takes values in \(\{a, a+1, ...b\}\), where \(a\) and \(b\) are integers and all the outcomes are equally probable then

\[f(x)=\frac{1}{b-a+1}\]

as \(M=b-a+1\).

We then say that \(X\) distributes uniformly between \(a\) and \(b\) and write

\[X \rightarrow Unif(a,b)\]

\textbf{Properties:}

If \(X\) distributes uniformly between \(a\) and \(b\)

\[X \rightarrow Unif(a,b)\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  Its mean is
\end{enumerate}

\[E(X)= \frac{b+a}{2}\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  Its variance is
\end{enumerate}

\[V(X)= \frac{(b-a+1)^2-1}{12}\]

To prove this change variables \(X=Y+a-1\), \(y \in \{1,...M\}\).

\textbf{Probability mass functions}

Let's look at some probability mass functions in the family of uniform parametric models:

\includegraphics{_main_files/figure-latex/unnamed-chunk-54-1.pdf}

\textbf{Example (school classes):}

What is the probability of observing a child of a particular age in a primary school (if all classes have the same amount of children)?

From the set up of the experiment we know: \(a=6\) and \(b=11\) then

\[X \rightarrow Unif(a=6, b=11)\] that is

\[f(x)=\frac{1}{6}\] for \(x\in \{6,7,8,9,10,11\}\), and \(0\) otherwise.

The mean and variance for this probability mass function is:

\begin{itemize}
\tightlist
\item
  \(E(X)=8.5\)
\item
  \(V(X)=2.916667\)
\end{itemize}

Remember that

\begin{itemize}
\item
  The expected value is the \textbf{mean} \(\mu=8.5\)
\item
  The \textbf{standard deviation} \(\sigma=1.707825\) is the average distance from the mean and is computed from the square root of the variance.
\end{itemize}

\includegraphics{_main_files/figure-latex/unnamed-chunk-55-1.pdf}

\textbf{Parameters and Models:}

A \textbf{model} is a particular function \(f(x)\) that \textbf{describes} our experiment.

If the model is a \textbf{known} function that depends on a few parameters then changing the value of the parameters we produce a \textbf{family of models}: \(f(x; a,b)\).

Knowledge of \(f(x)\) is reduced to the knowledge of the value of the parameters \(a\), \(b\).

Ideally, the model and the parameters are \textbf{interpretable}.

In our example, \(a\) represents the the minimum age at school and \(b\) the maximum age. They can be considered as the \textbf{physical properties} of the experiment.

\hypertarget{bernoulli-trial}{%
\section{Bernoulli trial}\label{bernoulli-trial}}

Let's try to advance from the equal probability case and suppose a model with only two possible outcomes (\(A\) and \(B\)) that have \textbf{unequal} probabilities

\textbf{Examples:}

\begin{itemize}
\item
  Writing down the sex of a patient who goes into an emergency room of a hospital (\(A:male\) and \(B:female\)).
\item
  Recording whether a manufactured machine is defective or not (\(A:defective\) and \(B:not \,\, defective\)).
\item
  Hitting a target (\(A:success\) and \(B:failure\)).
\item
  Transmitting one pixel correctly (\(A:yes\) and \(B:no\)).
\end{itemize}

In these examples, the probability of outcome \(A\) is usually \textbf{unknown}.

\textbf{Probability model:}

We will introduce the probability of an outcome (\(A\)) as the \textbf{parameter} of the model. The model can be written in different forms

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  As a probability table:
\end{enumerate}

\begin{longtable}[]{@{}cc@{}}
\toprule\noalign{}
\(Outcome\) & \(P_i\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(A\) & \(p\) \\
\(B\) & \(1-p\) \\
\end{longtable}

\begin{itemize}
\tightlist
\item
  \(i \in \{A,B\}\)
\item
  outcome A (success): has probability \(p\) (parameter)
\item
  outcome B (failure): has a probability \(1-p\)
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  As a probability mass function of the random variable \(K\) taking values \(\{0, 1\}\) for \(B\) and \(A\), respectively.
\end{enumerate}

\[
    f(k)= 
\begin{cases}
    1-p,&  k=0\, (event\, B)\\
    p,& k=1\, (event\, A) 
\end{cases}
\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  As a concise probability mass function
\end{enumerate}

\[f(k; p)=p^k(1-p)^{1-k} \]

for \(k=(0,1)\).

We then say that \(X\) follows a Bernoulli distribution with parameter \(p\)
\[X \rightarrow Bernoulli(p)\]

\textbf{Properties:}

If \(X\) follows a Bernoulli distribution then

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  its mean is
\end{enumerate}

\[E(K)=p\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  its variance is
\end{enumerate}

\[V(K)=(1-p)p\]

Note that the probability of the outcome \(A\) is the parameter \(p\)
which is the same as its value at \(1\): \(f(1)=P(X=1)\). The parameter fully determines the probability mass function, including its mean and variance.

Let's look at some probability mass functions in the family of uniform parametric models:

\includegraphics{_main_files/figure-latex/unnamed-chunk-56-1.pdf}

\hypertarget{binomial-experiment}{%
\section{Binomial experiment}\label{binomial-experiment}}

When we are interested in predicting \textbf{absolute frequencies} when we know the parameter \(p\) of particular Bernoulli trial, we

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  \textbf{repeat} the Bernoulli trial \(n\) times and count how many times we obtained \(A\) using the absolute frequency of \(A\): \(N_A\).
\item
  define a \textbf{random variable} \(X=N_A\) taking values \(x \in {0,1,...n}\)
\end{enumerate}

When we repeat \(n\) times a Bernoulli trial, we obtain one value for \(n_A\). If we perform other \(n\) Bernoulli trials then \(n_A\) changes its value. Therefore, \(X=N_A\) is a random variable and \(x=n_A\) is its observation.

\textbf{Examples (Some binomial experiments):}

\begin{itemize}
\item
  Writing down the sex of \(n=10\) patients who go into an emergency room of a hospital. What is the probability that \(X=9\) patients are men when \(p=0.8\)?
\item
  Trying \(n=5\) times to hit a target (\(A:success\) and \(B:failure\)). What is the probability that I hit the target \(X=5\) times when I usually hit it \(25\%\) of the times (\(p=0.25\))?
\item
  Transmitting \(n=100\) pixels correctly (\(A:yes\) and \(B:no\)). What is the probability that \(X=2\) pixels are errors, when the probability of error is \(p=0.1\)?
\end{itemize}

\hypertarget{binomial-probability-function}{%
\section{Binomial probability function}\label{binomial-probability-function}}

Let us suppose that \textbf{we know} the real value of the parameter of the Bernoulli trial \(p\).

When we repeat a Bernoulli trial and stop at \(n\), is the value \(x\) that we obtain common or rare? what is its probability mass function \(P(X=x)=f(x)\)?

\textbf{Example (transmission of pixels):}

What is the probability of observing \(X=x\) errors when transmitting \(n=4\) pixels, if the probability of an error is \(p\)?

Let us consider that

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  A random variable of the \textbf{transmission experiment} is the vector \[(K_1, K_2, K_3, K_4)\] where one observation may be \((K_1=0, K_2=1, K_3=0, K_4=1)\) or \((0, 1, 0, 1)\).
\item
  Each \[K_i \rightarrow Bernoulli(p)\] \(k_i \in \{0, 1\}\)
\item
  \(X=N_A\) can be computed as the sum \[X=\sum_{i=1}^4 K_i\] \(x\in \{0,1,2,3,4\}\). For example \(X=2\) for the outcome \((0, 1, 0, 1)\).
\end{enumerate}

Now let's see the probabilities of some \textbf{error events} and then we will generalize them.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  What is the probability of observing \(4\) \textbf{errors}?
\end{enumerate}

The probability of observing \(4\) errors is the probability of observing an error in the \(1^{st}\) \textbf{and} \(2^{nd}\) \textbf{and} \(3^{rd}\) \textbf{and} \(4^{th}\) pixel:

\[P(X=4)=P(1,1,1,1)=p*p*p*p=p^4\]

because \(K_i\) are \textbf{independent}.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  What is the probability of observing \(0\) \textbf{errors}?
\end{enumerate}

The probability of \(0\) errors is the joint probability of observing \textbf{no error} in \textbf{any} transmission:

\[P(X=0)=P(0,0,0,0)=(1-p)(1-p)(1-p)(1-p)=(1-p)^4\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  What is the probability of observing \(3\) \textbf{errors}?
\end{enumerate}

The probability of \(3\) errors is the \textbf{addition} of probability of observing \(3\) errors in \textbf{different events}:

\[P(X=3)=P(0,1,1,1)+P(1,0,1,1)+P(1,1,0,1)+P(1,1,1,0)=4p^3(1-p)^1\]
because all off these events are \textbf{mutually exclusive}.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{3}
\tightlist
\item
  Therefore the probability of \(x\) \textbf{errors} is
\end{enumerate}

\[
    f(x)= 
\begin{cases}
    1*p^0(1-p)^4,&  x=0 \\
    4*p^1(1-p)^3,&  x=1 \\
    6*p^2(1-p)^2,&  x=2 \\
    4*p^3(1-p)^1,&  x=3 \\
    1*p^4(1-p)^0,&  x=4 \\
\end{cases}
\]

or more shortly

\[f(x)=\binom 4 x p^x(1-p)^{4-x}\]
for \(x=0,1,2,3,4\)

where \(\binom 4 x\) is the number of \textbf{possible outcomes} (transmissions of \(4\) pixels) with \(x\) errors.

\textbf{Definition:}

The \textbf{binomial probability} function is the probability mass function of observing \(x\) outcomes of type \(A\) in \(n\) independent Bernoulli trials, where \(A\) has the same probability \(p\) in each trial.

The function is given by

\(f(x)=\binom n x p^x(1-p)^{n-x}\), \(x=0,1,...n\)

\(\binom n x= \frac{n!}{x!(n-x)!}\) is called \textbf{the binomial coefficient} and gives the number of ways one can obtain \(x\) events of type \(A\) in a set of \(n\).

When a variable \(X\) has a binomial probability function we say it distributes binomially and write

\[X\rightarrow Bin(n,p)\]

where \(n\) and \(p\) are parameters.

Let's look at some probability mass functions in the family of binomial parametric models:

\includegraphics{_main_files/figure-latex/unnamed-chunk-57-1.pdf}

\textbf{Properties:}

If a random variable \(X\rightarrow Bin(n,p)\) then

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  its mean is
\end{enumerate}

\[E(X)=np\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  its variance is
\end{enumerate}

\[V(X)=np(1-p)\]

These properties can be demonstrated by the fact that \(X\) is the sum of \(n\) independent Bernoulli variables. Therefore,

\(E(X)=E(\sum_{i=1}^n K_i)=np\)

and

\(V(X)=V(\sum_{i=1}^n K_i)=n(1-p)p\)

\textbf{Example (transmission of pixels):}

\begin{itemize}
\item
  The expected value for the number of errors in the transmission of \(4\) pixels is \(np=4*0.1=0.4\) when the probability of an error is \(0.1\).
\item
  The variance is \(n(1-p)p=0.36\)
\item
  What is the probability of observing \(4\) errors?
\end{itemize}

Since we are repeating a Bernoulli trial \(n=4\) times and counting the number of events of type \(A\) (errors), when \(P(A)=p=0.1\) then

\[X \rightarrow Bin(n=4, p=0.1)\]
That is \[f(x)=\binom 4 x 0.1^x(1-0.1)^{4-x}\]

\(P(X=4)=f(4)=\binom 4 4 0.1^4 0.9^{0}=0.1^4=10^{-4}\)

In Python:

\begin{verbatim}
from scipy.stats import binom
binom.pmf(4,4,0.1)
\end{verbatim}

\begin{itemize}
\tightlist
\item
  What is the probability of observing \(2\) errors?
\end{itemize}

\(P(X=2)=\binom 4 2 0.1^2 0.9^2=0.0486\)

In Python:

\begin{verbatim}
binom.pmf(2,4,0.1)
\end{verbatim}

\textbf{Example (opinion polls):}

\begin{itemize}
\tightlist
\item
  What is the probability of observing \textbf{at most} \(8\) voters of the ruling party in an election poll of size \(10\), if the probability of a positive vote for the party is \(0.9\)
\end{itemize}

For this case

\[X \rightarrow Bin(n=10, p=0.9)\]

That is \[f(x)=\binom {10} x 0.9^x(0.1)^{10-x}\]

We want to compute:
\(P(X\le 8)=F(8)= \sum_{i=1..8} f(x_i)=0.2639011\)

in Python binom.cdf(8,10, 0.9)

\hypertarget{negative-binomial-probability-function}{%
\section{Negative binomial probability function}\label{negative-binomial-probability-function}}

Now let us imagine that we are interested in counting the well-transmitted pixels before a \textbf{given number} of errors occur. Say we can \textbf{tolerate} \(r\) errors in transmission.

Our random experiment is now: Repeat Bernoulli trials until we observe the outcome \(A\) appears \(r\) times.

The outcome of the experiment is the number of events \(n_B=y\)

We are interested in finding the probability of observing a particular number of events \(B\), \(P(Y=y)\), where \(Y=N_B\) is the random variable.

\textbf{Example (transmission of pixels):}

What is the probability of observing \(y\) well-transmitted (\(B\)) pixels before \(r\) errors (\(A\))?

Let's first find the probability of \textbf{one particular} \textbf{transmission event} with \(y\) number of correct pixels (\(B\)) and \(r\) number of errors (\(A\)).

\[(0,0,1,., 0,1,...0,1)\]

where we consider that there are \(y\) zeros and \(r\) ones. Therefore, we observe \(y\) correct pixels in a total of \(y + r\) pixels.

The probability of this event is:

\[P(0,0,1,., 0,1,...0,1)=p^r(1-p)^y\]

Remember that \(p\) is the probability of error (\(A\)).

How many \textbf{transmissions events} can have \(y\) correct pixels (0's) before \(r\) errors (1's)?

Note that

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  The last bit is fixed (marks the end of transmission)
\item
  The total number of ways in which \(y\) number of zeros can be allocated in \(y + r-1\) pixels (the last pixel is fixed with value 1) is: \(\binom {y + r-1} y\)
\end{enumerate}

Therefore, the probability of observing \(y\) 1's before \(r\) 0's (each 1 with probability \(p\)) is

\[P(Y=y)=f(y)=\binom {y+r-1} y p^r(1-p)^y\]

for \(y=0,1,...\)

We then say that \(Y\) follows a negative binomial distribution and we write

\[Y\rightarrow NB(r,p)\]

where \(r\) and \(p\) are parameters representing the tolerance and the probability of a single error (event \(A\)).

\textbf{Properties:}

A random variable \(Y\rightarrow NB(r,p)\) has

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  mean \[E(Y)= r\frac{1-p}{p}\]
\item
  and variance \[V(Y)= r\frac{1-p}{p^2}\]
\end{enumerate}

Let's look at some probability mass functions in the family of negative binomial parametric models:

\includegraphics{_main_files/figure-latex/unnamed-chunk-58-1.pdf}

\textbf{Example (website)}

A website has three servers. One server operates at a time and only when a request fails another server is used.

If the probability of failure for a request is known to be \(p=0.0005\) then

\begin{itemize}
\tightlist
\item
  what is the expected number of successful requests before the three computers fail?
\end{itemize}

Since we are repeating a Bernoulli trial until \(r=3\) events of type \(A\) (failure) are observed (each with \(P(A)=p=0.0005\)) and are counting the number of events of type \(B\) (successful requests) then

\[Y \rightarrow NB(r=3, p=0.0005)\]

Therefore, the expected number of requests before the system fails is:

\(E(Y)=r\frac{1-p}{p}=3\frac{1-0.0005}{0.0005}=5997\)

Note that there are actually \(6000\) trials.

\begin{itemize}
\tightlist
\item
  What is the probability of dealing with at most \(5\) successful requests before the system fails?
\end{itemize}

We therefore want to compute the probability distribution at \(5\):

\(F(5)=P(Y\leq 5)=\Sigma_{y=0}^5 f(y)\)

\(=\sum_{y=0}^5\binom {y+2} y 0.0005^r0.9995^y\)

\(=\binom {2} 0 0.0005^3 0.9995^0 +\binom {3} 1 0.0005^3 0.9995^1\)

\(+\binom {4} 2 0.0005^3 0.9995^2 +\binom {5} 3 0.0005^3 0.9995^3\)

\(+\binom {6} 4 0.0005^3 0.9995^4 +\binom {7} 5 0.0005^3 0.9995^5\)

\(= 6.9\times 10^{-9}\)

In Python this is computed with

\begin{verbatim}
from scipy.stats import nbinom
nbinom.cdf(5,3,0.0005)
\end{verbatim}

\textbf{Examples}

\begin{itemize}
\tightlist
\item
  What is the probability of observing \(10\) correct pixels before \(2\) errors, if the probability of an error is \(0.1\)?
\end{itemize}

\(f(10; r=2, p=0.1)=0.03835463\)

in Python: nbinom.pmf(10, 2, 0.1)

\begin{itemize}
\tightlist
\item
  What is the probability that \(2\) girls enter the class before \(4\) boys if the probability that a girl enters is \(0.5\)?
\end{itemize}

\(f(2; r=4, p=0.5)=0.15625\)

in Python: nbinom.pmf(2, 4, 0.5)

\hypertarget{geometric-distribution}{%
\section{Geometric distribution}\label{geometric-distribution}}

We call \textbf{geometric distribution} to the \textbf{negative binomial} distribution with \(r=1\)

The probability of observing \(B\) events before observing the \textbf{first} event of type \(A\) is

\[P(Y=y)=f(y)= p(1-p)^y\]

\[Y\rightarrow Geom(p)\]
which has

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  mean \[E(Y)= \frac{1-p}{p}\]
\item
  and variance \[V(Y)= \frac{1-p}{p^2}\]
\end{enumerate}

\hypertarget{hypergeometric-model}{%
\section{Hypergeometric model}\label{hypergeometric-model}}

The \textbf{hypergeometric model} arises when we want to count the number of events of type \(A\) that are drawn from a finite population.

The general model is to consider \(N\) total balls in a urn. Mark \(K\) with label \(A\) and \(N-K\) with label \(B\). Take out \(n\) balls one by one with no replacement in the urn, and then count how many \(A\)'s you obtained.

The \textbf{Binomial} model can be derived from the \textbf{Hypergeometric} model when we consider that either \(N\) is infinite, or that every time we draw a ball we replace it back in the urn.

\textbf{Example (chickenpox):}

A school of \(N=600\) children has an epidemic of chickenpox. We tested \(n=200\) children and observed that \(x=17\) were positive. If we knew that a total of \(K=64\) were really infected in the school, what is the probability of our observation?

\textbf{Definition:}

The probability of obtaining \(x\) cases (type \(A\)) in a sample of \(n\) drawn from a population of \(N\) where \(K\) are cases (type \(A\)).

\(P(X=x)=P(one\,sample) \times (Number\, of\, ways\, of\, obtaining\, x)\)

\[=\frac{1}{\binom N n}\binom K x \binom {N-K} {n-x}\]

where \(k \in \{\max(0, n+K-N), ... \min(K, n) \}\)

We then say that \(X\) follows a hypergeometric distribution and write

\[X \rightarrow Hypergeometric(N,K,n)\]
The hypergeometric model has three parameters.

\textbf{Properties:}

If \(X \rightarrow Hypergeometric(N,K,n)\) then it has

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  mean \[E(X) =  n  \frac{K}{N} = np\]
\item
  and variance \[V(X) = np(1-p)\frac{N-n}{N-1}\]
\end{enumerate}

when \(p=\frac{K}{N}\) is the proportion of hepatitis C in a population of size \(N\). Note that when \(N \rightarrow \infty\) then we recover the binomial properties.

Let's look at some probability mass functions in the family of hypergeometric parametric models:

\includegraphics{_main_files/figure-latex/unnamed-chunk-59-1.pdf}

\includegraphics{_main_files/figure-latex/unnamed-chunk-60-1.pdf}

\textbf{Example (chickenpox):}

\begin{itemize}
\tightlist
\item
  what is the probability of infections less or equal than \(17\) in a sample of \(200\), drawn from a population of \(600\) where \(64\) are infected?
\end{itemize}

The probability that we need to compute is
\(P(X \leq 17)=F(17)\)

where \(X \rightarrow Hypergeometric(N=600,K=64,n=200)\)

in Python:

\begin{verbatim}
from scipy.stats import hypergeom
hypergeom.cdf(17, 600, 64, 200)
\end{verbatim}

The solution is the addition of the blue needles in the plot.

\includegraphics{_main_files/figure-latex/unnamed-chunk-61-1.pdf}

\hypertarget{questions-4}{%
\section{Questions}\label{questions-4}}

\textbf{1)} What is the expected value and the variance of the number of failures in \(100\) prototypes, when the probability of a failure is \(0.25\)

\textbf{\(\qquad\)a:} \(0.25\), \(0.1875\);
\textbf{\(\qquad\)b:} \(25\), \(0.1875\);
\textbf{\(\qquad\)c:} \(0.25\), \(18.75\);\\
\textbf{\(\qquad\)d:} \(25\), \(18.75\)

\textbf{2)} The number of available tables at lunch time in a restaurant is better described by which probability model

\textbf{\(\qquad\)a:} Binomial;
\textbf{\(\qquad\)b:} Uniform;
\textbf{\(\qquad\)c:} Negative Binomial;\\
\textbf{\(\qquad\)d:} Hypergeometric

\textbf{3)} The expected value of a Binomial distribution is not

\textbf{\(\qquad\)a:} \(n\) times the expected value of a Bernoulli;
\textbf{\(\qquad\)b:} the expected value of a Hypergeometric, when the population is very big;
\textbf{\(\qquad\)c:} \(np\);\\
\textbf{\(\qquad\)d:} the limit of the relative frequency when the number of repetitions is large

\textbf{4)} Opinion polls for the USA 2022 election give a probability of \(0.55\) that a voter favors the republican party. If we conduct our own poll and ask 100 random people on the street, How would you compute the probability that in our poll democrats win the election?

\textbf{\(\qquad\)a:}binom.cdf(49, 100, 0.55)=0.13;
\textbf{\(\qquad\)b:}1-binom.cdf(49, 100, 0.55)=0.86;
\textbf{\(\qquad\)c:}binom.cdf(51, 100, 0.45)=0.90; \textbf{\(\qquad\)d:}1-binom.cdf(51, 100, 0.45)=0.095

\textbf{5)} In an exam a student chooses at random one of the four answers that he does not know. If he doesn't know \(10\) questions what is the probability that more than \(5\) (\(>5\)) questions are correct?

\textbf{\(\qquad\)a:}binom.pmf(5, 10, 0.25)\textasciitilde{} 0.05; \textbf{\(\qquad\)b:}binom.cdf(5, 10, 0.75)\textasciitilde{} 0.07; \textbf{\(\qquad\)c:}binom.pmf(5, 10, 0.75)\textasciitilde{} 0.05; \textbf{\(\qquad\)d:}1-binom.cdf(5, 10, 0.25)\textasciitilde{} 0.01

\hypertarget{exercises-5}{%
\section{Exercises}\label{exercises-5}}

\hypertarget{exercise-1-4}{%
\subsubsection{Exercise 1}\label{exercise-1-4}}

If 20\% of the bolts produced by a machine are defective, determine the probability that, out of
4 bolts chosen at random

\begin{itemize}
\tightlist
\item
  1 bolts will be defective (R:0:4096)
\item
  0 bolts will be defective (R::4096)
\item
  at most 2 bolts will be defective (R:0:9728)
\end{itemize}

\hypertarget{exercise-2-4}{%
\subsubsection{Exercise 2}\label{exercise-2-4}}

In a population, the probability that a baby boy is born is \(p=0.51\). Consider a family of 4 children

\begin{itemize}
\tightlist
\item
  What is the probability that a family has only one boy?(R: 0.240)
\item
  What is the probability that a family has only one girl?(R: 0.259)
\item
  What is the probability that a family has only one boy or only one girl?(R: 0.4999)
\item
  What is the probability that the family has at least two boys?(R: 0.7023)
\item
  What is the number of children that a family should have such that the probability of having at least one girl is more than \(0.75\)?(R:\(n=3>\log(0.25)/\log(0.51)\))
\end{itemize}

\hypertarget{exercise-3-4}{%
\subsubsection{Exercise 3}\label{exercise-3-4}}

A search engine fails to retrieve information with a probability \(0.1\)

\begin{itemize}
\item
  If we system receives \(50\) search requests, what is the probability that the system fails to answer three of them?(R:0.1385651)
\item
  What is the probability that the engine successfully completes \(15\) searches before the first failure?(R:0.020)
\item
  We consider that a search engine works sufficiently well when it is able to find information for moe than \(10\) requests for every \(2\) failures. What is the probability that in a reliability trial our search engine is satisfactory?(R: 0.697)
\end{itemize}

\hypertarget{poisson-and-exponential-models}{%
\chapter{Poisson and Exponential Models}\label{poisson-and-exponential-models}}

\hypertarget{objective-3}{%
\section{Objective}\label{objective-3}}

In this chapter we will see two tightly related probability models: the \textbf{Poisson} and the \textbf{exponential} models.

The Poisson model is for discrete random variables while the exponential function is \textbf{continuous} random variables

\hypertarget{discrete-probability-models-1}{%
\section{Discrete probability models}\label{discrete-probability-models-1}}

In the previous chapter we built complex models from simple ones. At each stage, we introduced some novel concept:

\textbf{Uniform}: Classical interpretation of probability

\(\downarrow\)

\textbf{Bernoulli}: Introduction of a \textbf{parameter} \(p\) (family of models)

\(\downarrow\)

\textbf{Binomial}: Introductio of the \textbf{Repetition} of a random experiment (\(n\)-times Bernoulli trials)

\(\downarrow\)

\textbf{Poisson}: Repetition of random experiment within a continuous interval, having \textbf{no control} on when/where the Bernoulli trial occurs.

The last stage is the Poisson process that describes a the repetition of a random experiment with additional randomness at the time of repetition.

\hypertarget{poissson-experiment}{%
\section{Poissson experiment}\label{poissson-experiment}}

Imagine that we are observing events that \textbf{depend} on time or distance \textbf{intervals}.

for example:

\begin{itemize}
\tightlist
\item
  cars arriving at a traffic light
\item
  getting messages on your mobile phone
\item
  impurities occurring at random in a copper wire
\end{itemize}

Suppose that the events are outcomes of \textbf{independent} Bernoulli trials each appearing randomly on a continuous interval, and we want to \textbf{count} them.

What is the probability of observing \(X\) events in an interval's unit (time or distance)?

\textbf{Example (Impurities in a wire):}

Imagine that some impurities deposit randomly along a copper wire. You want to count the number of impurities in one given centimeter of the wire (\(X\)).

Consider that you know that on average there are \(10\) impurities per centimeter \(\lambda=10/cm\).

What is the probability of observing \(X=5\) impurities in one specimen of one centimeter in particular?

\hypertarget{poisson-probability-mass-function}{%
\section{Poisson probability mass function}\label{poisson-probability-mass-function}}

To calculate the probability mass function \(f(x)=P(X=x)\) of the previous example we divide the centimeter into micrometers (\(0.0001cm\)).

Micrometers are small enough so

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  either there is or there is not an impurity in each micrometer
\item
  each micrometer can be then be considered a \textbf{Bernoulli trial}
\end{enumerate}

\includegraphics{./figures/Pois.JPG}

\textbf{From the Binomial to the Poisson probability function}

The probability of observing \(X\) impurities in \(n=10,000\mu\) (1cm) approximately follows a binomial distribution

\[f(x) \sim \binom n x p^x(1-p)^{n-x}\]

where \(p\) is the probability of finding an impurity in a micrometer.

Since the expected value of a Binomial variable is:
\(E(X)=np\). This is the average number of impurities per 1cm or \(\lambda=np\). Therefore, substitute \(p=\lambda/n\)

\[f(x) \sim \binom n x \big(\frac{\lambda}{n}\big)^x(1-\frac{\lambda}{n})^{n-x}\]

Since, there \textbf{could} still be two impurities in a micrometer, we need to increase the partition of the wire and \(n \rightarrow \infty\).

Then in the limit:

\[f(x)= \frac{e^{-\lambda}\lambda^x}{x!}\]

Where \(\lambda\) is constant because it is the density of impurities per centimeter, a \textbf{physical property} of the system. \(\lambda\) is therefore the \textbf{parameter} of the probability model.

\textbf{Derivation details:}

For \(f(x) \sim \binom n x \big(\frac{\lambda}{n}\big)^x(1-\frac{\lambda}{n})^{n-x}\)

in the limit (\(n \rightarrow \infty\))

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  \(\frac{1}{n^x}\binom n x =\frac{1}{n^x}\frac{n!}{x! (n-x)!}=\frac{(n-x)!(n-x+1)...(n-1)n}{n^x x! (n-x)!}=\frac{n(n-1)..(n-x+1)}{n^x x!} \rightarrow \frac{1}{x!}\)
\item
  \((1-\frac{\lambda}{n})^{n} \rightarrow e^{-\lambda}\) (definition of exponential)
\item
  \((1-\frac{\lambda}{n})^{-x} \rightarrow 1\)
\end{enumerate}

Putting everything together then:

\(f(x)= \frac{e^{-\lambda}\lambda^x}{x!}\)

\textbf{Definition}

Given

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  an interval in the real numbers
\item
  counts occur at random in the interval
\item
  the average number of counts on the interval is known (\(\lambda\))
\item
  if one can find a small regular partition of the interval such that each of them can be considered Bernoulli trials.
\end{enumerate}

Then the random variable \(X\) that counts events across the interval is a \textbf{Poisson} variable with probability mass function\\
\[f(x)= \frac{e^{-\lambda}\lambda^x}{x!}, \lambda>0\]

\textbf{Properties:}
When \(X \rightarrow Poiss(\lambda)\) it has

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  mean \[E(X)= \lambda\]
\item
  and variance \[V(X)= \lambda\]
\end{enumerate}

\textbf{Examples}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  What is the probability of receiving 4 emails in an hour, when the average number of emails in an hour is \(1\)?
\end{enumerate}

We have that the variable is Poisson: \(X \rightarrow Poiss(\lambda)\) with \(\lambda=1\) and its probability mass function is:

\[f(x)= \frac{e^{-1}1^x}{x!}\]
Therefore the probability that the variable takes value 4 is \(P(X=4)\):

\(f(4; \lambda=1)= \frac{e^{-1}1^4}{4!}=0.01532831\)

in Python poisson.pmf(4,1)

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  What is the probability of receiving 4 emails in \textbf{three hours}, when the average number of emails in an hour is \(1\)?
\end{enumerate}

The unit in which we do the counts has changed from 1 hour to 2 hours, so we have to \textbf{re-scale} \(\lambda\). If before the average number of emails in one hour was \(\lambda=1\), the average number of emails in three hours is now 3: \(\lambda_{3h}=3\lambda_{1h}=3*1=3\)

We have that the variable is Poisson: \(X \rightarrow Poiss(\lambda_{3h})\) with \(\lambda_{3h}=3\) and its probability mass function is:

\[f(x)= \frac{e^{-3}3^x}{x!}\]
Therefore the probability that the variable takes value 4 is \(P(X=4)\):

\(f(4; \lambda=3)= \frac{e^{-3}3^4}{4!}=0.1680314\)

in Python poisson.pmf(4,3)

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  What is the probability of counting \textbf{at least} \(10\) cars arriving at a toll booth in one minute, when the average number of cars arriving at a toll booth in one minute is \(5\);
\end{enumerate}

We have that the variable is Poisson: \(X \rightarrow Poiss(\lambda)\) with \(\lambda=5\) and its probability mass function is:

\[f(x)= \frac{e^{-5}5^x}{x!}\]

\(P(X\geq 10)=1-P(X < 10)=1-P(X \leq 9)=1-F(9; \lambda=5)=0.03182806\)

in Python 1-poisson.cdf(9,5)

Let's look at some probability mass functions in the family of parametric Poisson models:

\includegraphics{_main_files/figure-latex/unnamed-chunk-62-1.pdf}

\hypertarget{continuous-probability-models}{%
\section{Continuous probability models}\label{continuous-probability-models}}

Continuous probability models are probability density functions \(f(x)\) of a continuous random variables that we \textbf{believe} describe real random experiments.

Probability density function \(f(x)\)

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  is positive
\end{enumerate}

\[f(x) \geq 0\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  allows us to compute probabilities using the area under the curve:
\end{enumerate}

\[P(a\leq X \leq b)=\int_{a}^{b} f(x) dx\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  is such that the probability of anything is \(1\):
\end{enumerate}

\[\int_{-\infty}^{\infty} f(x) dx = 1\]

\hypertarget{exponential-process}{%
\section{Exponential process}\label{exponential-process}}

Let's go back to a \textbf{Poisson process} defined by probability

\[f(k)=\frac{e^{-\lambda}\lambda^k}{k!}, \lambda>0\]

for the number of events (\(k\)) in an interval.

Let us now consider that we are interested in the duration/time we should wait for the \textbf{first} count to occur.

We can ask about the probability that the first event occurs after duration/time \(X\).

Therefore, since \(X\) is a \textbf{continuous} random variable, we look for its probaility density function \(f(x)\).

\hypertarget{exponential-probability-density}{%
\section{Exponential probability density}\label{exponential-probability-density}}

The probability of \(0\) counts \textbf{if} an interval has unit \(x\) is

\[f(0|x)=\frac{e^{-x\lambda}x\lambda^0}{0!}\]

or

\[f(0|x)=e^{-x\lambda}\]

We can treat this as the conditional probability of \(0\) events in a distance \(x\): \(f(K=0|X=x)\) and apply the Bayes theorem to reverse it:

\[f(x|0)=C f(0|x)=C e^{-x\lambda}\]

So we can calculate the \textbf{probability of observing a distance} a distance \(x\) with \(0\) counts. This is the distance between any two events or the distance until the first event.

\textbf{Definition}

In a Poisson process with parameter \(\lambda\) the probability of waiting a distance/time \(X\) between two counts is given by the \textbf{probability density}

\[f(x)= C e^{-x\lambda}\]

\begin{itemize}
\item
  \(C\) is a constant that ensures: \(\int_{-\infty}^{\infty} f(x) dx =1\)
\item
  by integration \(C=\lambda\)
\end{itemize}

Therefore:

\[f(x)=\lambda e^{-\lambda x}, x\geq 0\]

\(\lambda\) is the paramenter of the model also known as a \textbf{decay rate}.

\textbf{Properties:}

When \(X \rightarrow Exp(\lambda)\) then

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  It has mean
\end{enumerate}

\[E(X)=\frac{1}{\lambda}\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  and variance
  \[V(Y)=\frac{1}{\lambda^2}\]
\end{enumerate}

Let's look at a couple of the probability densities in the exponential family

\includegraphics{_main_files/figure-latex/unnamed-chunk-63-1.pdf}

\hypertarget{exponential-distribution}{%
\section{Exponential Distribution}\label{exponential-distribution}}

Consider the following questions:

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  In a Poisson process ¿What is the probability of observing an interval \textbf{smaller} than size \(a\) until the first count?
\end{enumerate}

Remember that this probability \(F(a)=P(X \leq a)\) is the probability density

\[F(a)=\lambda \int_\infty^a e^{-x\lambda}dx=1-e^{-a\lambda}\]
2) In a Poisson process ¿What is the probability of observing an interval \textbf{larger} than size \(a\) until the first event?

\[P(X > a)=1- P(X \leq a)= 1- F(a) = e^{-a\lambda}\]

Let's look at a couple of exponential distributions from the exponential family

\includegraphics{_main_files/figure-latex/unnamed-chunk-64-1.pdf}

The median \(x_m\) is such that \(F(x_m)=0.5\). That is \(x_m=\frac{\log(2)}{\lambda}\)

\textbf{Examples}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  What is the probability that we have to wait for a bus for more than \(1\) hour when on average there are two buses per hour?
\end{enumerate}

\[P(X > 1)=1-P(X \le 1) = 1-F(1,\lambda=2)=0.1353353\]
in Python 1-expon.cdf(1,0,1/2)

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  What is the probability of having to wait less than \(2\) seconds to detect one particle when the radioactive decay rate is \(2\) particles each second; \(F(2,\lambda=2)\)
\end{enumerate}

\[P(X \le 2)=F(2,\lambda=2)=0.9816844\]

in Python expon.cdf(2,0,1/2)

\hypertarget{questions-5}{%
\section{Questions}\label{questions-5}}

\textbf{1)} During WWII in London, the expected number of bombs that hit an area of \(3km^2\) was \(0.92\). The probability that, in one day, one area received two bombs was

\textbf{\(\qquad\)a:}1-poisson.cdf(x=2, lambda=0.92);
\textbf{\(\qquad\)b:}poisson.cdf(x=2, lambda=0.92); \textbf{\(\qquad\)c:}1-poisson.pmf(x=2, lambda=0.92); \textbf{\(\qquad\)d:}poisson.pmf(x=2, lambda=0.92)

\textbf{2)} The probability that a passenger has to wait less than 20 minutes until the next bus arrives at her stop is better described by

\textbf{\(\qquad\)a:} A poisson model on the number of buses per 20 minutes;\\
\textbf{\(\qquad\)b:} An exponential distribution at 20 minutes with a given expectation of buses per minute;
\textbf{\(\qquad\)c:} A binomial model that counts the number of buses per 20 minutes
\textbf{\(\qquad\)d:} A normal distribution with an average of buses per 20 minutes and a given standard deviation;

\textbf{3)} From the exponential probability distribution in the figure below, what is the most likely value of the median?

\textbf{\(\qquad\)a:} \(2\); \textbf{\(\qquad\)b:} \(3\); \textbf{\(\qquad\)c:} \(4\); \textbf{\(\qquad\)d:} \(5\)

\includegraphics{./figures/exp.png}

\hypertarget{exercises-6}{%
\section{Exercises}\label{exercises-6}}

\hypertarget{exercise-1-5}{%
\subsubsection{Exercise 1}\label{exercise-1-5}}

The average number of phone calls per hour coming into the switchboard of a company is \(150\). Find the probability that during one particular minute there will be

\begin{itemize}
\tightlist
\item
  0 phone calls (R:0.082)
\item
  1 phone call (R:0.205)
\item
  4 or fewer calls (R:0.891)
\item
  more than 6 phone calls (R:0.0141)
\end{itemize}

\hypertarget{exercise-2-5}{%
\subsubsection{Exercise 2}\label{exercise-2-5}}

The average number of radioactive particles hitting a Geiger counter in a nuclear energy plant under control is \(2.3\) per minute.

\begin{itemize}
\item
  What is the probability of counting exactly \(2\) particles in a minute? (R:0.265)
\item
  What is the probability of detecting exactly \(10\) particles in \(5\) minute? (R:0.112)
\item
  What is the probability of at least one count in two minutes? (R:0.9899)
\item
  What is the probability of having to wait less than \(1\) second to detect a radioactive particle, after we switch on the detector? (R:0.037)
\item
  We suspect that a nuclear plant has a radioactive leak if we wait less than \(1\) second to detect a radioactive particle, after we switch on the detector. What is the probability that when we visit in \(5\) plants that are under control, we suspect that at least one has a leak? (R:0.1744).
\end{itemize}

\hypertarget{normal-distribution}{%
\chapter{Normal Distribution}\label{normal-distribution}}

\hypertarget{objective-4}{%
\section{Objective}\label{objective-4}}

In this chapter we will introduce the normal probability distribution.

We will discuss its origin and its main properties.

\hypertarget{history}{%
\section{History}\label{history}}

In 1801 Gauss analyzed data obtained for the position of the Ceres, a large asteroid between Mars and Jupiter.

At the time people suspected it was a new planet, as it moved day to day against the fixed stars. In January, it could be seen at the horizon just before dawn. However, as days passed Ceres will rise latter and latter until it could not longer be seen because of the Sun rise.

Gauss understood that the measurements for the position of Ceres had errors.

He was therefore interested in finding how the observations were \textbf{distributed} so he could find the most \textbf{likely} orbit. With the orbit, we could derive the mass of the object and then decide whether it was a planet or a big asteroid.

Data was available only for the month of January. After which Ceres would disappear. He wanted to \textbf{predict} where astronomers should point their telescopes to find it six months after at dusk, once it had passed behind the Sun.

Gauss had to account for the errors in the position of ceres at a given day due to measurement

\includegraphics{./figures/ceres.JPG}

Gauss supposed that

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  small errors were more likely than large errors
\item
  the error at a distance \(-\epsilon\) from the value at the position of Ceres was equally likely as a distance \(\epsilon\)
\item
  the most \textbf{likely} position (the one that we believe the most) of Ceres at any given time in the sky was the \textbf{average} of multiple altitude measurements at that latitude.
\end{enumerate}

That was enough to show that the deviations of the observations \(y\) \textbf{from the orbit} satisfied the equation

\[\frac{df(y)}{dy}=-Cyf(y)\]
with \(C\) a positive constant. The solution of this differential equation is:

\[f(y)=\frac{\sqrt{C}}{\sqrt{2\pi}}e^{-\frac{Cy^2}{2}}\]

*The evolution of the normal distribution, Saul Stahl, Mathemetics Magazine, 2006.

\hypertarget{normal-density}{%
\section{normal density}\label{normal-density}}

Gaussian probability density gives the distribution of measurement errors from the \textbf{actual} but \textbf{unknown} position of Ceres in the sky. Let's make a couple of changes to the function.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  Let's write the error density from the horizon using the random variable \(X\), that is, \(y=x-\mu\). \(\mu\) is the \textbf{actual} but \textbf{unknown} position of Ceres from the horizon. After a change of variable we find the probability density function:
\end{enumerate}

\[f(x)=\frac{\sqrt{C}}{\sqrt{2\pi}}e^{-C(x-\mu)^2}\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  Let's rename the variable \(C\) to \(\frac{1}{\sigma^2}\)
\end{enumerate}

So, we arrive at the following definition.

\hypertarget{definition}{%
\section{Definition}\label{definition}}

A random variable \(X\) defined on the real numbers has a density \textbf{Normal} if it takes the form

\[f(x; \mu, \sigma^2)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^2}{2\sigma^2}}, x \in {\mathbb R}\]

The variable has

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  mean
\end{enumerate}

\[E(X) = \mu\]

which for Gauss represented the actual position of Ceres.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  and variance
  \[V(X) = \sigma^2\]
\end{enumerate}

which represented the dispersion of the error in the observations, which depends on the quality of the telescope.

\(\mu\) and \(\sigma\) are the \textbf{two parameters} that completely describe the normal density function and their \textbf{interpretation} depends on the random experiment.

When \(X\) follows a Normal density, that is, it is normally distributed, we write

\[X\rightarrow N(\mu,\sigma^2)\]

Let's look at some probability densities in the normal parametric model

\includegraphics{_main_files/figure-latex/unnamed-chunk-65-1.pdf}

\hypertarget{probability-distribution-2}{%
\section{Probability distribution}\label{probability-distribution-2}}

The probability distribution of the Normal density:

\[F_{normal}(a)=P(Z \leq a)\]

is the \textbf{error} function defined by the area under the curve from \(-\infty\) to \(a\)

\[F_{normal}(a)=\int_{-\infty}^{a}\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^2}{2\sigma^2}} dx\]
The function is found in most computer programs, and it does not have a closed form of known functions.

\textbf{Example (women's height)}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  What is the probability that a woman in the population is at most \(150cm\) tall if women have a mean height of \(165cm\) with standard deviation of \(8cm\)?
\end{enumerate}

\(P(X\le 150)=F(150, \mu=165, \sigma=8)=0.03039636\)

In Python norm.cdf(150, 165, 8)

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  What is the probability that a woman's height in the population is between \(165cm\) and \(170cm\)?
\end{enumerate}

\(P(165 \le X \le 170)=F(170, \mu=165, \sigma=8)-F(165, \mu=165, \sigma=8)=0.2340145\)

In Python norm.cdf(170, 165, 8)-norm.cdf(165, 165, 8)

Let's look at the probability distribution function

\includegraphics{_main_files/figure-latex/unnamed-chunk-66-1.pdf}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  What is the first quartile for height in women?
\end{enumerate}

The first quartile is defined as:

\(F(x_{0.25}, \mu=165, \sigma=8)=0.25\)

or

\(x_{0.25}=F^{-1}(0.25, µ=165, \sigma=8)=159.6041\)

In Python norm.ppf(0.25, 165, 8)

\textbf{Properties of the Normal distribution}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  the mean \(\mu\) is also the median as it splits the measurements in two
\item
  \(x\) values that fall farther than 2\(\sigma\) are considered \textbf{rare} \(5\%\)
\item
  \(x\) values that fall farther than 3\(\sigma\) are considered \textbf{extremely rare} \(0.2\%\)
\end{enumerate}

\includegraphics{./figures/probs.png}

\textbf{Example (women's height)}

We can define the limits of \textbf{common observations} for the distribution of women's height in the population.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  at a distance of one standard deviation from the mean, we find \(68\%\) of the population
\end{enumerate}

\[P(165-8 \leq X \leq 165+8)=P(157 \leq X \leq 173)=F(173)-F(157)=0.68\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  at a distance of two standard deviations from the mean, we find \(95\%\) of the population
\end{enumerate}

\[P(165-2 \times 8 \leq X \leq 165+2\times 8)=F(181)-F(149)=0.95\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  at a distance of three standard deviations from the mean, we find \(99.7\%\) of the population
\end{enumerate}

\[P(165-3 \times 8 \leq X \leq 165+3\times 8)=F(189)-F(141)=0.997\]

\includegraphics{_main_files/figure-latex/unnamed-chunk-67-1.pdf}

\hypertarget{standard-normal-density}{%
\section{Standard normal density}\label{standard-normal-density}}

The standard normal density is the particular density from the normal family

\[f(x; \mu, \sigma^2)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^2}{2\sigma^2}}, x \in {\mathbb R}\]

It is therefore the density with

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  mean
\end{enumerate}

\[E (X)= \mu = 0\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  and variance
\end{enumerate}

\[V (X)=  \sigma^2 =1\]

When a random variable follows a normal probability density, we say that it distributes normally and write

\[X \rightarrow N(0,1)\]

\hypertarget{standard-distribution}{%
\section{Standard distribution}\label{standard-distribution}}

The probability distribution of the standard density:

\[\phi(a)=F_{N(0,1)}(a)=P(Z \leq a)\]

is the \textbf{error} function defined by

\[\phi(a)=\int_{-\infty}^{a} \frac{1}{\sqrt{2\pi}}e^{-\frac{z^2}{2}} dz\]

Because the standard distribution is special and will appear often then we use the letter \(\phi\) for it.

\includegraphics{./figures/st.png}

You can find it in most computer programs. In Python is norm.cdf(x) with the default parameters, 0 and 1.

We usually define the limits of the \textbf{most common observations} for the standard variable

\includegraphics{./figures/phi.JPG}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  The interquartile range \[P(-0.67 \leq X \leq 0.67)=0.50\]
\end{enumerate}

In Python: {[}norm.ppf(0.25), norm.ppf(0.75){]}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  \(95\%\) range \[P(-1.96 \leq X \leq 1.96)=0.95\]
\end{enumerate}

In Python: {[}norm.ppf(0.025), norm.ppf(0.975){]}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  \(99\%\) range \[P(-2.58 \leq X \leq 2.58)=0.99\]
\end{enumerate}

In Python: {[}norm.ppf(0.005), norm.ppf(0.995){]}

\includegraphics{_main_files/figure-latex/unnamed-chunk-68-1.pdf}

\hypertarget{standardization}{%
\section{Standardization}\label{standardization}}

All normal variables can be \textbf{standardized}. This means that if \(X \rightarrow N(\mu, \sigma^2)\), then we can transform the variable to
a \textbf{standardized variable}

\[Z=\frac{X-\mu}{\sigma}\]

which will have density:

\[f(z)=\frac{1}{ \sqrt{2\pi}}e^{-\frac{z^2}{2}}\]
Therefore, for any \(X \rightarrow N(\mu, \sigma^2)\)

\[Z=\frac{X-\mu}{\sigma} \rightarrow N(0, 1) \]

\includegraphics{./figures/stand.png}

You can demonstrate this by replacing \(x=\sigma z+\mu\) and \(dx=\sigma dz\) in the probability expression we have

\(P(x\leq X \leq x +dx)=P(z\leq Z \leq z +dz)\)
\[=\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^2}{2\sigma^2}}dx\] \[=\frac{1}{ \sqrt{2\pi}}e^{-\frac{z^2}{2}} dz\]

We can compute the probability of \textbf{any normal variable} \(X\rightarrow N(\mu, \sigma^2)\) using the standard distribution

\(F(a)=P(X<a)=P(\frac{X-\mu}{\sigma}<\frac{a-\mu}{\sigma})\)
\[=P(Z < \frac{a-\mu}{\sigma})= \phi \big(\frac{a-\mu}{\sigma}\big)\]

For computing \(P(a\leq X \leq b)\), we use the property of the probability distributions

\(F(b)-F(a)=P(X\leq b)-P(X\leq a)\)

\[=\phi \big(\frac{b-\mu}{\sigma}\big)-\phi \big(\frac{a-\mu}{\sigma}\big)\]

\hypertarget{summary-of-probability-models}{%
\section{Summary of probability models}\label{summary-of-probability-models}}

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1667}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1905}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1905}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1667}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1429}}
  >{\centering\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1429}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\centering
Model
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
X
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
range of x
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
f(x)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
E(X)
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
V(X)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Uniform & integer or real number & \([a, b]\) & \(\frac{1}{n}\) & \(\frac{b+a}{2}\) & \(\frac{(b-a+1)^2-1}{12}\) \\
Bernoulli & event A & 0,1 & \((1-p)^{1-x}p^x\) & \(p\) & \(p(1-p)\) \\
Binomial & \# of A events in \(n\) repetitions of Bernoulli trials & 0,1,\ldots{} & \(\binom n x (1-p)^{n-x}p^x\) & \(np\) & \(np(1-p)\) \\
Negative Binomial for events & \# of B events in Bernoulli repetitions before \(r\) As are observed & 0,1,.. & \(\binom {x+r-1} x (1-p)^xp^r\) & \(\frac{r(1-p)}{p}\) & \(\frac{r(1-p)}{p^2}\) \\
Hypergeom & \# A events in a sample \(n\) from population \(N\) with \(K\) As & \(\max(0, n+K-N)\), \ldots{} \(\min(K, n)\) & \(\frac{1}{\binom N n}\binom K x \binom {N-K} {n-x}\) & \(n*\frac{N}{K}\) & \(n \frac{N}{K} (1-\frac{N}{K})\frac{N-n}{N-1}\) \\
Poisson & \# of events A in an interval & 0,1, .. & \(\frac{e^{-\lambda}\lambda^x}{x!}\) & \(\lambda\) & \(\lambda\) \\
Exponential & Interval between two events A & \([0,\infty)\) & \(\lambda e^{-\lambda x}\) & \(\frac{1}{\lambda}\) & \(\frac{1}{\lambda^2}\) \\
Normal & measurement with symmetric errors whose most likely value is the average & \((-\infty, \infty)\) & \(\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^2}{2\sigma^2}}\) & \(\mu\) & \(\sigma^2\) \\
\end{longtable}

\newpage

\hypertarget{python-functions-of-probability-models}{%
\section{Python functions of probability models}\label{python-functions-of-probability-models}}

\begin{longtable}[]{@{}lc@{}}
\toprule\noalign{}
Model & Python \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Uniform (continuous) & uniform.pdf(x, a, b) \\
Binomial & binom.pmf(x,n,p) \\
Negative Binomial for events & nbinom.pmf(x,r,p) \\
Hypergeom & hypergeom.pmf(x, N, K, n) \\
Poisson & poisson.pmf(x, lambda) \\
Exponential & expon.pdf(x,0,1/lambda) \\
Normal & norm.pdf(x, mu, sigma) \\
\end{longtable}

\hypertarget{questions-6}{%
\section{Questions}\label{questions-6}}

\textbf{1)} It is not true that for a normally distributed variable

\textbf{\(\qquad\)a:} its mean and median are the same; \textbf{\(\qquad\)b:} the standard probability distribution can be used to compute its probabilities; \textbf{\(\qquad\)c:} its interquartile range is twice its standard deviation; \textbf{\(\qquad\)d:} \(5\%\) of its observations are a distance greater than twice its standard deviation

\textbf{2)} For a normal standard variable

\textbf{\(\qquad\)a:} \(50\%\) of its observations are between \((-0.67,0.67)\);
\textbf{\(\qquad\)b:} \(2\%\) of its observations are lower than \(-2.58\);
\textbf{\(\qquad\)c:} \(5\%\) of its observations are greater than \(1.96\);
\textbf{\(\qquad\)d:} \(25\%\) of its observations are between \((-1.96,-0.67)\)

\textbf{3)} if we know that \(\phi(-0.8416212)=0.2\) then what is \(\phi(0.8416212)\)

\textbf{\(\qquad\)a:} \(0.1\);
\textbf{\(\qquad\)b:} \(0.2\);
\textbf{\(\qquad\)c:} \(0.8\);
\textbf{\(\qquad\)d:} \(0.9\)

\textbf{4)} the third quartile of a normal variable with mean \(10\) and standard deviation \(2\) is

\textbf{\(\qquad\)a:} norm.ppf(1/3, 10, 2)=9.138545;
\textbf{\(\qquad\)b:} norm.ppf(1-0.75, 10, 2)=8.65102 ;
\textbf{\(\qquad\)c:} norm.ppf(1-1/3, 10, 2)=10.86145 ;
\textbf{\(\qquad\)d:} norm.ppf(0.75, 10, 2)= 11.34898

\textbf{5)} probability that a normal variable with mean \(10\) and standard deviation \(2\) is in \((-\infty,10)\) is

\textbf{\(\qquad\)a:} 0.25;
\textbf{\(\qquad\)b:} 0.5;
\textbf{\(\qquad\)c:} 0.75;
\textbf{\(\qquad\)d:} 1:

\hypertarget{exercises-7}{%
\section{Exercises}\label{exercises-7}}

\hypertarget{exercise-1-6}{%
\subsubsection{Exercise 1}\label{exercise-1-6}}

Find the area under the standard normal curve in the following cases:

\begin{itemize}
\tightlist
\item
  Between \(z=0.81\) and \(z=1.94\) (R:0.182)
\item
  To the right of \(z=-1.28\) (R:0.899)
\item
  To the right of \(z=2.05\) or to the left of \(z=-1.44\) (R:0.0951)
\end{itemize}

\hypertarget{exercise-2-6}{%
\subsubsection{Exercise 2}\label{exercise-2-6}}

\begin{itemize}
\item
  What is the probability that a man's height is at least
  \(165\)cm if the population mean is \(175\)cm y the standard deviation is \(10\)cm? (R:0.841)
\item
  What is the probability that a man's height is between
  \(165\)cm and \(185\)cm? (R:0.682)
\item
  What is the height that defines the \(5\%\) of the smallest men? (R:158.55)
\end{itemize}

\hypertarget{sampling-distributions}{%
\chapter{Sampling distributions}\label{sampling-distributions}}

\hypertarget{objective-5}{%
\section{Objective}\label{objective-5}}

In this chapter, we are going to study estimates of the mean and variance of normal distributions using \textbf{random samples}.

We will introduce the \textbf{sample mean} and the \textbf{sample variance} as random variables that estimate the parameters of the normal distribution.

The sample mean and the sample variance have probability density functions, these are called \textbf{sample density functions}.

\hypertarget{aleatory-sample}{%
\section{Aleatory sample}\label{aleatory-sample}}

\textbf{Example (Cables)}

Imagine that a client asks your metallurgical company to sell cables for \(8\) that can transport up to \(96\) Tons; that's \(12\) Tons each. You must guarantee that none of them will break with this weight.

You \textbf{stock} a set of cables that might work, but you're not sure. So you take \(8\) Cables at random, and charge them until they break.

We say that you take a \textbf{random sample} of size \(8\), which means that you repeat the random experiment \(8\) times. Here are the results

\begin{verbatim}
## [1] 13.34642 13.32620 13.01459 13.10811 12.96999 13.55309 13.75557 12.62747
\end{verbatim}

\includegraphics{_main_files/figure-latex/unnamed-chunk-70-1.pdf}

\textbf{Definition:}

A \textbf{random sample} of size \(n\) is the \textbf{replication} of a random experiment \(n\) \textbf{independent} times.

\begin{itemize}
\tightlist
\item
  A random sample is an \textbf{random variable} \(n\)-dimensional
\end{itemize}

\[(X_1, X_2, ... X_n)\]

where \(X_i\) is the \emph{i-th} iteration of the random experiment with common distribution \(f(x; \theta)\) for any \(i\)

\begin{itemize}
\tightlist
\item
  \textbf{An observation} of a random sample is the set of \(n\) values obtained from the experiments
\end{itemize}

\[(x_1, x_2, ... x_n)\]
Our \textbf{observation} of the sample of size \(8\) cables was

\begin{verbatim}
## [1] 13.34642 13.32620 13.01459 13.10811 12.96999 13.55309 13.75557 12.62747
\end{verbatim}

\textbf{Example (Cables)}

In the observed sample of the breaking load of the cables it was observed that

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  None of them broke \(12\) Tons.
\item
  There was one that broke at \(12.62747\) Tons.
\end{enumerate}

Do you take a chance and sell a random sample of \(8\) cables from your stock? What happens if your company is responsible for a cable break and has to pay a large fine?

To assure the customer that the cables will not break at \(12\) Tons, we would like to see that \(P(X \leq 12)\) is reasonably low.

\hypertarget{calculation-of-probabilities}{%
\section{Calculation of probabilities}\label{calculation-of-probabilities}}

To calculate probabilities we need:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  A probability model (probability function)
\item
  The parameters of the model (the values of the probability function)
\end{enumerate}

Let's \textbf{assume} that the breaking load of the cables follows a \textbf{normal} probability density function.

\[X \rightarrow N(x; \mu, \sigma^2)\]

To compute \(P(X \leq 12)\), we need the parameters \(\mu\) and \(\sigma^2\). How can we estimate the parameters of the observed sample?

\hypertarget{parameter-estimation}{%
\section{Parameter estimation}\label{parameter-estimation}}

To find likely values for the parameters we use data. Therefore, we take a \textbf{random sample}. That is, we repeat the experiment \(n\) times, collect data, and use it to estimate the parameters.

\textbf{Estimate of the mean and variance}

Recall that for a discrete random variable, we define the mean as

\[\mu=\sum_{i}^m x_if(x_i)\]

which is the center of gravity of the \textbf{probabilities}, where \(f(x_i)\) is the probability function. This definition was motivated by the center of gravity of the \textbf{observations}

\[\bar{x}= \frac{1}{n} \sum_{i}^n x_i = \sum_{i}^m x_if_i\]

which we define as the \textbf{average}, and where \(f_i\) are the relative frequencies. Remember that \(n\) is the number of observations (it can be as large as we want) and \(m\) is the number of possible outcomes (usually fixed by the sample space). We have argued that when \(n \rightarrow \infty\) then

\[\hat{P}(X=x)=f_i\]
This means that the probabilities can be \textbf{estimated} (by putting on a \textbf{hat}) by the relative frequencies when \(n\) is large, because \(lim_{n\rightarrow \infty}f_i=f(x_i)\). Therefore, we should also have that the \textbf{mean} \(\mu\) can be estimated by the \textbf{mean} \(\bar{x}\)

\[\hat{\mu}=\bar{x}= \sum_{i}^m x_i\hat{P}(X=x)\]

Thus, we may take the center of the probability function as the center of gravity of the data. Doing this we will make an error that we can assume, as we will discuss later on.

With the variance

\[\sigma^2=\sum_{i}^m(x_i-\mu)^2f(x_i)\]

we have a similar situation. In the limit when \(n \rightarrow \infty\)

\[\hat{\sigma}^2=s^2=\frac{1}{n-1}\sum_{i=1}^n(x_i-\bar{x})^2\]

and we assume that the moment of inertia of the data is close to the moment of inertia of the probabilities.

\textbf{Example (Cables)}

Assuming that the breaking load of our cable is a normal random variable

\[X \rightarrow N(x; \mu, \sigma^2)\]

\textbf{we use} the estimates \(\bar{x}_{stock}=13.21\) (np.mean(x)) and \(s^2=0.3571565^2\) (np.var(x)) as the values of \(\mu\) and \(\sigma^2\). So the \textbf{fitted} model is

\[X \rightarrow N(x; \mu=13.21, \sigma^2=0.3571565^2)\]
In this problem we \textbf{didn't know} \(\mu\) or \(\sigma\) and therefore we are guessing their values and the underlying model

\includegraphics{_main_files/figure-latex/unnamed-chunk-72-1.pdf}

What is the probability that the cable will break at \(12\) Tons?

Since \[X \rightarrow N(x; \mu=13.21, \sigma^2=0.3571565^2)\]

so

\[P(X \leq 12)= F(12; \mu=13.21, \sigma^2=0.1275608)\]

In Python norm.cdf(12,13.21, 0.3571565)\(=0.000352188\)

Given the \textbf{observed} sample, there is an estimated probability of \(0.03\%\) that a single cable breaks in \(12\) Tons. We have a probabilistic argument for selling the cables.

\hypertarget{margin-of-error-of-estimates}{%
\section{Margin of error of estimates}\label{margin-of-error-of-estimates}}

When we estimate parameters using data, such as by taking the value of \[\hat{\mu}=\bar{x}\]

for the value of \(\mu\); and the value of

\[\hat{\sigma}^2=s^2\]
by the value of \(\sigma^2\), we know that we are \textbf{making a mistake}. We know that if we take another sample of size \(8\) cables \textbf{the estimate will change}, because the average \(\bar{x}\) will change.

Can we get an idea of how big the error is in our estimate?

The first thing to realize is that the numerical value we get for \[\bar{x}\] is the observation of a \textbf{random variable} \[\bar{X}\]

\textbf{Definition}

The \textbf{sample mean} (or average) of a random sample of size \(n\) is defined as

\[\bar{X}=\frac{1}{n}\sum_{i=1}^n X_i\]

The average is a \textbf{random variable} that in our sample of size \(8\) took the value

\[\bar{x}_{stock}=13.21\]

If we take another sample, this number will change.

\textbf{Mean as estimator}

The number \(\bar{x}\) can be used to \textbf{estimate} the unknown parameter \(\mu\) because the random variable \(\bar{X}\) satisfies these two important properties

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  is \textbf{unbiased}: \[E(\bar{X})=\mu\]
\item
  is \textbf{consistent}: \[lim_{n \rightarrow \infty} V(\bar{X}) = 0\]
\end{enumerate}

The first property holds because
\[E(\bar{X})=E\big(\frac{1}{n}\sum_{i=1}^n X_i\big)=E(X)=\mu\]

The second property holds because
\[V(\bar{X})=V\big(\frac{1}{n}\sum_{i=1}^n X_i\big)=\frac{V(\sum_{i=1}^ nX_i)}{n^2}=\frac{V(X)}{n}=\frac{\sigma^2}{n}\]

Which uses the fact that each random experiment in the sample is independent and therefore \(V(\sum_{i=1}^n X_i)=nV(X)\).

\emph{Estimate of \(\mu\)}

As a consequence of properties 1 and 2, we understand that the value \(\bar{x}\) \textbf{concentrates closer and closer} to \(\mu\) as \(n\) increases. This means that the error we make when we take a value of \(\bar{x}\) as the estimate of \(\mu\)

\[\bar{x}=\hat{\mu}\]

gets smaller and smaller as the sample gets larger and larger because the variance of \(\bar{x}\) gets smaller with large \(n\).

\hypertarget{inference}{%
\section{Inference}\label{inference}}

We know that when we take large samples, our error is small. However, for a given value of \(n\) we want to have a \textbf{error measure}. Therefore, we ask about the \textbf{probability of making an error} of a given size when estimating \(\mu\) with \(\bar{x}\).

When we calculate probabilities in an estimator, we say that we are making an \textbf{inference}. Inference problems often arise when we are interested in calculating the probability of making an error in estimating \(\mu\) with \(\bar{x}\).

To calculate probabilities we need

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  A probability model (probability function)
\item
  The parameters of the model (the values of the probability function)
\end{enumerate}

What are the probability functions of \(\bar{X}\) and \(S^2\) so that we can calculate their probabilities?

These probability functions are called \textbf{sampling probability functions}, because they are derived from a sampling experiment.

\textbf{Example (Cables)}

Let's ask an inference question. Imagine our cables are \textbf{certified} to break with an average load of \(\mu = 13\) Tons with variance \(\sigma^2=0.35^2\).

If we take a random sample of \(8\) cables, what is the probability that the sample mean \(\bar{X}\) will be within a \textbf{margin of error} of \(0.25\) Tons of the mean \(\mu\)?

\[P(- 0.25\leq \bar{X}-\mu \leq 0.25)\]

To calculate this probability, we need to know the probability function of \(\bar{X}\).

\hypertarget{sample-mean-distribution}{%
\section{Sample mean distribution}\label{sample-mean-distribution}}

\textbf{Theorem:} If \(X\) follows a normal distribution \[X \rightarrow N(\mu, \sigma^2)\]

then \(\bar{X}\) is normal

\[\bar{X} \rightarrow N(\mu, \frac{\sigma^2}{n})\]
and \(\bar{X}\) has

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  mean
  \[E(\bar{X})=\mu\]
  We say that \(\bar{X}\) is unbiased because its expected value is exaclty \(\mu\).
\item
  variance
  \[V(\bar{X})=\frac{\sigma^2}{n}\]
  We say that \(\bar{X}\) is consistent because is gets smaller with large \(n\).
\end{enumerate}

We call \(se=\sqrt{V(\bar{X})}\) the \textbf{standard error} of the sample mean. The standard error is also written as \(\sigma_{\bar{x}}\). Note that this is the error we expect when using \(\bar{x}\) as the value of \(\mu\), and it is the bias we need to correct when estimating the variance (Section 10.8).

So, if we \textbf{know} \(\mu\) and \(\sigma\), we can calculate the \textbf{probabilities of} \(\bar{X}\) using the normal distribution.

Remember that we have \textbf{two probability functions}:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  The probability function of \(X\) is also known as the \textbf{population} probability function
\item
  The probability function of \(\bar{X}\) is a probability function of the \textbf{sample}.
\end{enumerate}

\textbf{Example (Cables)}

\emph{Probability densities for \(X\) and \(\bar{X}\)}

In our new problem, we now \textbf{know} \(\mu\) and \(\sigma\) and the probability function of the \textbf{population}

\[X \rightarrow N(\mu=13, \sigma^2=0.35^2)\]

\includegraphics{_main_files/figure-latex/unnamed-chunk-73-1.pdf}

Since \(X\) is normal, then \(\bar{X}\) is normal, and therefore we also know the probability function of the sample mean \(\bar{X}\)

\[\bar{X} \rightarrow N(13, \frac{0.35^2}{8})\]

which has mean and variance

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  \(E(\bar{X})=\mu=13\)
\item
  \(V(\bar{X})=\frac{\sigma^2}{n}=\frac{0.35^2}{8}=0.01530169\)
\end{enumerate}

\includegraphics{_main_files/figure-latex/unnamed-chunk-74-1.pdf}

Finally we want to calculate \textbf{the probability} that our estimate has a margin of error of \(0.25\). That is a distance of \(0.25\) from the mean. That's \[P(-0.25 \leq \bar{X} - 13\leq 0.25)=P(12.75 \leq \bar{X} \leq 13.25)\]

\(=F(13.25; \mu, \sigma^2/n)-F(12.75; \mu, \sigma^2/n)\)

In Python we can calculate it as:

norm.cdf(13.25, 13, 0.1237)-norm.cdf(12.75, 13, 0.1237)=0.956.

Remember: \(se=\sigma_{\bar{x}}=\sqrt{0.01530169}=0.1237\)

Therefore \(95.6\%\) of the means \(\bar{X}\) of random samples of size \(8\) are at a distance of \(0.25\) from the mean \(\mu=13\).

If we sell our process for building the cables, we can tell new manufacturers that when they follow our instructions, they can test the process by taking a sample of size \(8\) cables. In that case, they can expect the sample mean to fall between \((12.75, 13.25)\) about \(95\%\) of the times.

\includegraphics{_main_files/figure-latex/unnamed-chunk-75-1.pdf}

When we perform random sampling we observe:

\begin{verbatim}
## [1] 13.34642 13.32620 13.01459 13.10811 12.96999 13.55309 13.75557 12.62747
\end{verbatim}

Assuming \(\mu=13\) then our \textbf{observed error} in estimating the mean is the difference

\[\bar{x}_{stock}-\mu=13.21-13=0.21\]

This is within the margin of error of \(95.6\%\) and therefore, we must consider that the manufacturing process is working as expected.

\includegraphics{_main_files/figure-latex/unnamed-chunk-77-1.pdf}

\hypertarget{sample-sum}{%
\subsection{Sample sum}\label{sample-sum}}

If we are interested in using all \(8\) cables at the same time to carry a total of \(96\) Tons, then we should consider \textbf{adding} their individual contributions.

The \textbf{sample sum} is the \textbf{statistic}

\[Y=n \bar{X}=\sum_{i=1}^n X_i\]

A \textbf{statistic} is any function from the random sample \((X_1, ... X_n)\).

\textbf{Theorem:} if \(X\) follows a normal distribution
\[X \rightarrow N(\mu, \sigma^2)\]

so \(Y\) is normal

\[Y \rightarrow N(n\mu, n\sigma^2)\]

\(Y\) has

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  mean \[E(Y)=n\mu\]
\item
  variance \[V(Y)=n\sigma^2\]
\end{enumerate}

\textbf{Example (sum of cables)}

What is the probability that when we put all the cables together, they can carry a total weight between \(102=8(13 - 0.25)\) and \(106=8(13+ 0.25)\) Tons?

\textbf{We know} that for our Cables \[X \rightarrow N(\mu=13, \sigma^2=0.35^2)\] then

\[Y \rightarrow N(n\mu=104, n\sigma^2=8\times 0.35^2)\]

with mean and variance

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  \(E(Y)=n\mu=104\)
\item
  \(V(Y)=n\sigma^2=8\times 0.35^2=0.98\); \(\sqrt{V(Y)}=0.9899495\)
\end{enumerate}

We want to calculate \[P(102 \leq Y \leq 106)\]

\(=F(102; n\mu, n\sigma^2)-F(106; n\mu, n\sigma^2)\)

In Python we can calculate it as:

norm.cdf(106, 104, 0.9899495)-norm.cdf(102, 104, 0.9899495)=0.956.

Therefore \(95.6\%\) of the total weight that \(8\) cables can carry is between \(102\) and \(106\) Tons, or a distance of \(8*0.25=2\) Tons from the total mean \(n\mu=104\).

\hypertarget{sample-variance-1}{%
\section{Sample variance}\label{sample-variance-1}}

By estimating the variance

\[s^2=\hat{\sigma}\]

We also make a mistake. How can we estimate the error we make?

\textbf{Definition}

The \textbf{sample variance} \(S^2\) of a random sample of size \(n\)

\[S^2= \frac{1}{n-1}\sum_{i=1}^n(X_i-\bar{X})^2\]

is the dispersion of the measurements around \(\bar{X}\). In our sample of size \(8\), \(S^2\) took the value

\[s_{stock}^2=\frac{1}{n-1}\sum_{i=1}^n(x_i-\bar{x})^2=0.1275608\]

\(S^2\) is

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  unbiased: \(E(S^2)=V(X)=\sigma^2\)
\item
  consistent: \(n \rightarrow \infty\), \(V(\bar{S^2}) \rightarrow 0\)
\end{enumerate}

and therefore \(S^2\) consistently estimates \(\sigma^2\)

We can take a value of \(s^2\) as an estimate for \(\sigma^2\) or

\[s^2=\hat{\sigma}^2\]
Similar to \(\hat{\mu}\), the error of this estimate gets smaller and smaller as \(n\) gets bigger and bigger.

\textbf{The unbiased sample variance (why do we divide by n-1?)}

We could propose to estimate \(\sigma^2\) by dividing the squared differences of \(\bar{X}\) by \(n\)

\[S_n^2=\frac{1}{n}\sum_{i=1}^n(X_i-\bar{X})^2\]

\(S_n^2\) is therefore

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  \textbf{biased}: \(E(S_n^2) = \sigma^2-\frac{\sigma^2}{n} \neq \sigma^2\)
\item
  but consistent \(V(S_n^2) \rightarrow 0\) when \(n\rightarrow \infty\)
\end{enumerate}

The bias term \(\frac{\sigma^2}{n}\) arises because \(S_n^2\) measures the spread around \(\bar{X}\) and not around \(\mu\). Remember that the error we make when we substitute \(\bar{x}\) for \(\mu\) is the variance of \(\bar{X}\): \(\sigma^2/n\). Let us correct for bias, writing equation 1 above as:

\[E(\frac{n}{n-1}S_n^2)=\sigma^2\]

We can define the \textbf{sample variance} (corrected) \[S^2=\frac{n}{n-1}S_n^2=\frac{1}{n-1}\sum_{i=1}^ n(X_i-\bar{X})^2\]

which is an unbiased estimator of \(\sigma^2\) because \(E(S^2)=\sigma^2\).

We can also have inference problems when we are interested in the probability of the \textbf{sample variance} \(S^2\).

Consider a quality control process that requires the leads to be produced close to the specified value \(\mu\). We don't want cables that break too far from the mean.

If a sample of size \(8\) cables is very scattered (\(S^2>0.3\)), we stop production: the process is out of control.

What is the probability that the sample variance of a sample of size \(8\) Cables will be greater than the required \(0.3\)?

\hypertarget{probabilities-of-the-sample-variance}{%
\section{Probabilities of the sample variance}\label{probabilities-of-the-sample-variance}}

\textbf{Theorem:} If \(X\) follows a normal distribution
\[X \rightarrow N(\mu, \sigma^2)\]

The \textbf{statistic}:

\[W=\frac{(n-1)S^2}{\sigma^2} \rightarrow \chi^2(n-1)\]

has a distribution \(\chi^2\) (chi-square) with \(df=n-1\) degrees of freedom given by

\[f(w)=C_n w^{\frac{n-3}{2}} e^{-\frac{w}{2}}\]

where:

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  \(C_n=\frac{1}{2^{(n-1)/2\sqrt{\pi(n-1)}}}\) ensures \$\int\_\{-\infty\}\^{}\{\infty\} f (t)dt=\$1
\item
  \(\Gamma(x)\) is the Euler factorial for real numbers
\end{enumerate}

If we \textbf{know} the value of \(\sigma\), we can calculate the probabilities of \(S^2\) using the \(\chi^2\) distribution for \(W\).

\hypertarget{chi2-statistic}{%
\section{\texorpdfstring{\(\chi^2\)-statistic}{\textbackslash chi\^{}2-statistic}}\label{chi2-statistic}}

The probability density \(\chi^2\) has a parameter \(df=n-1\), called degrees of freedom. Let's look at some probability densities in the family of probability models \(\chi^2\)

\includegraphics{_main_files/figure-latex/unnamed-chunk-78-1.pdf}

\textbf{Example (variations in cable break)}

If we \textbf{know} that our cables
\[X \rightarrow N(\mu=13, \sigma^2=0.35^2)\]

so

\[W=\frac{(n-1)S^2}{\sigma^2}= \frac{7S^2}{0.35^2} \rightarrow \chi^2(n-1)\]

we can calculate \[P(S^2 > 0.3)=P(\frac{(n-1)S^2}{\sigma^2} > \frac{(n-1)0.3}{\sigma^2 } )\]
\(=P(W > \frac{7*0.3}{0.35^2})=P(W > 17.14286)\)

\(=1-P(W \leq 17.14286)\)

\(= 1- F_{\chi^2,df=7}(17.14286)=0.016\)

in Python
1-chi2.cdf(17.14286, df=7)=0.016

There is only a \(1\%\) chance of getting a value greater than \(s^2=0.3\). So \(s^2>0.3\) seems to be a good criteria to stop production and review the process.

If we take a random sample and get a value of \(s ^2\) that is greater than \(0.3\), it will be a rare observation if all is well. We tend to believe that the observed values are common, not rare, so we may think that something is not right.

When we perform random sampling we observe:

\begin{verbatim}
## [1] 13.34642 13.32620 13.01459 13.10811 12.96999 13.55309 13.75557 12.62747
\end{verbatim}

Therefore, our observed value was \(s^2_{stock}=0.1275608\)

The sample is not very sparse because \(s^2_{stock} < 0.3\) and we believe that all is well and production is under control.

\hypertarget{questions-7}{%
\section{Questions}\label{questions-7}}

\textbf{1)} The sample mean is an unbiased estimator of the population mean because

\textbf{\(\qquad\)a:} The expected value of the sample mean is the population mean;
\textbf{\(\qquad\)b:} The expected value of the population mean is the sample mean;
\textbf{\(\qquad\)c:} The standard error approaches zero as \(n\) approaches infinity;
\textbf{\(\qquad\)d:} The variance of the sample mean approaches zero as \(n\) approaches infinity;

\textbf{2)} Why is the statistic \(S^2=\frac{1}{n-1}\sum_{i=1}^{n}(X_i -\bar{X})^2\) used? instead of \(S_n^2=\frac{1}{n}\sum_{i=1}^{n}(X_i -\bar{X})^2\) to estimate the variance of a random variable?

\textbf{\(\qquad\)a:} because its variance is \(0\);
\textbf{\(\qquad\)b:} because it is a consistent estimator of \(\sigma^2\);
\textbf{\(\qquad\)c:} because it is an unbiased estimator of \(\sigma^2\);
\textbf{\(\qquad\)d:} because it is the mean square distance to the sample mean (\(\bar{X}\));

\textbf{3)} What is the variance of the sample mean \(\bar{X}=\frac{1}{n}\sum_{i=1}^n X_i\)?

\textbf{\(\qquad\)a:}\(\sigma\);
\textbf{\(\qquad\)b:}\(\frac{\sigma}{\sqrt{n}}\);
\textbf{\(\qquad\)c:}\(\sigma^2\);
\textbf{\(\qquad\)d:}\(\frac{\sigma^2}{n}\);

\textbf{4)} What is the mean and variance of the sample sum?

\textbf{\(\qquad\)a:}\(\mu\), \(n\sigma\);
\textbf{\(\qquad\)b:}\(n\mu\),\(n\sigma\);
\textbf{\(\qquad\)c:}\(\mu\), \(n\sigma^2\);
\textbf{\(\qquad\)d:}\(n\mu\), \(n\sigma^2\);

\textbf{5)} An inference question implies:

\textbf{\(\qquad\)a:} calculate the expected value of an estimator;
\textbf{\(\qquad\)b:} estimate the value of a parameter;
\textbf{\(\qquad\)c:} calculate a probability of an estimator;
\textbf{\(\qquad\)d:} fit a probability model;

\hypertarget{exercises-8}{%
\section{Exercises}\label{exercises-8}}

\hypertarget{exercise-1-7}{%
\subsubsection{Exercise 1}\label{exercise-1-7}}

An electronics company manufactures resistors that have an average resistance of 100 ohms and
a standard deviation of 10 ohms. The resistance distribution is normal.

\begin{itemize}
\item
  What is the sample mean of \(n=25\) resistors? (R:100)
\item
  What is the variance of the sample mean of \(n=25\) resistors? (R:4)
\item
  What is the standard error of the sample mean of \(n=25\) resistors? (R:2)
\item
  Find the probability
  that a random sample of \(n = 25\) resistors have an average resistance of less than \(95\) ohms (R: 0.0062)
\end{itemize}

\hypertarget{exercise-2-7}{%
\subsubsection{Exercise 2}\label{exercise-2-7}}

A battery model charges an average of \(75\%\) of its capacity in one hour with a standard deviation of \(15\%\).

\begin{itemize}
\item
  If the battery charge is a normal variable, what is the probability that the charge difference between the sample mean of \(25\) batteries and the mean charge is at most \(5\%\)? (R:0.9044)
\item
  If we charge \(100\) batteries, what is that probability? (R:0.9991)
\item
  If instead we only charge \(9\) batteries, what charge \(c\) is exceeded by the sample mean with probability \(0.015\)? (A:85.850)
\end{itemize}

\hypertarget{central-limit-theorem}{%
\chapter{Central limit theorem}\label{central-limit-theorem}}

\hypertarget{objective-6}{%
\section{Objective}\label{objective-6}}

In this chapter we will introduce the \textbf{margin of errors} when estimating the mean of the population distribution by the average.

We will discuss how the \textbf{central limit theorem} will allow us to compute the margin of error for any type of distribution if the sample is large.

The will also introduce the t-statistic, for computing the margin of error when the sample is small but the population distribution is normal.

\hypertarget{margin-of-error}{%
\section{Margin of error}\label{margin-of-error}}

When deciding whether the error of estimation of \(\mu\) by the sample mean \(\bar{x}\) is large or not we usually compare it with a \textbf{predefined} tolerance.

The \textbf{margin of error} at \(5\%\) level is the distance \(m\) of \(\bar{X}\) from \(\mu\) that captures \(95\%\) of the estimations:

\[P(-m \leq \bar{X}-\mu \leq m)=P(\mu-m \leq \bar{X} \leq\mu + m)=0.95\]

This means that \(95\%\) of the possible results of \(\bar{X}\) are a distance \(m\) from \(\mu\)

\hypertarget{example-cables}{%
\section{Example (Cables)}\label{example-cables}}

If we take a sample of \(8\) cables from a population of cables whose breaking load follows a normal distribution with \textbf{known} parameters \(\mu=13\) and \(\sigma^2=0.35^2\),

\[X \rightarrow N(\mu=13, \sigma^2=0.35^2)\]

What is the margin of error, when we estimate \(\mu\) by \(\bar{x}\)?

\textbf{Calculating the maging of error of a normal variable}

We want to know the number \(m\) in the equation

\[P(\mu-m \leq \bar{X} \leq\mu + m)=0.95\]

To solve this equation we need two steps. \textbf{First}, we need to know the \textbf{distribution} of \(\bar{X}\).

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  When \(X\) is normal (\(X \rightarrow N(\mu, \sigma^2)\)) then
\end{enumerate}

\[\bar{X} \rightarrow N(\mu, \frac{\sigma^2}{n})\]
We \textbf{then} need \textbf{standardize} \(\bar{X}\). Remember that to standardize a normal variable we subtract its mean an divide it by its standard deviation.

\[Z=\frac{\bar{X}-E(\bar{X})}{\sqrt{V(\bar{X})}} =\frac{\bar{X}-\mu}{\frac{\sigma}{\sqrt{n}}}  \rightarrow N(0,1)\]
\includegraphics{./figures/phi.JPG}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Substituting the mean of \(\bar{X}\) and its standard deviation into the equation for the margin of error, we have:
\end{enumerate}

\(P(\mu-m \leq \bar{X} \leq\mu + m)=P(-\frac{m}{\sigma/\sqrt{n}} \leq \frac{\bar{X}-\mu}{\frac{\sigma}{\sqrt{n}}}\leq\frac{m}{\sigma/\sqrt{n}})\)
\[=P(-\frac{m}{\sigma/\sqrt{n}} \leq Z \leq\frac{m}{\sigma/\sqrt{n}})=0.95\]

Compare it with the plot above: \(\frac{m}{\sigma/\sqrt{n}}\) is the distance about \(0\) that captures \(95\%\) of the distribution standard normal variable. The distance leaves \(2.5\%\) probability at each tail of the distribution. For the upper tail, this is

\[\frac{m}{\sigma/\sqrt{n}}=\phi^{-1}(0.975)=1.96\]

where \(\phi^{-1}\) is the inverse of the standard normal distribution (norm.ppf(0.975)). Therefore

\[m=1.96 \frac{\sigma}{\sqrt{n}}\]
\textbf{Example (cables)}

The sample mean \(\bar{X}\) of a sample of \(8\) cables follows a normal distribution with:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  mean \(E(\bar{X})=\mu\)
\end{enumerate}

and

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  standard error \(se=\sqrt{V(\bar{X})}=\frac{\sigma}{\sqrt{n}}=\frac{0.35}{\sqrt{8}}\)
\end{enumerate}

Then the margin of error at \(5\%\) is:

\[m=1.96\frac{0.35}{\sqrt{8}}=0.24\]

We can expect that \(95\%\) of the averages (\(\bar{x}\)) for the breaking load of \(8\) cables fall between \((13-0.24, 13+0.24)=(12.76, 13.24)\)

\hypertarget{central-limit-theorem-1}{%
\section{Central Limit Theorem}\label{central-limit-theorem-1}}

We could solve the margin of error because we assumed that that variable \(X\) was normal. What if \(X\) follows any other probability distribution?

\textbf{Theorem:} For any random variable \(X\) with any type of distribution

\[X \rightarrow f(x; \theta)\]
the standardized statistic

\[Z=\frac{\bar{X}-E(\bar{X})}{\sqrt{V(\bar{X})}}\]

approximates to a standard distribution

\[Z \rightarrow_d N(0,1)\] when \(n\rightarrow \infty\)

\textbf{Consequence:} We can compute probabilities for \(\bar{X}\) if \(n\) is large, using the normal distribution:

\[\bar{X} \sim_{aprox}  N(E(X), \frac{V(X)}{n})\]

\textbf{Example (drug in blood concentration):}

Consider an experiment where we want to measure the concentration in blood of a drug after 10-hour administration in \(30\) patients.

If we \textbf{know} that levels follow an exponential distribution \[X \rightarrow exp(\lambda=2)\]

\includegraphics{_main_files/figure-latex/unnamed-chunk-80-1.pdf}

The mean and variance are:

\begin{itemize}
\tightlist
\item
  \(E(X)=\frac{1}{\lambda}=0.5\)
\item
  \(V(X)=\frac{1}{\lambda^2}=0.25\)
\end{itemize}

Therefore the mean and the estandard error of \(\bar{X}\) are:

\begin{itemize}
\tightlist
\item
  \(E(\bar{X})=\frac{1}{\lambda}=0.5\)
\item
  \(se=\sqrt{\frac{V(X)}{n}}=\sqrt{\frac{1}{n\lambda^2}}=0.091\)
\end{itemize}

As \(n \geq 30\)

\[Z=\frac{\bar{X}-\lambda}{\sqrt{\frac{1}{n\lambda^2}}}\]

is a standard normal variable and: \(\bar{X} \sim_{aprox} N(\lambda, \frac{1}{n\lambda^2})\)

The margin of error at \(5\%\) level can be computed again with the standard distribution

\[m=\phi^{-1}(0.975) \sqrt{\frac{V(X)}{n}}=1.96\sqrt{\frac{0.25}{30}}=0.1789227\]

We can expect \(95\%\) of the averages of \(30\) patient samples to fall between
\((0.5-0.178, 0.5+0.178)= (0.322, 0.678)\)

\includegraphics{_main_files/figure-latex/unnamed-chunk-81-1.pdf}

\hypertarget{sample-sum-and-clt}{%
\section{Sample sum and CLT}\label{sample-sum-and-clt}}

The \textbf{sample sum} is the \textbf{statistic}

\[Y=X_1+X_2+...X_n=\sum_{i=1}^n X_i=n \bar{X}\]

with

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  mean \[E(Y)=n\mu\]
\item
  variance \[V(Y)=nV(X)=n^2V(\bar{X})\]
\end{enumerate}

The CLT tells us that for any random variable \(X\) with \textbf{unknown} (any type of) distribution

\[X \rightarrow f(x; \theta)\]

the standardized statistic

\[Z=\frac{\bar{X}-E(\bar{X})}{\sqrt{V(\bar{X})}}\]

approximates to a standard distribution

\[Z \rightarrow_d N(0,1)\] when \(n\rightarrow \infty\). \(Z\) can also be written as

\[Z=\frac{n\bar{X}-nE(\bar{X})}{\sqrt{n^2V(\bar{X})}}=\frac{Y-E(Y)}{\sqrt{V(Y)}}\]

\textbf{Consequence:} We can compute probabilities for the sample sum \(Y=n\bar{X}\) if \(n\) is large, using the normal distribution:

\[Y \sim_{aprox}  N(nE(X), nV(X))\]

\textbf{Example (Bernoulli trial)}

For the Bernoulli trial \(X \rightarrow Bernoulli(p)\), the average of a \(n\) sample of Bernoulli trials is \(\bar{X}=\sum_i^n X_i\). Therefore

\[Z=\frac{\bar{X}-p}{\sqrt{\frac{p(1-p)}{n}}}\]
is standard normal, because \(E(\bar{X})=p\) and \(V(\bar{X})=\frac{p(1-p)}{n}\).

Now, the sample sum \(Y=n\bar{X}\) is a random variable that counts the number of events with probability \(p\) in a repetition of \(n\) trials, therefore
\[Y \rightarrow Binom(n, p)\]
With mean \(E(Y)=np\) and variance \(V(Y)=np(1-p)\). Since we can write
\[Z=\frac{Y-np}{\sqrt{np(1-p)}}\]
then using the CLT, we can proximate the Binomial probability mass function with the normal probability density when \(n\) is big

\[Y \rightarrow  Binom(n, p) \sim_{aprox}  N(np, np(1-p))\]

This approximation is good when both \(np\) and \(n(1-p)\) are greater than \(5\).

\hypertarget{questions-8}{%
\section{Questions}\label{questions-8}}

\textbf{1)} A magnetic resonance imaging of the brain's hippocampus has \(100\) pixels. We expect \(90\%\) of the pixels to be white (brain tissue). According to the central limit theorem, what is the probability that the scanning of a patient has at most \(85\%\) of white pixels?

\textbf{\(\qquad\)a:}norm.cdf(0.9, 0.85, sqrt(0.85*0.15)/10); \textbf{\(\qquad\)b:}norm.pdf(0.85, 0.9,
sqrt(0.9*0.1)/10); \textbf{\(\qquad\)c:}norm.cdf(0.85, 0.9, sqrt(0.9*0.1)/10); \textbf{\(\qquad\)d:}norm.pdf(0.9, 0.85, sqrt(0.85*0.15)/10)

\textbf{2)} For a standard normal variable, if we the number \(z_{0.025}\) in the definition of the margin of error \(m=z_{0.025} \frac{\sigma}{\sqrt{n}}\), then it will refer to

\textbf{\(\qquad\)a:} The first quartile; \textbf{\(\qquad\)b:} The number at which the distribution has accumulated \(0.975\) of probability; \textbf{\(\qquad\)c:} The number at which the distribution has accumulated \(0.025\) probability; \textbf{\(\qquad\)d:} The third quartile;

\textbf{3)} The importance of the central limit theorem is that is applyes to the standardization of

\textbf{\(\qquad\)a:} A random variable;
\textbf{\(\qquad\)b:} The sample mean of a normal variable;
\textbf{\(\qquad\)c:} The sample mean of a random variable;
\textbf{\(\qquad\)d:} A normal variable;

\hypertarget{exercises-9}{%
\section{Exercises}\label{exercises-9}}

\hypertarget{exercise-1-8}{%
\subsubsection{Exercise 1}\label{exercise-1-8}}

An electronic component is needed for the correct functioning of a telescope. It needs to be replaced immediately when it wears out.

The mean life of the component (\(\mu\)) is \(100\) hours and its standard deviation \(\sigma\) is \(30\) hours.

\begin{itemize}
\item
  what is the probability that the average of the mean life of \(50\) components is within \(1\) hour from the mean life of a single component? (R:0.1863)
\item
  How many components do we need such that the telescope is operational \(2750\) consecutive hours with at least \(0.95\) probability? (R:31)
\end{itemize}

\hypertarget{exercise-2-8}{%
\subsubsection{Exercise 2}\label{exercise-2-8}}

The probability that a particular mutation is found in the population is \(0.4\). If we test \(2000\) people for the mutation:

\begin{itemize}
\tightlist
\item
  What is the probability that the total number of people with the mutation is between \(791\) and \(809\)? (R:0.31)
\end{itemize}

hint: Use the CLT with a sample of \(2000\) Bernoulli trials. This is known as the normal approximation of the binomial distribution.

\hypertarget{exercise-3-5}{%
\subsubsection{Exercise 3}\label{exercise-3-5}}

An automated machine fills test tubes with biological samples with mean \(\mu=130\)mg and a standard deviation of \(\sigma=5\)mg.

\begin{itemize}
\item
  for a random sample of size \(50\). What is the probability that
  the sample mean (average) is between \(128\) and \(132\)gr? (R:0.995)
\item
  what should be the size of the sample (\(n\)) such that the sample mean \(\bar{X}\) is higher than \(131\)gr with a probability less or equal than \(0.025\)?(R:97)
\end{itemize}

\hypertarget{exercise-4-3}{%
\subsubsection{Exercise 4}\label{exercise-4-3}}

In the Caribbean, there appears to be an average of \(6\) hurricanes per year. Considering that hurricane formation is a Poisson process, meteorologists plan to estimate the mean time between the formation of two hurricanes. They plan to collect a sample of size \(36\) for the times between two hurricanes.

\begin{itemize}
\item
  What is the probability that their sample average is between \(45\) and \(60\) days? (R:0.39)
\item
  Which should be the sample size such that they have a probability of \(0.025\) that the sample mean is greater than \(70\) days? (R:169)
\end{itemize}

\hypertarget{maximum-likelihood}{%
\chapter{Maximum likelihood}\label{maximum-likelihood}}

\hypertarget{objective-7}{%
\section{Objective}\label{objective-7}}

In this chapter we will discuss what an \textbf{estimator} is and give some examples. Then we will introduce a method for obtaining \textbf{estimators} of the parameters of probability models. This is the \textbf{maximum likelihood} method.

\hypertarget{statistic}{%
\section{Statistic}\label{statistic}}

\textbf{Definition}

A \textbf{statistic} is any function of a \textbf{random sample}
\[T(X_1,X_2, ..., X_n)\]

It usually returns a number.

Statistics are \textbf{random variables} and their \textbf{probability distributions} are called \textbf{sampling distributions}

Statistics have different functions:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{Description} of a sample's data
\end{enumerate}

\begin{itemize}
\tightlist
\item
  location: \(\bar{X}\)
\item
  Minimum: \(\min\{X_i\}\)
\item
  Maximum: \(\max\{X_i\}\)
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  \textbf{Estimation} of a probability model's \textbf{parameters}
\end{enumerate}

\begin{itemize}
\tightlist
\item
  mean: \(\bar{X}\) for \(\mu\)
\item
  variance: \(S^2\) for \(\sigma^2\)
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  \textbf{Inference} to say something about the parameters given the data
\end{enumerate}

\begin{itemize}
\tightlist
\item
  mean: \(Z\), \(T\)
\item
  variance: \(\chi^2\)
\end{itemize}

Remember: They are all random variables. Every time we take another sample they change their value.

\textbf{Definition of estimators}

An \textbf{estimator} is a statistic whose observed values are used to estimate the \textbf{parameters} of the population distribution on which the sample is defined.

If we write the population distribution as

\[X \rightarrow f(x; \theta)\]

then \(\theta\) is a parameter and \(\Theta\) is a random variable whose observations \(\hat{\theta}\) we take as estimations of \(\theta\)

\[\hat{\theta} \sim \theta\]

Therefore there are three different quantities that we must consider:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \(\theta\) is a \textbf{parameter} of the population distribution \(f(x; \theta)\)
\item
  \(\Theta\) is an \textbf{estimator} of \(\theta\): A random variable
\item
  \(\hat{\theta}\) is the \textbf{estimate} of \(\theta\): A realized value of \(\Theta\)
\end{enumerate}

\includegraphics{./figures/estimator.JPG}

\textbf{Example (Sample mean)}

When we have a normal random variable

\[X \rightarrow N(\mu, \sigma^2)\]

we identify the three different quantities:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \(\mu\) is a \textbf{parameter} of the \textbf{population} distribution: distribution of \(X\), \(N(\mu, \sigma^2)\)
\item
  \(\bar{X}\) is an \textbf{estimator} of \(\mu\)
\item
  \(\bar{x}=\hat{\mu}\) is the \textbf{estimate} of \(\mu\)
\end{enumerate}

\textbf{Example (Sample variance)}

When we have a normal random variable

\[X \rightarrow N(\mu, \sigma^2)\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \(\sigma^2\) is a \textbf{parameter} of the population distribution
\item
  \(S^2\) is an \textbf{estimator} of \(\sigma^2\)
\item
  \(s^2=\hat{\sigma^2}\) is the \textbf{estimate} of \(\sigma^2\)
\end{enumerate}

\hypertarget{properties}{%
\section{Properties}\label{properties}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  An estimator is \textbf{unbiased} if it expected value is the parameter
\end{enumerate}

\[E(\Theta)=\theta\]

For example:

\begin{itemize}
\item
  \(\bar{X}\) is an \textbf{unbiased} estimator of \(\mu\) because \(E(\bar{X})=\mu\)
\item
  \(S^2\) is an \textbf{unbiased} estimator of \(\sigma^2\) because \(E(S^2)=\sigma^2\)
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  An estimator is \textbf{consistent} when its observed values get closer and closer as the sample size is icreased
\end{enumerate}

\[lim_{n\rightarrow \infty} V(\Theta) = 0\]

For example:

\begin{itemize}
\tightlist
\item
  \(\bar{X}\) is \textbf{consistent} because \(V(\bar{X})=\frac{\sigma^2}{n}\rightarrow 0\) when \(n \rightarrow \infty\).
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  The mean squared error \(mse\) of \(\Theta\) is its expected squared difference from the parameter
\end{enumerate}

\[mse(\Theta)=E([\Theta - \theta]^2)\]

or equivalently is the sum of the errors

\[mse(\Theta)=se^2 + bias^2\]

where \(se=\sqrt{V(\bar{X})}\) is the standard error.

\hypertarget{maximum-likelihood-1}{%
\section{Maximum likelihood}\label{maximum-likelihood-1}}

How can obtain \textbf{estimators} of the parameters of \textbf{any} probability model?

\textbf{Example (Laser)}

Imagine we design a laser with a diameter of \(1mm\) that we want to use for clinical applications.

We want to characterize the diameter of a piercing in a tissue made with the laser and take a random sample of \(30\) cuts made with the laser. Here are the results

\begin{verbatim}
##  [1] 1.11 1.64 1.20 1.79 1.89 1.01 1.31 1.81 1.34 1.25 1.92 1.24 1.49 1.36 1.03
## [16] 1.82 1.09 1.01 1.14 1.91 1.80 1.51 1.44 1.98 1.46 1.53 1.33 1.39 1.12 1.04
\end{verbatim}

and the histogram

\includegraphics{_main_files/figure-latex/unnamed-chunk-83-1.pdf}

What is a probability function that can describe the data?

For this we follow the following process:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  we propose \textbf{a model} that depends on parameters
\item
  we derive the \textbf{estimators} for the parameters, by maximum likelihood or the method of moments.
\item
  finally we use the estimator to \textbf{estimate the parameters} with the data.
\end{enumerate}

\emph{Proposing a probability density}

In many applications, we can propose the form of a probability density that depends on some parameters. Proposing a probability model is done by following \textbf{general properties} of the observations, or what we expect to observe. Modelling requires experience, skill and knowledge of several mathematical functions. However, in most cases \textbf{well known models} are typically applied.

\textbf{Example (Laser)}

In our example, we may consider for example that maximum probability should be given to diameters of \(x=1mm\), and that the diameters should decrease as the inverse power of some \textbf{unknown} parameter \(\alpha\), with a limit of \(2mm\) beyond which the probability is \(0\).

A suitable probability density distribution is

\[
    f(x)= 
\begin{cases}
\frac{1}{\alpha}(x-1)^{\frac{1}{\alpha}-1},& \text{if } x \in (1,2)\\
    0,& x \notin (1,2)\\
\end{cases}
\]

Where \(\alpha\) is a parameter. This is a probability density because it integrates to one and it is positive. In particular, for \(\alpha=2\) we can plot it

\includegraphics{_main_files/figure-latex/unnamed-chunk-84-1.pdf}

\emph{Deriving the estimators}

If we perform a \(n\)-sample: \(X_1,...X_n\), how should we combine the data for obtaining the best value of \(\alpha\)?

Many values of the parameters could explain the data. We are interested in \textbf{one criterion} to choose one particular value.

\includegraphics{_main_files/figure-latex/unnamed-chunk-85-1.pdf}

The \textbf{maximum likelihood} method that gives us the estimator for \(\alpha\)

\[\hat{\alpha}_{ml}\]

\hypertarget{maximum-likelihood-2}{%
\section{Maximum likelihood}\label{maximum-likelihood-2}}

The objective is to find the value of the parameter that we \textbf{believe} can \textbf{best} represent the data.

The method of maximum likelihood is based on the search for the parameter value that makes the \textbf{observation} of the sample the most \textbf{probable}.

\textbf{Maximum likelihood step 1}

We calculate the probability of having observed the \(n\)-sample: \(x_1,...x_n\). It is the product of probabilities because observations are independent of one another:

\(P(M=x_1,...x_n)=P(X=x_1)P(X=x_2)...P(X=x_n)\)
\[=f(x_1;\alpha)f(x_2;\alpha) ...f(x_n;\alpha)\]

We call this function the \textbf{likelihood function} and we consider that:

\begin{itemize}
\tightlist
\item
  Once the data are observed, they are \textbf{fixed}
\item
  The unknown is \(\alpha\)
\end{itemize}

\[L(\alpha)= \Pi_{i=1..n} f(x_i; \alpha)\]

\textbf{Example (Laser)}

For the laser experiment the likelihood is

\(L(\alpha;x_1,..x_n)= \frac{1}{\alpha^n} \Pi_{i=1..n} (x_i-1)^{\frac{1-\alpha}{\alpha}}= \frac{1}{\alpha^n} \{(x_1-1)(x_2-1)...(x_n-1)\}^{\frac{1-\alpha}{\alpha}}\)

\textbf{Maximum likelihood step 2}

We then ask: what is the value of \(\alpha\) that makes the observed sample the most probable event? We thus want to maximize \(L(\alpha)\) with respect to \(\alpha\). Since we have the multiplication of many factors is easier to maximize the logarithm of \(L(\alpha)\). This is called the the log-likelihood function:

\[\ln L(\alpha;x_1,..x_n)\]

\textbf{Example (Laser)}

In the laser example, we therefore take the logarithm and obtain the \textbf{Log-likelihood}

\[\ln L(\alpha;x_1,..x_n)= -n \ln(\alpha) + {\frac{1-\alpha}{\alpha}} \Sigma_{i=1...n} \ln (x_i-1)\]

\textbf{Maximum likelihood step 3}

Finally we \textbf{maximize} the log-likelihood with respect to the parameter. Therefore, we differentiate the log-likelihood with respect to the parameter \(\alpha\), equate to zero and solve for the maximum.

\[\frac{d \ln L(\alpha)}{d \alpha} \big|_{\hat{\alpha}}=0 \]
The value of the parameter at the maximum is called the \textbf{maximum likelihood estimate} for the parameter and its written with a hat \(\hat{\alpha}\).

\textbf{Example (Laser)}

We derive the log-likelihood

\[\frac{d \ln L(\alpha)}{d \alpha}= -\frac{n}{\alpha} - \frac{1}{\alpha^2}  \Sigma_{i=1...n} \ln (x_i)\]
The maximum is where the derivative is \(0\). This maximum is the value of our estimator \(\hat{\alpha}_{ml}\).

\[\hat{\alpha}_{ml}=-\frac{1}{n}\sum_{i=1}^n \ln (x_i-1)\]

The estimator of the parameter is therefore (note the capital letters)

\[A=-\frac{1}{n}\sum_{i=1}^n \ln (X_i-1)\]

Which is a random variable, function of the random sample

\[(X_1, X_2, ... X_n)\]

\emph{Estimating the parameters with the data}

In our example, we then have the observation of the random sample as a set of 30 numbers \((x_1, x_2, ...x_{30})\), we therefore substitute the numbers in the estimator and this will give us its observed value.

\(\hat{\alpha}_{ml}=-\frac{1}{n}\{ \ln (1.11-1)+ \ln (1.64-1)+...\ln (1.04-1)\}=1.320\)

Therefore the maximum likelihood estimate of the parameter is \(1.320\). If we substitute this value in the probability function, and overlay it with the histogram, we can see that it gives us a suitable description of the data.

\includegraphics{_main_files/figure-latex/unnamed-chunk-86-1.pdf}

Let's look at the log-likelihood function for our \(30\) laser cuts. Remember, data is fixed by our experiment and \(\alpha\) varies. The function has a maximum. However, if we take another sample this function changes and so does its maximum.

\includegraphics{_main_files/figure-latex/unnamed-chunk-87-1.pdf}

\textbf{Maximum likelihood: History}

To infer the true position of Ceres at a given time, Gauss derived the error function

\[f(x; \mu, \sigma^2)= \frac{1}{\sigma \sqrt{2 \pi}} e^{-\frac{1}{2\sigma^2} (x-\mu)^2}\]

Where the \textbf{true} position of Ceres was the mean \(\mu\). How can we combine the data for having the best estimate for the position of Ceres?

What is the statistic that can describe best its position?

\includegraphics{./figures/cerestime.JPG}

This question can be formulated as: What is the maximum likelihood estimate of \(\mu\) for a random normal variable?

\textbf{Maximum likelihood of the normal distribution}

For a random normal variable

\[X \rightarrow N(\mu, \sigma^2)\].

What are the estimators of \(\mu\) and \(\sigma^2\) that maximize the probability of the observed data?

\includegraphics{./figures/normpar.JPG}

We follow the maximum likelihhod method:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  The likelihood function, or the probability of having observed the sample \((x_1, ....x_n)\) is
\end{enumerate}

\(L(\mu, \sigma^2)=\Pi_{i=1..n} f(x_i;\mu,\sigma)\)

\[=\big( \frac{1}{\sigma \sqrt{2 \pi}}\big)^n e^{-\frac{1}{2\sigma^2} \sum_i(x_i-\mu)^2}\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  We take the log of \(L\), and compute the \textbf{log-likelihood}
\end{enumerate}

\[\ln L(\mu, \sigma^2)=-n \ln(\sigma \sqrt{2 \pi})-\frac{1}{2\sigma^2} \Sigma_i(x_i-\mu)^2\]

The estimates of \(\mu\) and \(\sigma^2\) are where the likelihood is maximum. They give the highest probability for the data.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  We differentiate with respect to \(\mu\) and \(\sigma^2\). These two derivatives give us two equations, one for each of the parameters. For deriving respect to \(\sigma^2\), it is easier to make a substitution \(t=\sigma^2\).
\end{enumerate}

\begin{enumerate}
\def\labelenumi{\alph{enumi})}
\item
  \(\frac{d \ln L(\mu, \sigma^2)}{d\mu}=\frac{1}{\sigma^2} \sum_i(x_i-\mu)\)
\item
  \(\frac{d \ln L(\mu, \sigma^2)}{d\sigma^2}=-\frac{n}{2 \sigma^2}+\frac{1}{2\sigma^4} \sum_i(x_i-\mu)^2\)
\end{enumerate}

The derivatives are \(0\) at the maxima

\begin{enumerate}
\def\labelenumi{\alph{enumi})}
\tightlist
\item
  \(\frac{1}{\hat{\sigma}^2} \sum_i(x_i-\hat{\mu})=0\)
\item
  \(-\frac{n}{2 \hat{\sigma}^2}+\frac{1}{2\hat{\sigma}^4} \sum_i(x_i-\hat{\mu})^2=0\)
\end{enumerate}

solving both equations for the parameters we find for \(\mu\)

\[\hat{\mu}_{ml}=\frac{1}{n}\sum_i x_i=\bar{x}\]

and for \(\sigma^2\)

\[\hat{\sigma}^2_{ml}=\frac{1}{n}\sum_i(x_i-\bar{x})^2\]

Therefore the average \(\bar{X}\) is the maximum likelihood estimator of the mean \(\mu\). Gauss showed that the statistics that we should trust most (that with highest likelihood) for the real position of the Ceres was the \textbf{average}. Gauss solving the position of Ceres, not only discover the normal distribution, but also created the regression analysis and showed the importance of the average. It is due to him that we use the average for many things, and not some other statistic.

In addition, the maximum likelihood estimator of \(\sigma^2\) is a \textbf{biased} estimator because it can be shown that \[E(\hat{\sigma}^2_{ml})=\sigma^2+\frac{\sigma^2}{n}\neq \sigma^2\]

It was Fisher who showed that this estimator was important, as he used it to generalize the central limit theorem

\hypertarget{questions-9}{%
\section{Questions}\label{questions-9}}

\textbf{1)} An estimator is not

\textbf{\(\qquad\)a:} a statistic;
\textbf{\(\qquad\)b:} a random variable;
\textbf{\(\qquad\)c:} discrete;
\textbf{\(\qquad\)d:} an observation of the parameter;

\textbf{2)} An estimator is unbiased if

\textbf{\(\qquad\)a:} it is the parameter that it estimates;
\textbf{\(\qquad\)b:} depends on \(1/n\);
\textbf{\(\qquad\)c:} its variance is small;
\textbf{\(\qquad\)d:} its expected value is the parameter it estimates;

\textbf{3)} An estimator is consistent if

\textbf{\(\qquad\)a:} it is the parameter that it estimates;
\textbf{\(\qquad\)b:} depends on \(1/n\);
\textbf{\(\qquad\)c:} its variance is small;
\textbf{\(\qquad\)d:} its expected value is the parameter it estimates;

\textbf{4)} The maximum likelihood method

\textbf{\(\qquad\)a:} Produces estimators based on the probability of the observations;
\textbf{\(\qquad\)b:} produces unbiased estimators;
\textbf{\(\qquad\)c:} produces consistent estimators;
\textbf{\(\qquad\)d:} produces estimators equal to those of the method of moments;

\hypertarget{exercises-10}{%
\section{Exercises}\label{exercises-10}}

\hypertarget{exercise-1-9}{%
\subsubsection{Exercise 1}\label{exercise-1-9}}

Take a random variable with the following probability density function

\[
f(x)=
\begin{cases}
    (1+\theta)x^\theta,& \text{if } x\in (0,1)\\
    0,&  x\notin (0,1)
\end{cases}
\]

\begin{itemize}
\item
  What is the maximum likelihood estimate for \(\theta\)?
\item
  If we take a \(5\)-sample with observations
  \(x_1 = 0.92; \qquad x_2 = 0.79; \qquad x_3 = 0.90; \qquad x_4 = 0.65; \qquad x_5 = 0.86\)
\end{itemize}

What is the estimated value of the parameter \(\theta\)?

\begin{itemize}
\tightlist
\item
  Compute \(E(X)=\mu\) as a function of \(\theta\). What is the maximum likelihood estimate for \(\mu\)?
\end{itemize}

\hypertarget{exercise-2-9}{%
\subsubsection{Exercise 2}\label{exercise-2-9}}

For a random variable with a binomial probability function

\[f(x; p)=\binom n x p^x(1-p)^{n-x}\]

\begin{itemize}
\item
  What is the maximum-likelihood estimator of \(p\) for a sample of size \(1\) of this random variable?
\item
  In \textbf{one} exam of \(100\) students we observed \(x_1=68\) students that passed the exam. What is the estimate of the \(p\)?
\end{itemize}

\hypertarget{exercise-3-6}{%
\subsubsection{Exercise 3}\label{exercise-3-6}}

Take a random variable with the following probability density function

\[
    f(x)= 
\begin{cases}
    \lambda e^{-\lambda x},& \text{if } 0 \leq x\\
    0,& otherwise 
\end{cases}
\]

\begin{itemize}
\item
  What is the maximum likelihood estimate for \(\lambda\)?
\item
  If we take a \(5\)-sample with observations
  \(x_1 = 0.223 \qquad x_2 = 0.681; \qquad x_3 = 0.117; \qquad x_4 = 0.150; \qquad x_5 = 0.520\)
\end{itemize}

What is the estimated value of the parameter \(\lambda\)?

\begin{itemize}
\item
  What is the maximum likelihood estimate of the parameter \(\alpha=\frac{n}{\lambda}\)
\item
  Is \(\alpha\) an unbiased and consistent estimator of the mean of the sample sum \(E(Y)\), where \(Y=\sum_1^n X_i\)?
\end{itemize}

\hypertarget{interval-estimation}{%
\chapter{Interval estimation}\label{interval-estimation}}

\hypertarget{objective-8}{%
\section{Objective}\label{objective-8}}

In this chapter, we will introduce the concept of \textbf{confidence intervals} for means, proportions and variances.

We will derive the formulas for the confidence intervals under different conditions, like normality with known and unknown variance, and large \(n\).

\hypertarget{estimation-of-the-mean}{%
\section{Estimation of the mean}\label{estimation-of-the-mean}}

We have seen that whenever we take a random sample \((X_1, X_2, ... X_n)\), the sample mean
\[\bar{X}=\frac{1}{n}\sum_{i=1}^n X_i\]

is an estimator of the mean \(\mu\) of the random variable \(X\). The estimator is \textbf{unbiased} because its values center about the parameter it is estimating

\begin{itemize}
\tightlist
\item
  \(E(\bar{X})=\mu\)
\end{itemize}

and \textbf{consistent} because as \(n\) increases then it is closer to the parameter because its variance gets smaller

\begin{itemize}
\tightlist
\item
  \(V(\bar{X})=\frac{\sigma^2}{n}\)
\end{itemize}

where \(\sigma^2\) is the variance of \(X\). We call the quantity \(\sigma_{\bar{x}}=\frac{\sigma}{\sqrt{n}}\) the \textbf{standard error} (\(se\)).

These properties justify that we take the value \(\bar{x}\) derived from \textbf{one particular sample} as the the value of \(\mu\), which is a characteristic of the \textbf{whole population}. That is

\[\bar{x}=\hat{\mu}\]

Since \(\bar{X}\) is a random variable the estimation of the mean changes when we take another sample. Therefore, we know that we are making an error every time we take \(\bar{x}\) for \(\mu\).

\hypertarget{margin-of-error-1}{%
\section{Margin of error}\label{margin-of-error-1}}

When deciding whether the \textbf{error} in estimation \[\bar{X}-\mu\] is large or not we usually compare it with a predefined tolerance. \textbf{If we know} that the distribution of \(X\) is normal, \(X \rightarrow N(\mu, \sigma^2)\), and we also know the values of the parameters \(\mu\) and \(\sigma^2\), we can then assess how far the estimation of \(\bar{x}\) would falls from \(\mu\).

We defined the \textbf{margin of error} at \(5\%\) level as the distance \(m\) such that distribution of \(\bar{X}\) captures \(95\%\) of the estimations:

\[P(-m \leq \bar{X}-\mu \leq m)=P(\mu-m \leq \bar{X} \leq\mu + m)=0.95\]

If \(\bar{X}\) is normally distributed then the marging of error is

\[m=z_{0.025} \frac{\sigma}{\sqrt{n}}=1.96\times se\]
where \(z_{0.025}=\phi^{-1}(0.975)=\) norm.ppf(0.975)

\textbf{Example (cables):}

We want to perform take a random sample of size \(8\): Load a cable until it breaks and record the breaking load.

Before we take the sample, \textbf{if we know} that our cables truly distribute as \[X \rightarrow N(\mu=13, \sigma^2=0.35^2)\] then

\[\bar{X} \rightarrow N(13, \frac{0.35^2}{8})\]

With mean \(E(\bar{X})=13\) and standard error \(se=\frac{0.35}{\sqrt{8}}=0.1237\)

Therefore the margin of error at \(95\%\) is

\[m=z_{0.025} \frac{\sigma}{\sqrt{n}}=1.96\times se=1.96\frac{0.35}{\sqrt{8}}=0.24\]

We therefore expect that \(\%95\) of the averages will be a distance of \(0.24\) from the mean. Note that, in this case, the margin of error only depends on \(\sigma\) and therefore is a measure of \textbf{precision}. Furthermore, it does not care where \(\mu\) really is, and therefore is \textbf{not} a measure of \textbf{accuracy}.

Now, let us take a random sample for which we find the results

\begin{verbatim}
## [1] 13.34642 13.32620 13.01459 13.10811 12.96999 13.55309 13.75557 12.62747
\end{verbatim}

The \textbf{observed average} is \(\bar{x}=13.21\), and therefore the error we would make if we replaced \(\mu\) by \(\bar{x}\), would be

\[\bar{x}-\mu=13.21-13=0.21\]
The \textbf{observed error} is within the margin of error

\[\bar{x}-\mu <m\]

When we use \(\bar{x}\) for the value of \(\mu\), we say that we are performing a \textbf{point estimation} of the parameter. We are interested in such replacement in the cases where we do not know \(\mu\).

\includegraphics{_main_files/figure-latex/unnamed-chunk-89-1.pdf}

\includegraphics{_main_files/figure-latex/unnamed-chunk-90-1.pdf}

\hypertarget{interval-estimation-for-the-mean}{%
\section{Interval estimation for the mean}\label{interval-estimation-for-the-mean}}

The problem is that in real life we \textbf{do not know} the real values of \(\mu\) or \(\sigma\) for \(X\) given

\[X \rightarrow N(\mu, \sigma^2)\]
What we do is to start by taking a sample

\includegraphics{_main_files/figure-latex/unnamed-chunk-91-1.pdf}

we then compute the mean

\includegraphics{_main_files/figure-latex/unnamed-chunk-92-1.pdf}

and that's it. What is then the value of \(\mu\)?

Our data suggest that \(\mu\) could be \(\bar{x}=13.21\). But, how \textbf{confident} are we? after all, we know that when we take \(\bar{x}\) for \(\mu\), we are making a mistake and do not how big it actually is.

To address this question, we are going to define the \textbf{confidence interval} for \(\mu\). From the margin of error equation

\[P(-m \leq \bar{X} - \mu \leq  m)=0.95\]
let's solve for \(\mu\) that is indeed \textbf{the real unknown}

\[P(\bar{X} - m \leq \mu \leq \bar{X} + m)=0.95\]

The left and right limits of the inequality are random variables which motivate the definition for the \textbf{random confidence interval at \(95\%\):}

\[(L,U)=(\bar{X} - m,\bar{X} + m)\]

This interval is a new \textbf{random variable} and it has by definition a probability of \(0.95\) to contain \(\mu\).

The \textbf{observed interval} that we obtain from the experiment is (script size)

\[(l,u)=(\bar{x} - m,\bar{x} + m)\]

This interval either contains or does not the parameter \(\mu\): we will \textbf{never know}!

However, we can still say that we have a confidence of \(95\%\) that the interval \((l,u)\) has captured the true unknown parameter \(\mu\). Think of buying a lottery scratch ticket that we cannot scratch to see the prize. The ticket either has or has not the prize, only that we do not know which case it is.

\hypertarget{case-1-known-variance}{%
\subsection{Case 1 (known variance)}\label{case-1-known-variance}}

Confidence intervals can be estimated in different cases. The first case is when

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \(X\) is a normal variable, and
\item
  we know the value of \(\sigma\)
\end{enumerate}

the confidence interval at \(95\%\) is

\[(l,u)=(\bar{x} - m, \bar{x} + m)\]
where \[m=z_{0.025} \frac{\sigma}{\sqrt{n}}\]

That is:

\[(l,u)=(\bar{x} - z_{0.025} \frac{\sigma}{\sqrt{n}}, \bar{x} + z_{0.025} \frac{\sigma}{\sqrt{n}})\]

\textbf{Example (cables):}

In our example, we assume that \(X\) is normally distributed and that we know \(\sigma^2=0.35^2\).

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Since \(\bar{X}\) is normal, the margin of error is
\end{enumerate}

\[m=z_{0.025} \frac{\sigma}{\sqrt{n}}\]
2. Since we know \(\sigma^2=0.35^2\), then the \(95\%\) confidence interval is

\((l,u)=(\bar{x} - m, \bar{x} + m)=\) \[(\bar{x}-z_{0.025} \frac{\sigma}{\sqrt{n}}, \bar{x}+z_{0.025} \frac{\sigma}{\sqrt{n}})= (12.97,13.45)\]

In Python we can compute the confidence interval with

\begin{verbatim}
# https://pypi.org/project/bioinfokit/

!pip install bioinfokit
from bioinfokit.analys import stat
import pandas as pd

data = {'x': [13.34642, 13.32620, 13.01459, 13.10811, 12.96999, 13.55309, 13.75557, 12.62747]}
df = pd.DataFrame(data)

res = stat()
res.ztest(df=df, x='x', mu=13, x_std=0.35, test_type=1)
print(res.summary)
\end{verbatim}

We can also write the interval as

\[\hat{\mu}=\bar{x}  \pm m = 13.21 \pm 0.24\]
This means that, when estimating the mean by the average, we are confident up to the number 3 in the units and not so much about the decimal places.

\includegraphics{_main_files/figure-latex/unnamed-chunk-93-1.pdf}

Remember that the confidence interval \((l,u)\) is an observation of the random confidence interval \((L,U)\). Therefore, every time that we obtain a new sample then \((l,u)\) changes. If we perform \(100\) samples of size \(n\) then about \(95\) of the confidence intervals will contain \(\mu\), we just don't know which!

\includegraphics{_main_files/figure-latex/unnamed-chunk-94-1.pdf}

\hypertarget{confidence-level}{%
\subsection{Confidence level}\label{confidence-level}}

We can change our confidence from \(95\%\) to \(99\%\). When we computed the margin of error at \(95\%\), we left out \(\alpha=0.05\) probability, \(0.025\) on each side.

Now, we can leave out \(\alpha=0.01\) probability, \(0.005\) on each side. Therefore the \(99\%\) confidence interval is

\((l,u) = (\bar{x} - z_{0.005}\frac{\sigma}{\sqrt{n}},\bar{x} + z_{0.005}\frac{\sigma}{\sqrt{n}})\)

\[= (\bar{x} - 2.58\frac{\sigma}{\sqrt{n}},\bar{x} + 2.58\frac{\sigma}{\sqrt{n}})\]

\includegraphics{./figures/phi.JPG}

where \(z_{0.005}=\phi^{-1}(0.995)=\) norm.ppf(0.995). We can also write it as

\[\hat{\mu}=\bar{x} \pm 2.58\frac{\sigma}{\sqrt{n}}\]
For our cables, the \(99\%\) confidence interval is

\[\hat{\mu}= 13.21 \pm 0.31\]

If we want to be more confident then we need larger confidence intervals. The more confidence we demand the less precision we obtain.

\textbf{Example (Impact energy):}

A metallic material is tested for impact to measure the energy required to cut it at a given temperature. Ten specimens of A238 steel were cut at 60ºC at the following impact energies (J):

\(64.1, 64.7, 64.5, 64.6, 64.5, 64.3, 64.6, 64.8, 64.2, 64.3\)

If we \textbf{asume} that the impact energy is normally distributed with \(\sigma=1J\) what is the \(95\%\) confidence interval for the mean of these data?

We know

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \(X \rightarrow N(\mu, \sigma^2)\)
\item
  \(\sigma=1J\)
\item
  \(\alpha=0.05\) (the confidence limit)
\end{enumerate}

The \(95\%\) confidence interval is then

\((l,u)=(\bar{x}-1.96 \frac{\sigma}{\sqrt{n}}, \bar{x}+1.96 \frac{\sigma}{\sqrt{n}})\)
\[=(64.46-1.96 \frac{1}{\sqrt{10}}, 64.46+1.96  \frac{1}{\sqrt{10}})=(63.84,65.08)\]

or

\[\hat{\mu}=64.46 \pm 0.61\]

this tells us that we can be sure on the first digit (6), somewhat confident on the second (4), and unsure on the decimals (46).

What if \(\sigma^2\) is \textbf{unknown}?

\hypertarget{marging-of-error-for-unkown-variance}{%
\section{Marging of error for unkown variance}\label{marging-of-error-for-unkown-variance}}

We were able to compute the confidence interval \((l,u)=(\bar{x} -m, \bar{x} -m)\) because we were able to find the margin of error

\[m=1.96 \frac{\sigma}{\sqrt{n}}\]
since \textbf{we knew} \(\sigma\). \(\sigma\) is a parameter of the distribution that we usually \textbf{do not know}, likewise \(\mu\). To find the margin of error with \textbf{unknown} variance, we need the following theorem, due to Gosset

\hypertarget{theorem-t-statistic}{%
\subsection{Theorem (T-statistic)}\label{theorem-t-statistic}}

When \(X\) is normal then the standardized statistic

\[T=\frac{\bar{X}-\mu}{\frac{S}{\sqrt{n}}}\]
follows a \(t\)-distribution with \(n-1\) degrees of freedom

\[T \rightarrow t_{n-1}\]

where \(S^2=\frac{1}{n-1} \sum_{i=1}^n (X_i-\bar{X})^2\). We can therefore compute probabilities for \(\bar{X}\), even if we do not know \(\sigma\).

Let's look at some probability densities in the family of the \(t\) distributions.

\includegraphics{_main_files/figure-latex/unnamed-chunk-95-1.pdf}

Now we need to recompute the the margin of error \(m\) at \(5\%\) level when we use the \(t\)-distribution

\(P(\mu-m \leq \bar{X} \leq\mu + m)\)
\[=P(-\frac{m}{s/\sqrt{n}} \leq T \leq\frac{m}{s/\sqrt{n}})=0.95\]

\[m=t_{0.025, n-1} \frac{s}{\sqrt{n}}\]
where \(t_{0.025, n-1}\) is the value of \(T\) that leaves \(2.5\%\) of probability at the right hand side of the \(t\)-distribution with \(n-1\) degrees of freedom. In short, if we do not know \(\sigma\), we can replace it with \(s\) but need to use a different distribution in the computation of the margin of error.

\hypertarget{case-2-unknown-variance}{%
\subsection{Case 2 (unknown variance)}\label{case-2-unknown-variance}}

The second case to compute confidence intervals is more realistic. If

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \(X\) is a normal variable
\end{enumerate}

the confidence interval at \(95\%\) is

\[(l,u)=(\bar{x} - m, \bar{x} + m)\]
where \[m=t_{0.025, n-1} \frac{s}{\sqrt{n}}\]

That is:

\[(l,u)=(\bar{x} - t_{0.025, n-1} \frac{s}{\sqrt{n}}, \bar{x} + t_{0.025, n-1} \frac{s}{\sqrt{n}})\]
where \(t_{0.025, n-1}=F^{-1}(0.975)\)=t.ppf(0.975, n-1)

\textbf{Example (Impact energy):}

A metallic material is tested for impact to measure the energy required to cut it at a given temperature. Ten specimens of A238 steel were cut at 60ºC at the following impact energies (J):

\(64.1, 64.7, 64.5, 64.6, 64.5, 64.3, 64.6, 64.8, 64.2, 64.3\)

If we \textbf{asumme} that the impact energy is normally distributed but we \textbf{do not know} the variance, what is the \(95\%\) confidence interval for the mean of these data?

We compute from the data

\begin{itemize}
\tightlist
\item
  \(\bar{x}=64.46\)
\item
  \(s=0.227\)
\end{itemize}

we assume

\begin{itemize}
\tightlist
\item
  \(\alpha=0.05\) (the confidence limit)
\item
  \(t_{0.025,9}=2.26\) obtained from \(t_{0.025,9}=\) t.ppf(0.975, 9)
\end{itemize}

The confidence interval is then

\((l,u)=(\bar{x}- t_{0.025,9}\frac{s}{\sqrt{n}},\bar{x}+t_{0.025,9} \frac{s}{\sqrt{n}})\)

\[=(64.46-2.26 \frac{0.227}{\sqrt{10}},64.46+2.26 \frac{0.227}{\sqrt{10}})\] \[=(64.29,64.62)\]

Note that when we assumed \(\sigma=1\) the confidence interval \((63.84,65.08)\) was larger. Data therefore suggests that \(\sigma<1\) as \(s=0.227\).

In Python, we can compute the confidence interval with:

\begin{verbatim}
from scipy import stats
x = [64.1,64.7,64.5,64.6,64.5,64.3,64.6,64.8,64.2,64.3]
res = stats.ttest_1samp(x, popmean=0)
res.confidence_interval(confidence_level=0.95)
\end{verbatim}

\hypertarget{estimation-of-proportions}{%
\section{Estimation of proportions}\label{estimation-of-proportions}}

\textbf{Example (vaccine):}

A random sample of \(400\) patients was selected for testing a new vaccine for the influenza virus, after \(6\) months of vaccination \(134\) were ill.~What is the expected efficacy of the vaccine?

Since each vaccination \(X_i\) is a Bernoulli trial

\[X \rightarrow Bernoulli(p)\]
with mean \(\mu=p\) and variance \(\sigma^2=p(1-p)\).

The sample is something like
\[(x_1,x_2, x_3, ...x_n)=(0,1,0,.. 1, 0)_{400}\] with \(136\) ones and in a total of \(400\) repetitions. The sample has an average \[\bar{x}=\frac{1}{400}\sum_i^{400} x_i=134/400=0.34\]

Since the sample mean is an unbiased estimator of \(\mu\), then we can have a point estimate for \(p\)

\[\hat{p}=\bar{x}=134/400=0.34\]

This makes sense because \(\bar{x}\) is the observed relative frequency of ones \(f_1\) in the sample. And as such it is an estimator of the probability of observing a one in a Bernoulli trial

\[f_1 =\hat{P}(X=1)\]
This is is consistent with frequentist definition of probability that we saw in chapter 2. However, how confident are we about this estimation? That is, how confident are we to take the relative frequency as the value of the probability? We want a confidence interval for \(p\)

\hypertarget{case-3-proportions}{%
\subsection{Case 3 (proportions)}\label{case-3-proportions}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  When \(\hat{p}n>5\) and \((\hat{p}-1)n>5\), the \textbf{standardized statistic} of \(\bar{X}\) can be approximated by a standard distribution (CLT)
\end{enumerate}

\[Z=\frac{\bar{X}-\mu}{\sigma/\sqrt{n}}= \frac{\bar{X}-p}{\big[\frac{p(1-p)}{n} \big]^{1/2}}\rightarrow N(0,1)\]
and the \(95\%\) CI interval of \(p\) is:

\[CI=(l,u)=(\bar{x}-z_{0.025}\big[\frac{\bar{x}(1-\bar{x})}{n} \big]^{1/2},  \bar{x}+z_{0.025}\big[\frac{\bar{x}(1-\bar{x})}{n} \big]^{1/2})\]
Where we estimate the Bernoulli variance \(\sigma=p(1-p)\) by \(\hat{\sigma}=\bar{x}(1-\bar{x})\). That is \(\hat{\sigma}=\sqrt{\bar{x}(1-\bar{x})}\).

\textbf{Example (vaccine):}

In our case, we are counting failures on vaccinations \(134\) in \(400\) trials.

We compute from the data

\begin{itemize}
\tightlist
\item
  \(\bar{x}=134/400=0.34\)
\end{itemize}

we assume

\begin{itemize}
\tightlist
\item
  \(z_{0.025}=1.96\) (the confidence limit)
\end{itemize}

Therefore the \(95\%\) confidence interval for \(p\) is

\((l,u)=(\bar{x}-1.96 \big[\frac{\bar{x}(1-\bar{x})}{n} \big]^{1/2}, \bar{x}+1.96 \big[\frac{\bar{x}(1-\bar{x})}{n} \big]^{1/2})\)

\[=(0.29,0.38)\]

The estimated probability of failure of the vaccine is

\[\hat{p}=0.34 \pm 0.05\]

Note: Voting intention surveys (Bernoulli test) in a sample of \(n\) individuals report this type of estimation with its \textbf{margin of error}. It does not mean that the \textbf{true value} of \(p\) falls within this interval with probability \(95\%\). It means that we are \(95\%\) confident that we have caught the \(p\) that this particular sample represents.

In Python

\begin{verbatim}
from statsmodels.stats.proportion import proportion_confint
proportion_confint(134, 400)
\end{verbatim}

\hypertarget{estimation-of-the-variance}{%
\section{Estimation of the variance}\label{estimation-of-the-variance}}

We have seen that whenever we take a random sample \((X_1, X_2, ... X_n)\), the sample variance
\[S^2=\frac{1}{n-1}\sum_{i=1}^n (X_i-\bar{X})^2\]
is an estimator of the mean \(\sigma^2\) of the random variable \(X\). The estimator is \textbf{unbiased} because its values are centered about the parameter it is estimating

\[E(S^2)=\sigma\]

and it is also \textbf{consistent}. We can then take a the value of \(s^2\) from a particular sample as the value of \(\sigma\), which is a characteristic of the whole population. That is

\[s^2=\hat{\sigma}^2\]

Since \(S^2\) is a random variable the estimation of the variance changes when we take another sample.

\textbf{Example (impact energy)}

A metallic material is tested for impact to measure the energy required to cut it at a given temperature. Ten specimens of A238 steel were cut at 60ºC at the following impact energies (J):

\(64.1, 64.7, 64.5, 64.6, 64.5, 64.3, 64.6, 64.8, 64.2, 64.3\)

what is estimation of the variance of these data?

\[s^2=0.05155556\]

In Python:

\begin{verbatim}
import numpy as np
x = [64.1, 64.7, 64.5, 64.6, 64.5, 64.3, 64.6, 64.8, 64.2, 64.3]
np.var(x)
\end{verbatim}

How confident are we on the decimals of the estimation?

\hypertarget{confidence-interval-for-the-variance}{%
\section{Confidence interval for the variance}\label{confidence-interval-for-the-variance}}

To compute a confidence interval of the variance, we need a statistics that is a function of \(S^2\) and allows us to compute probabilities. We will use the following theorem

\hypertarget{theorem-chi2}{%
\subsection{\texorpdfstring{Theorem (\(\chi^2\)):}{Theorem (\textbackslash chi\^{}2):}}\label{theorem-chi2}}

When \(X\) is normal then the standardized statistic

\[W=\frac{S^2(n-1)}{\sigma^2}\]
follows a \(\chi^2\) distribution with \(n-1\) degrees of freedom

\[W \rightarrow \chi^2_{n-1}\]

We can therefore compute probabilities for \(W\).

Let's look at some probability densities in the family of the \(\chi^2\) distriutions.

\includegraphics{_main_files/figure-latex/unnamed-chunk-96-1.pdf}

\hypertarget{confidence-interval-for-the-variance-1}{%
\subsection{Confidence interval for the variance}\label{confidence-interval-for-the-variance-1}}

We look for confidence interval of \(\sigma^2\) at confidence \(95\%\) \((L,U)\) such that \[P(L \leq \sigma^2 \leq U)=0.95\]

We can then use the \(\chi^2\) to determine the \(95\%\) of the distribution about \(W\). Lets start by defining the values that capture the \(95\%\) of the distribution

\[P(\chi^2_{0.975,n-1} \leq W \leq \chi^2_{0.025,n-1})=0.95\]
Replacing the value of \(W\)

\[P(\chi^2_{0.975,n-1} \leq \frac{S^2}{\sigma^2}(n-1) \leq \chi^2_{0.025,n-1})=0.95\]

and solving for \(\sigma^2\)

\[P(\frac{S^2 (n-1)}{\chi^2_{0.025,n-1}}\leq \sigma^2 \leq \frac{S^2(n-1)}{\chi^2_{0.975,n-1}})=0.95\]

We find a random interval that captures \(\sigma^2\)
with \(95\%\) confidence

\[(L,U) = (\frac{S^2 (n-1)}{\chi^2_{0.025,n-1}},\frac{S^2(n-1)}{\chi^2_{0.975,n-1}})\]

\hypertarget{case-4-variance}{%
\subsection{Case 4 (variance)}\label{case-4-variance}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  When \(X\) is a normal variable
\end{enumerate}

The \textbf{observed} \(95\%\) confidence interval (script size) is

\[(l,u) = (\frac{s^2 (n-1)}{\chi^2_{0.025,n-1}},\frac{s^2(n-1)}{\chi^2_{0.975,n-1}})\]

where

\begin{itemize}
\item
  \(\chi^2_{0.975,n-1}=F^{-1}(0.025)=\) chi2.ppf(0.025, df=n-1)
\item
  \(\chi^2_{0.025,n-1}=F^{-1}(0.975)=\)chi2.ppf(0.975, df=n-1)
  for \(n=10\) or \(df=n-1=9\)
\end{itemize}

\textbf{Example (impact energy)}

A metallic material is tested for impact to measure the energy required to cut it at a given temperature. Ten specimens of A238 steel were cut at 60ºC at the following impact energies (J):

\(64.1, 64.7, 64.5, 64.6, 64.5, 64.3, 64.6, 64.8, 64.2, 64.3\)

what is confidence interval for the variance of these data?

\[(l,u) = (\frac{s^2 (n-1)}{\chi^2_{0.025,n-1}},\frac{s^2(n-1)}{\chi^2_{0.975,n-1}})\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  The standard deviation of the data is \(s^2=0.05155556\)
\item
  \(n=10\)
\item
  We then compute \(\chi^2_{0.025,n-1}\) and \(\chi^2_{0.975,n-1}\)
\end{enumerate}

\begin{verbatim}
from scipy.stats import chi2
chi2.ppf(0.025, df=9)

2.700389
\end{verbatim}

\begin{verbatim}
from scipy.stats import chi2
chi2.ppf(0.975, df=9)

19.02277
\end{verbatim}

\includegraphics{_main_files/figure-latex/unnamed-chunk-97-1.pdf}

Therefore

\[(l,u)= (\frac{0.227^2 (10-1)}{19.02277},\frac{0.227^2(10-1)}{2.700389})=(0.02,0.17)\]
Note that when we computed the confidence interval for the mean and assumed \(\sigma^2=1\) (case 1), this was not consistent with the data because the confidence interval does not contain the value \(\sigma^2=1\).
According to the data \(\sigma^2 \neq 1\) at \(95\%\) confidence.

The interval for the variance is \textbf{not symmetric} and we cannot formulate it as an estimate \(\pm\) margin of error.

\includegraphics{_main_files/figure-latex/unnamed-chunk-98-1.pdf}

\hypertarget{questions-10}{%
\section{Questions}\label{questions-10}}

\textbf{1)} The margin of error at \(95\%\) confidence of a normal variable is

\textbf{\(\qquad\)a:} \(\frac{s}{\sqrt{n}}\);
\textbf{\(\qquad\)b:} \(1.96\times se\);
\textbf{\(\qquad\)c:} \(\frac{\sigma}{\sqrt{n}}\);
\textbf{\(\qquad\)d:} \(\sigma\)

\textbf{2)} when we talk about \(z_{0.025}\) we mean:

\textbf{\(\qquad\)a:} The value of a normal standard variable that has accumulated up to \(99.75\%\) of probability;
\textbf{\(\qquad\)b:} The value of a normal standard variable that has accumulates up to \(0.25\%\) of probability;
\textbf{\(\qquad\)c:} The probability of a standard variable up to \(99.75\%\);
\textbf{\(\qquad\)d:} The probability of a standard variable up to \(0.25\%\)

\textbf{3)} The random confident interval \((L,U)\) for the mean at \(95\%\)

\textbf{\(\qquad\)a:} is a two dimensional parameter of the sample distribution;
\textbf{\(\qquad\)b:} gives the limits where \(\mu\) has a probability of occurring \(95\%\) of the times;
\textbf{\(\qquad\)c:} is an estimate of the average;
\textbf{\(\qquad\)d:} captures \(\mu\) \(95\%\) of the times

\textbf{4)} A confidence interval for the mean written as \(\hat{\mu}=56.99 \pm 0.01\)

\textbf{\(\qquad\)a:} indicates that we are \(\%99\) confident that the mean is \(56.99\);
\textbf{\(\qquad\)b:} indicates that we cannot trust the last decimal place on the estimation of the mean;
\textbf{\(\qquad\)c:} indicates that the mean of the population is at \(56.99\) with error \(0.01\);
\textbf{\(\qquad\)d:} indicates that we can trust the unit figure (\(6\)) on the estimation of the mean

\textbf{5)}If we know the value of \(\mu\) and find that the confidence interval did not catch it then

\textbf{\(\qquad\)a:} the confidence interval is not well computed;
\textbf{\(\qquad\)b:} it is a rare observation of the confidence interval;
\textbf{\(\qquad\)c:} the confidence interval does not estimate the mean;
\textbf{\(\qquad\)f:} there is little probability of finding the mean in the confidence interval

\hypertarget{exercises-11}{%
\section{Exercises}\label{exercises-11}}

\hypertarget{exercise-1-10}{%
\subsubsection{Exercise 1}\label{exercise-1-10}}

In a scientific paper, the authors report a \(95\%\) confidence interval of \((228, 232)\) for the natural frequency (Hz) of a metallic beam. They used a sample of size \(25\) and considered that the measurements were distributed normally.

\begin{itemize}
\item
  What is the mean and the standard deviation of the measurements?
\item
  Compute the \(99\%\) confidence interval.
\end{itemize}

hints:

\begin{itemize}
\item
  in R \(t_{0.025, 24}=\) t.ppf(0.975, 24)\(\sim 2\)
\item
  in R \(t_{0.005, 24}=\)t.ppf(0.995, 24)\(\sim 2.8\)
\end{itemize}

\hypertarget{exercise-2-10}{%
\subsubsection{Exercise 2}\label{exercise-2-10}}

compute \(95\%\) CI the mean of a normal variable with known variance \(\sigma^2=9\) and \(\bar{x}=22\), using a sample of size \(36\).

\hypertarget{exercise-3-7}{%
\subsubsection{Exercise 3}\label{exercise-3-7}}

This year, \(17\) of \(1000\) of patients with influenza developed complications.

\begin{itemize}
\item
  Compute the \(99\%\) confidence interval for the proportion of complications.
\item
  The previous year \(2\%\) showed complications. Can we say with \(99\%\) confidence that this year there is a significant drop in influenza complications?
\end{itemize}

\hypertarget{exercise-4-4}{%
\subsubsection{Exercise 4}\label{exercise-4-4}}

What is the confidence interval for population variance of a normal variable if we take a random sample of size \(n=10\) and observe a sample variance of \(0.5\)?

\hypertarget{practice-3}{%
\section{Practice}\label{practice-3}}

Load misophonia data \url{https://alejandro-isglobal.github.io/SDA/data/data_0.txt}

\begin{itemize}
\item
  Compute the confidence interval for the mean of the cephalometric measures. (``Angulo\_convexidad'', ``protusion.mandibular'', ``Angulo\_cuelloYtercio'', ``Subnasal\_H'')
\item
  Compute the confidence interval for the proportion of misophonic (``Misofonia''), and depression (``depresion.dic'').
\item
  Compute the confidence interval for the variance of the age (``Edad''). What is the confidence interval for the standard deviation of the population?
\end{itemize}

\hypertarget{hypothesis-testing}{%
\chapter{Hypothesis testing}\label{hypothesis-testing}}

\hypertarget{objective-9}{%
\section{Objective}\label{objective-9}}

In this chapter we will study \textbf{hypothesis testing} of means and proportions. We will define what the null hypothesis and the alternative is and how to use data to choose between both.

We will also introduce hypothesis testing of variances and the errors that are made when a hypothesis is tested. These error are known as false positives and false negatives.

\hypertarget{hypothesis}{%
\section{Hypothesis}\label{hypothesis}}

When we run randomized experiments, we often want to test whether the changes we make to the experiment have a real effect. We want, for example, to know if we have been able to influence the experiment. Or, if we have submitted the experiment under a new condition, we want to know if that condition affects the result of the experiment. We usually have an idea of what the data should look like when these changes are not present. Since the results of the experiment are random with and without the change, how can we tell the difference between applying the change or not?

The strategy is to formulate the change or the new condition in terms of the values that the \textbf{parameters} of the probability distributions associated with the random experiment can take. We then use the observations from the randomized experiment under the new condition to provide \textbf{evidence} about the possible influence on the parameters.

\textbf{Examples (Tyres)}

Tyre manufacturers want to know if the average life of the tyres they produce is at least 20000 km. Let's try to translate their interest into statistical terms. Imagine a random experiment that consists of measuring how long the useful life of a particular tyre lasts. Therefore, manufacturers are interested in knowing if the average useful life of a tyre is at least 20000 km.

Let us formulate two dichotomous statements, that is, two mutually exclusive situations:

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  The mean life of tyres may be \textbf{less} than 20 000km
\item
  The mean life of tyres may be \textbf{greater} than 20000km
\end{enumerate}

This means that only one can be true. The question is then how we can use data to decide between situation a. or situation b. Let's consider that \(\mu\) is the mean of the population distribution. Therefore, the statements a. and b. can also be written as

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0: \mu \leq 20000km\)
\item
  \(H_1: \mu > 20000km\)
\end{enumerate}

Where the statement \(H_0\) is where the cars do not run for the desired 20000 km while statement \(H_1\) is the desired case. \(H_0\) and \(H_1\) are called hypotheses.

\textbf{Definition}

In statistics, a statement (conjecture) about the distribution of a random variable is called a \textbf{hypothesis}.

The hypothesis is usually written in two dichotomous statements

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\item
  The \textbf{null} hypothesis: \(H_0\) when the conjecture is false usually refers to \textbf{status quo}. The data may be explained by the satus quo.
\item
  The \textbf{alternative} hypothesis: \(H_1\) when the conjecture is true usually refers to \textbf{research hypothesis}. The data may be explained by the desired alternative.
\end{enumerate}

\textbf{Example (Fertilizer)}

So what are the null and the alternative hypothesis for the following situation?

Fertilizer developers want to test whether their new product has a real effect on the growth of plants.

Being \(\mu_0\) the mean growth of the plants \textbf{without} fertilizer (known) and \(\mu\) the mean growth of the plants with the fertilizer (unknown)

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0:\mu \leq \mu_0\) (The fertilizer may do nothing: status quo)
\item
  \(H_1:\mu > \mu_0\) (The fertilizer may have the desired effect: research interest)
\end{enumerate}

\textbf{Example (chemotherapy)}

Pharmaceutical companies need to know if a novel chemotherapy can cure 90\% of cancer patients.

Being \(p_0\) the proportion of patients that are cured \textbf{without} the chemotherapy (known) and \(p\) the proportion that are cures \textbf{with} the chemotherapy (unknown)

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0:p \leq p_0\) (The chemotherapy may do nothing: status quo)
\item
  \(H_1: p > p_0\) (The chemotherapy may have the desired effect: research interest)
\end{enumerate}

Note that our new improved experiment has the parameter \(p\) and we want to know how it compares to the experiment without \textbf{any improvement} that has the parameter \(p_0\).

We want to decide between \(H_0\) and \(H_1\). There are two options:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  We reject the alternative hypothesis \(H_1\); that is, we accept the null hypothesis \(H_0\).
\item
  We accept the alternative hypothesis \(H_1\) (our interest); that is, we reject the null hypothesis \(H_0\).
\end{enumerate}

\hypertarget{hypothesis-testing-1}{%
\section{Hypothesis testing}\label{hypothesis-testing-1}}

Let us summarize the different cases, ways and types for testing hypothesis. We will then discuss each condition with a particular example.

Hypotheses can be tested, or decided, using confidence intervals. Therefore, we are going to test hypothesis in the four \textbf{cases} that we saw for confidence intervals, namely:

\begin{itemize}
\item
  \textbf{Case 1}: Hypothesis test for the mean \(\mu\), when \(X \rightarrow N(\mu, \sigma^2)\) and we know \(\sigma\)
\item
  \textbf{Case 2}: Hypothesis test for the mean \(\mu\), when \(X \rightarrow N(\mu, \sigma^2)\) and we do not know \(\sigma\)
\item
  \textbf{Case 3}: Hypothesis test for the proportion \(p\) when \(X \rightarrow Bernoulli(p)\) and both \(np\) and \(n(1-p)\) \(> 5\).
\item
  \textbf{Case 4}: Hypothesis test for the variance \(\sigma^2\), when \(X \rightarrow N(\mu, \sigma^2)\)
\end{itemize}

There are three \textbf{ways} to test the hypotheses:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Using \textbf{confidence intervals}
\item
  using a \textbf{rejection zone}
\item
  using a \(p-value\).
\end{enumerate}

All three options are equivalent. Finally, there are three \textbf{types} of hypothesis that we can test:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{Two} tailed
\item
  \textbf{Upper} tailed
\item
  \textbf{Lower} tailed
\end{enumerate}

\hypertarget{case-1-known-variance-1}{%
\section{Case 1 (known variance)}\label{case-1-known-variance-1}}

A \textbf{tow tailed} hypothesis contrast is of the form

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0:\mu = \mu_0\) (status quo)
\item
  \(H_1:\mu \neq \mu_0\) (research interest)
\end{enumerate}

This called two tailed because the alternative hypothesis \(H_1\) requires that the mean \(\mu\) is either lower or higher than \(\mu_0\). This hypothesis can be tested in different cases. The \textbf{case 1} is when

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \(X\) is a normal variable, and
\item
  we know the value of \(\sigma^2\)
\end{enumerate}

\hypertarget{hypothesis-test-with-a-confidence-interval}{%
\subsection{Hypothesis test with a confidence interval}\label{hypothesis-test-with-a-confidence-interval}}

For \textbf{case 1} the confidence interval at \(95\%\) is

\[(l,u)=(\bar{x}-z_{0.025} \frac{\sigma}{\sqrt{n}}, \bar{x}+z_{0.025} \frac{\sigma}{\sqrt{n}})\]

\textbf{Testing Criteria:}

\begin{itemize}
\tightlist
\item
  If the confidence interval \textbf{contains} the null hypothesis
\end{itemize}

\[\mu_0\in (l,u)\] then we \textbf{accept} \(H_0\) with \(95\%\) confidence.

\begin{itemize}
\tightlist
\item
  If the confidence interval does \textbf{not contain} the null hypothesis\[\mu_0\notin (l,u)\] then we \textbf{reject} \(H_0\) with \(95\%\) confidence.
\end{itemize}

\textbf{Example (Cables)}

We buy \(8\) cables from a manufacturing company that claims that they break with \textbf{mean} of \(\mu_0=13\) Tons. We are not sure and may want to decide on whether the cables break \textbf{on average} at \(13\) Tons or not. We formulate the hypothesis contrast

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0:\mu = 13\) (The cables \textbf{may} break as the manufacturer claims: status quo)
\item
  \(H_1:\mu \neq 13\) (The cables \textbf{may not} break as the manufacturer claims: research interest)
\end{enumerate}

Since we do no know what is true, let's start by \textbf{assuming} that \textbf{the manufacturer is right} and the cables truly satisfy the null hypothesis and therefore

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \(X \rightarrow N(\mu=13, \sigma^2=0.35^2)\)
\item
  We know \(\sigma^2=0.35^2\)
\end{enumerate}

To decide between \(H_0\) or \(H_1\), we then perform \(8\) random experiments: Load a cable until it breaks and record the breaking load. These are the results.

\begin{verbatim}
## [1] 13.34642 13.32620 13.01459 13.10811 12.96999 13.55309 13.75557 12.62747
\end{verbatim}

The confidence interval \textbf{if} the manufacturer is right, namely if the null hypothesis is true, is

\[(l,u)=(\bar{x}-z_{0.025} \frac{\sigma}{\sqrt{n}}, \bar{x}+z_{0.025} \frac{\sigma}{\sqrt{n}})= (12.97,13.45)\]
The confidence interval tells us that we trust with \(95\%\) confidence that the true breaking load of the cables \(\mu\) is in the interval. We don't know the true value of \(\mu\) but we see that \(\mu=13\) Tons could be it. Since the interval caught \(\mu_0\)

\[\mu_0\in (12.97,13.45)\]

Our conclusion is to accept that \(H_0\) could have produced our \textbf{observed interval}. We also say that that the data supports with the manufacturer's claim. More technically, we say that we \textbf{do not reject} \(H_0\).

\includegraphics{_main_files/figure-latex/unnamed-chunk-100-1.pdf}

\hypertarget{hypothesis-test-with-acceptancerejection-zones}{%
\subsection{Hypothesis test with acceptance/rejection zones}\label{hypothesis-test-with-acceptancerejection-zones}}

An equivalent way to test the hypothesis is to see if our set of observations are either common or rare if we assume that the null hypothesis is true. Let's remember the hypothesis contrast

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0:\mu = \mu_0\) (status quo)
\item
  \(H_1:\mu \neq \mu_0\) (research interest)
\end{enumerate}

To test the hypothesis with a \textbf{rejection zone} we compute the standardized statistic

\[Z=\frac{\bar{X}-\mu_0}{\frac{\sigma^2}{\sqrt{n}}}\]
when the null hypothesis is true. Note that we are standardizing with \(\mu_0\) (the null hypothesis). We then see if the observed value of \(Z\) is within the interval

\[(-z_{0.025}, z_{0.025})\]
Remember that this interval defines the most common values of \(Z\) since \(P(-z_{0.025} \leq Z \leq z_{0.025})=0.95\)

The interval \((-z_{0.025}, z_{0.025})\) is called \textbf{acceptance interval} of \(H_0\) at \(95\%\) confidence level.

\includegraphics{_main_files/figure-latex/unnamed-chunk-101-1.pdf}

\textbf{Testing criteria:}

\begin{itemize}
\tightlist
\item
  If the observed statistics \(z_{obs}\) under the null hypothesis \textbf{is} in the acceptance region
\end{itemize}

\[z_{obs} \in (-z_{0.025}, z_{0.025})\]

then we \textbf{accept} \(H_0\) with \(95\%\) confidence.

\begin{itemize}
\tightlist
\item
  If the observed statistics \(z_{obs}\) under the null hypothesis \textbf{is not} in the acceptance region
\end{itemize}

\[z_{obs} \notin (-z_{0.025}, z_{0.025})\] then we \textbf{reject} \(H_0\) with \(95\%\) confidence.

The region \((-z_{0.025}] \cup[z_{0.025})\) is called the \textbf{rejection zone}.

\textbf{Example (Cables)}

If \(H_0\) is true then the standardized statistic \(\bar{X}\)

\[Z=\frac{\bar{X}-13}{\frac{0.35}{\sqrt{8}}}  \rightarrow N(0,1)\]
is an estimation of \(\mu_0\) and therefore \(Z\) is the standardized error that we make when we perform the estimation. Because we are in \textbf{case 1}, \(Z\) is standard normal
Since

\[\bar{X} \rightarrow N(13, \frac{0.35^2}{8})\]

For \textbf{our data} the standardized \textbf{observed error} is in the acceptance region

\[z_{obs}=\frac{\bar{x}-13}{\frac{0.35}{\sqrt{8}}}=1.7187 \in (-z_{0.025}, z_{0.025})\]
We conclude that our observed error is a typical observation of \(\bar{x}\) when the null hypothesis \(\mu_0\) is true. Therefore, we again accept that the data is consistent with the manufacturer's claim. We also say that we \textbf{do not reject} \(H_0\).

\includegraphics{_main_files/figure-latex/unnamed-chunk-102-1.pdf}

\hypertarget{hypothesis-test-with-a-p-value}{%
\subsection{Hypothesis test with a P-value}\label{hypothesis-test-with-a-p-value}}

We can also contrast the \textbf{two tail} hypothesis by calculating the probability that the average of another sample will be even rarer than the average we just observed. Because we are in **case 1*, We know that the standardized statistics \(Z\) is standar normal variable then we define the \(pvalue\) as

\[pvalue = P(Z \leq -z_{obs}) + P(z_{obs} \leq Z) = 2 (1-\phi(|z_{obs}|))\]

That is the probability that when we take another sample of the same size we are able to obtain an even rarer observation. If our observation is already rare then this value will be small.

\textbf{Testing criteria:}

\begin{itemize}
\tightlist
\item
  If the observed \(pvalue\) is
\end{itemize}

\[pvalue \geq \alpha =1-0.95=0.05\]

then we \textbf{accept} \(H_0\) with \(95\%\) confidence.

\begin{itemize}
\tightlist
\item
  If the observed \(pvalue\) is
\end{itemize}

\[pvalue < \alpha =1-0.95=0.05\]
then we \textbf{reject} \(H_0\) with \(95\%\) confidence.

\(\alpha\) is the significance level. It gives us how much of the distribution we are leaving out, and defines the region that we consider as rare observations.

Remember: We always trust our data. If the null hypothesis says that our data is a \textbf{rare} observation we then distrust the null hypothesis, and reject it.

\includegraphics{_main_files/figure-latex/unnamed-chunk-103-1.pdf}

\textbf{Example (Cables)}

For our data the observed statistic \(z_{obs}=1.718714\) and its \textbf{p-value} is then

\[pvalue=2 (1-\phi(1.718714))=0.08567\]
Python: 2*(1- norm.cdf(1.718714))

We conclude that if we performed a new sample is likely that we can get a more extreme result that the one we got. The null hypothesis can tolerate the observed error with \(95\%\) confidence. We therefore accept that \(H_0\) could have produced our data and say again that its is consistent with the manufacturer's claim.

In Python the entire hypothesis testing can be performed with the function ztest from the library bioinfokit (that needs to be previously installed)

\begin{verbatim}
# https://pypi.org/project/bioinfokit/

!pip install bioinfokit
from bioinfokit.analys import stat
import pandas as pd

data = {'x': [13.34642, 13.32620, 13.01459, 13.10811, 
              12.96999, 13.55309, 13.75557, 12.62747]}
df = pd.DataFrame(data)

res = stat()
res.ztest(df=df, x='x', mu=13, x_std=0.35, test_type=1)
print(res.summary)
\end{verbatim}

\begin{verbatim}
One Sample Z-test 

------------------  ----------
Sample size          8
Mean                13.2127
Z value              1.71871
p value (one-tail)   0.0428332
p value (two-tail)   0.0856665
Lower 95.0%         12.9701
Upper 95.0%         13.4552
------------------  ----------
\end{verbatim}

\hypertarget{upper-tail-hypothesis}{%
\subsection{Upper tail hypothesis}\label{upper-tail-hypothesis}}

We may be interested in only testing for the fact that our experiment's means is higher mean than the null's mean.

Upper-tailed test:

\begin{itemize}
\tightlist
\item
  \(H_0:\mu \leq 13\) (\textbf{at most} cables break as usual)
\item
  \(H_1:\mu > 13\) (cables break at a \textbf{higher} load)
\end{itemize}

This called \textbf{upper-tailed} because the alternative hypothesis \(H_1\) requires that the mean \(\mu\) is \textbf{higher} than \(\mu_0\). This hypothesis can be tested in different cases. The \textbf{case 1} is when

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \(X\) is a normal variable, and
\item
  we know the value of \(\sigma\)
\end{enumerate}

\textbf{Testing criteria:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \emph{Confidence interval:} If the \textbf{upper-tailed} confidence interval \textbf{contains} the null hypothesis
\end{enumerate}

\[\mu_0\in (l,u)=(\bar{x}-z_{0.05} \frac{\sigma}{\sqrt{n}}, \infty)\]
where \(z_{0.05}=\phi^{-1}(0.95)=\)norm.ppf(0.95), then we \textbf{accept} \(H_0\) with \(95\%\) confidence. Note that this test is from the point of view of the \textbf{data}, we are not centering the confidence interval around \(\bar{x}\), instead we are leaving all the \(5\%\) of the rare cases to the left of the average. We are therefore asking if the null hypothesis is lower than the average.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  \emph{Rejection/acceptance region:} If the observed statistics \(z_{obs}\) under the null hypothesis \textbf{is} in the acceptance region
\end{enumerate}

\[z_{obs}=\frac{\bar{x}-\mu_0}{\frac{\sigma}{\sqrt{n}}} \in (-\infty, z_{0.05})\]

then we \textbf{accept} \(H_0\) with \(95\%\) confidence. Note that this test is from the point of view of the \textbf{null hypothesis}. We are leaving all the \(5\%\) of the rare averages to the right of the null hypothesis and therefore ask if the average is higher than the null hypothesis.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  \(pvalue\): If the observed \textbf{upper-tailed} \[pvalue= 1-\phi(z_{obs})\]
\end{enumerate}

1-norm.cdf(zobs) is greater than \(\alpha=1-0.95=0.05\)

\[pvalue \geq \alpha =0.05\]

then we \textbf{accept} \(H_0\) with \(95\%\) confidence. Note that this test is again from the point of view of the \textbf{null hypothesis}. We are asking: if we were to take another average what is the probability that is higher than the observed one?

\textbf{Example (Cables)}

In the example of the cables, we may be interested only in the case that the cables are an improved version from what the manufacturer claims. Therefore the upper-tailed hypothesis is

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0:\mu \leq 13\) (The cables may break \textbf{at most} as the manufacturer claims: status quo)
\item
  \(H_1:\mu > 13\) (The cables may break \textbf{at least} as the manufacturer claims: research interest)
\end{enumerate}

We will test the higher tail of the distribution.
For the data that we discussed before, we then \textbf{reject} \(H_0\) at \(95\%\) confidence because of any of the three equivalent contrasts:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  The \textbf{upper tailed} confidence interval does not contain the null hypothesis \(\mu_0=13\)
\end{enumerate}

\[\mu_0=13 \notin (\bar{x}-z_{0.05} \frac{\sigma}{\sqrt{n}}, \infty)=(13.00914, \infty)\]
where \(z_{0.05}=\)norm.ppf(0.95)=1.644854

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  We have that the acceptance region for \(H_0\) is:
\end{enumerate}

\[(-\infty, z_{0.05})=( -\infty,  1.644854)\]

and that the observed standardized error is not in the region
\[z_{obs} =  \frac{13.21268-13}{\frac{0.35}{\sqrt{8}}}=1.7187 \notin ( -\infty,  1.644854)\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  The upper tail \(pvalue\) is lower than \(\alpha=0.05\)
  \[pvalue=1-\phi(1.7187)=0.04283451 <0.05\]
\end{enumerate}

where \(pvalue=\)1-norm.cdf(1.7187).

The hypothesis test is performed in Python under the label p value (one-tail)

\begin{verbatim}
data = {'x': [13.34642, 13.32620, 13.01459, 13.10811, 
              12.96999, 13.55309, 13.75557, 12.62747]}
df = pd.DataFrame(data)

res = stat()
res.ztest(df=df, x='x', mu=13, x_std=0.35, test_type=1)
print(res.summary)
\end{verbatim}

\begin{verbatim}
One Sample Z-test 

------------------  ----------
Sample size          8
Mean                13.2127
Z value              1.71871
p value (one-tail)   0.0428332
p value (two-tail)   0.0856665
Lower 95.0%         12.9701
Upper 95.0%         13.4552
------------------  ----------
\end{verbatim}

\includegraphics{_main_files/figure-latex/unnamed-chunk-104-1.pdf}

\hypertarget{case-2-unknown-variance-1}{%
\section{Case 2 (unknown variance)}\label{case-2-unknown-variance-1}}

A \textbf{tow tailed} hypothesis contrast of the form

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0:\mu = \mu_0\) (status quo)
\item
  \(H_1:\mu \neq \mu_0\) (research interest)
\end{enumerate}

can be tested when we do not know \(\sigma^2\) using \textbf{case 2}, namely when

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \(X\) is a normal variable, \(X \rightarrow N(\mu, \sigma^2)\), and
\item
  we do \textbf{not} know the value of \(\sigma^2\)
\end{enumerate}

Let's remember that in this case, then the \textbf{standardized error} with respect to the \textbf{sample standard deviation} \(S\)

\[T=\frac{\bar{X}-\mu}{\frac{S}{\sqrt{n}}}\]

Follows a \(t\)-distribution with \(n-1\) degrees of freedom. Therefore, we can apply \textbf{all three criteria} as in \textbf{case 1} but making the substitution of \(s\) for \(\sigma\) and \(Z\) for \(T\).

\textbf{Testing criteria:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \emph{Confidence interval:} If the confidence interval \textbf{contains} the null hypothesis
\end{enumerate}

\[\mu_0\in (l,u)=(\bar{x}-t_{0.025,n-1} \frac{s}{\sqrt{n}}, \bar{x}+t_{0.025,n-1} \frac{s}{\sqrt{n}})\] then we \textbf{accept} \(H_0\) with \(95\%\) confidence.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  \emph{Rejection/acceptance region:} If the observed statistics \(t_{obs}\) under the null hypothesis \textbf{is} in the acceptance region
\end{enumerate}

\[t_{obs}=\frac{\bar{x}-\mu_0}{\frac{s}{\sqrt{n}}} \in (-t_{0.025}, t_{0.025})\]

where \(t_{0.025}=F_t^{-1}(0.975, n-1)=\) t.ppf(0.975, n-1), then we \textbf{accept} \(H_0\) with \(95\%\) confidence.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  \(pvalue\): If the observed \(pvalue= 2 (1-F_t(|t_{obs}|))=\)2*(1- t.cdf(abs(tobs), n-1)) is
\end{enumerate}

\[pvalue \geq \alpha =1-0.95=0.05\]

then we \textbf{accept} \(H_0\) with \(95\%\) confidence.

\textbf{Example (Cables)}

For the hypothesis contrast for the braking load of the cables

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0:\mu = 13\)
\item
  \(H_1:\mu \neq 13\)
\end{enumerate}

We will only assume that the cables are normally distributed

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \(X \rightarrow N(\mu=13, \sigma^2=?)\)
\item
  We do not know \(\sigma^2\)
\end{enumerate}

Having obtained the sample

\begin{verbatim}
## [1] 13.34642 13.32620 13.01459 13.10811 12.96999 13.55309 13.75557 12.62747
\end{verbatim}

with this data, we accept \(H_0\) at \(95\%\) significance because of any of following equivalent contrasts:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  The confidence interval
\end{enumerate}

\[(\bar{x}-t_{0.025, n-1} \frac{s}{\sqrt{n}}, \bar{x}+t_{0.025, n-1} \frac{s}{\sqrt{n}})=(12.91409, 13.51127)\]

contains \(H_0:\mu=13\).

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  The acceptance region for \(H_0\) is:
\end{enumerate}

\[(-t_{0.025,7}, t_{0.025,7})=( -2.36,  2.36)\]

and the observed standardized error from \(H_0\) is
\[t_{obs} =  \frac{13.21268-13}{\frac{0.3571565}{\sqrt{8}}}=1.6843\]

within the acceptance region.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  The \[pvalue=2(1-F_{t,7}(1.6843))=0.136\]
\end{enumerate}

is greater then \(\alpha=0.05\). The \(pvalue\) is computed R like 2*(1- t.cdf(1.6843,7))

In Python this contrasts are performed with the function stats.ttest\_1samp:

\begin{verbatim}
from scipy import stats

data = [13.34642, 13.32620, 13.01459, 13.10811, 
        12.96999, 13.55309, 13.75557, 12.62747]

res=stats.ttest_1samp(data, popmean=13)
print (res)
\end{verbatim}

\begin{verbatim}
TtestResult(statistic=1.68427527723504, pvalue=0.1360005269730744, df=7)
\end{verbatim}

\includegraphics{_main_files/figure-latex/unnamed-chunk-106-1.pdf}

\textbf{Example (NaCl)}

\(11.6g\) of NaCl is dissolved in \(100 g\) of water and has a molar concentration of \(1.92 mol/L\)

We design a process to remove salt from this concentration and obtain the following results

\begin{verbatim}
## [1] 1.716 1.889 1.783 1.849 1.891
\end{verbatim}

We want to test at \(0.95\) significance if the process changes the salt concentration in ay direction. Therefore we propose a two-tail hypothesis:

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0:\mu=1.92\)
\item
  \(H_1:\mu \neq 1.92\)
\end{enumerate}

We will assume that \(X\) is normal and that we do not know the variance \(\sigma^2\). Therefore, we are in \textbf{case 2} that we test with a stats.ttest\_1samp

\begin{verbatim}
from scipy import stats

data = [1.716, 1.889, 1.783, 1.849, 1.891]

res=stats.ttest_1samp(data, popmean=1.92, alternative='two-sided')
print (res)
res.confidence_interval(confidence_level=0.95)
\end{verbatim}

\begin{verbatim}
TtestResult(statistic=-2.8038174739802226, pvalue=0.048622042176166516, df=4)
ConfidenceInterval(low=1.7321215833901604, high=1.9190784166098398)
\end{verbatim}

\hypertarget{lower-tail-hypothesis}{%
\subsection{Lower tail hypothesis}\label{lower-tail-hypothesis}}

If we are interested only in the case that we are able to remove salt from the concentration then we propose a \textbf{lower tail} hypothesis:

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0:\mu \geq 1.92\) (After the desalinization process the concentration o salt is at least the initial one: status quo)
\item
  \(H_1:\mu < 1.92\) (After the desalinization process the concentration is lower the initial one: research interest)
\end{enumerate}

Note that the lower tail is given by the alternative \(H_1\). We want to test that the average concentration after the process is lower than the initial concentration. The contrast criteria are the same as for the other types of hypothesis. For this type of hypothesis, we will accept the null hypothesis if

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \(\mu_0\) is in the confidence interval:
  \[\mu_0\in (l,u)=(-\infty, \bar{x}+t_{0.05,n-1} \frac{s}{\sqrt{n}})\]
\item
  or, \(t_{obs}\) is in the aceptance region:
\end{enumerate}

\[t_{obs}\in (t_{0.05,n-1}, \infty)\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  or, the \(pvalue\) on the lower tail of the distribution.\\
  \[pvalue=F_t(t_{obs},n-1)\]
  is lower than \(\alpha=0.05\)
\end{enumerate}

In any other case, we reject \(H_0\) and accept the alternative hypothesis.

\textbf{Example (NaCl)}

For the lower tail contrast

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0:\mu \geq 1.92\)
\item
  \(H_1:\mu < 1.92\)
\end{enumerate}

We can assume that the concentration is normal and that we do not know \(\sigma^2\). Therefore, we are in \textbf{case 2} for which we only need to change the argument alternative to less in the function t.test.

\begin{verbatim}
from scipy import stats

data = [1.716, 1.889, 1.783, 1.849, 1.891]

res=stats.ttest_1samp(data, popmean=1.92, alternative='less')
print (res)
res.confidence_interval(confidence_level=0.95)
\end{verbatim}

\begin{verbatim}
TtestResult(statistic=-2.8038174739802226, pvalue=0.024311021088083258, df=4)
ConfidenceInterval(low=-inf, high=1.8973758334933486)
\end{verbatim}

We see that the p-value is reduced in half, and therefore we have more confidence in rejecting the lower tail hypothesis than the two-sided hypothesis.

\textbf{Example 2 (soporific)}

In some cases, we are not sure about the numerical value of the hypothesis to test, but we know that we want to improve the value of a parameter in two different conditions.

In the original paper of Gosset, he analyzed the effect of two soporific medicines.

\begin{itemize}
\tightlist
\item
  10 individuals were given \textbf{soporific 1} and wrote down the additional hours slept under treatment, with a mean \(0.75\)
\end{itemize}

\begin{verbatim}
import numpy as np

medicine1 = np.array([0.7,-1.6,-0.2,-1.2,-0.1,3.4,3.7,0.8,0,2])
\end{verbatim}

\begin{itemize}
\tightlist
\item
  The same 10 individuals were given \textbf{soporific 2} and wrote down the additional hours slept under treatment, with a mean \(2.33\)
\end{itemize}

\begin{verbatim}
medicine2 = np.array([1.9,0.8,1.1,0.1,-0.1,4.4,5.5,1.6,4.6,3.4])
\end{verbatim}

The scientific hypothesis was that soporific 2 was better than soporific 1. For each individual, Gosset computed the difference between the treatments. Taking \(X\) as the \textbf{difference} between treatments, this was the sample observed for \(X\)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{=}\NormalTok{ medicine2}\SpecialCharTok{{-}}\NormalTok{medicine1}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 0 0 0 0 0 0 0 0 0 0
\end{verbatim}

finding an average of treatment gain from soporific 2 with respect to soporific 1 of \(1.58\), and \(s=1.229995\)

The scientific question can be stated as \textbf{upper-tailed} paired t-test:

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0:\mu \leq 0\) (no treatment difference: \(\mu_2-\mu_1=0\))
\item
  \(H_1:\mu > 0\) (treatment 2 higher then treatment 1: \(\mu_2-\mu_1>0\))
\end{enumerate}

Where \(\mu\) is the mean of the \textbf{differences} between treatments.

If we suppose that \(X\) is normal and we do not know \(\sigma^2\) then we are in \textbf{case 2}. the \textbf{standardized error} is:

\[T=\frac{\bar{X}}{\frac{S}{\sqrt{n}}}\]

and its observation

\[t_{obs}=\frac{\bar{x}}{\frac{s}{\sqrt{n}}}\]
which is also known as the \textbf{signal} to \textbf{noise} ratio.

we can test the hipothsis in the difference \(X=medicine_1-medicine_2\)

\begin{verbatim}
from scipy import stats

res=stats.ttest_1samp(x, popmean=0, alternative='greater')
print (res)
res.confidence_interval(confidence_level=0.95)
\end{verbatim}

\begin{verbatim}
TtestResult(statistic=4.062127683382037, pvalue=0.001416445098692135, df=9)
\end{verbatim}

or as a paired t-test, where we introduce the each separate condition, and state that the observations are paired

\begin{verbatim}
t_statistic, p_value = stats.ttest_rel(medicine2, medicine1, alternative='greater')
\end{verbatim}

\begin{verbatim}
TtestResult(statistic=4.062127683382037, pvalue=0.001416445098692135, df=9)
\end{verbatim}

\includegraphics{_main_files/figure-latex/unnamed-chunk-110-1.pdf}

\hypertarget{hypothesis-testing-with-large-n-and-any-distribution}{%
\subsection{Hypothesis testing with large n and any distribution}\label{hypothesis-testing-with-large-n-and-any-distribution}}

On many occasions, \(X\) is not normally distributed but if we can take large samples \(n \ge 30\) then we can use the CLT:

Then the \textbf{standardized error} from the null hypothesis can be approximated to a standard distribution

\[Z=\frac{\bar{X}-\mu}{\frac{\sigma}{\sqrt{n}}}  \rightarrow N(0,1)\]

and then we proceed as in \textbf{case 1}. If \(\sigma\) is unknown we then replace it with its estimate \(s\) and proceed as in \textbf{case 2} using the t-statistic

\[T=\frac{\bar{X}-\mu_0}{\frac{S}{\sqrt{n}}}\]

\hypertarget{case-3-proportions-1}{%
\section{Case 3 (proportions)}\label{case-3-proportions-1}}

If our random experiment is a Bernoulli trial \(X \rightarrow Bernoulli(p)\), we can formulate hypothesis contrasts for the probability \(p\) of and event in the trial. Consider an upper tailed hypothesis

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0: p \leq p_0\) (status quo)
\item
  \(H_1: p> p_0\) (research interest)
\end{enumerate}

In this \textbf{case 3}, we can test the for the value of the proportion if

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \(X\) is a Bernoulli trial, and
\item
  \(np\), \(n(1-p)\) are both greater than 5, so we can apply the central limit theorem.
\end{enumerate}

Remember that if we take a the sample of \(n\) Bernoulli trials \((1,0,1,...0)\), \(\bar{X}=\frac{1}{n}\sum_{i=1}^n X_i\) is the relative frequency of ones in the sample. This is an estimator of \(p\).

If we assume that the null hypothesis is true then \(X \rightarrow Bernoulli(p_0)\) and the standardized error that we make when we estimate \(p_0\) with \(\bar{X}\) is

\[Z=\frac{\bar{X}-p_0}{\frac{\sqrt{p_0(1-p_0)}}{\sqrt{n}}}  \rightarrow N(0,1)\]

\(\sigma=\sqrt{p_0(1-p_0)}\) is the standard deviation of \(X\) when the null hypothesis is true: \(V(X)=\sigma^2=p_0(1-p_0)\). With this statistics \(Z\), we can accept or reject the null hypothesis using any of the three testing criteria.

\textbf{Example (process improvement)}

We may be satisfied with a new process if \(90\%\) of the times we improve the previous process.

If we run a sample of \(200\) new processes and find that \(188\) times we improved the previous process, can we be satisfied with the new process at \(95\%\) confidence?

We then formulate an upper-tailed hypothesis contrast for the null hypothesis \(p_0=0.9\). Therefore, the null and alternative hypotheses are

\begin{itemize}
\tightlist
\item
  \(H_0: p \leq p_0=0.9\) (Not satisfactory)
\item
  \(H_1: p> p_0=0.9\) (Satisfactory)
\end{itemize}

We assume that if the null hypothesis is true then

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  the distribution of a random experiment is
\end{enumerate}

\[X \rightarrow Bernoulli (p_0)\]
2. and check that when \(p_0n=180>5\) and \((1-p_0)=n=20>5\)

And therefore can apply \textbf{case 3}.

We can use any of the three criteria to test the hypothesis. In any case, we will \textbf{reject} \(H_0\) at \(95\%\) confidence because:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  The upper tail confidence interval for the \(p\) does not include \(p_0\)
\end{enumerate}

\(p_0=0.9 \notin (\bar{x}-z_{0.05}\big[\frac{p_0(1-p_0)}{n} \big]^{1/2},1)= (0.905,1)\)

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  The observed standardized error from the null is not in the acceptance region
\end{enumerate}

\[z_{obs}= \frac{\bar{X}-p_0}{\big[\frac{p_0(1-p_0)}{n} \big]^{1/2}} =\frac{0.94-0.90}{\sqrt{0.00045}}=1.88563 \notin (-\infty, z_{0.05})=(-\infty, 1.644)\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  The upper tail \(pvalue\) is lower than \(\alpha=0.05\):
\end{enumerate}

\[pvalue=1-\phi(1.885618)=0.02967323<0.05\]

in Python: 1-norm.cdf(1.885618)

\includegraphics{_main_files/figure-latex/unnamed-chunk-111-1.pdf}

The test can be performed in Python using the proportions\_ztest function

\begin{verbatim}
from statsmodels.stats.proportion import proportions_ztest
proportions_ztest(count=0.9*200, nobs=200, value=188/200, alternative='smaller')
\end{verbatim}

\begin{verbatim}
(-1.8856180831641234, 0.029673219395960154)
\end{verbatim}

Note that the function is programmed such that the null hypothesis is in the count argument, which is used to compute the standard deviation of the sample. This is why the value of the statisitcs is negative and the test i \href{https://www.geeksforgeeks.org/how-to-perform-a-one-proportion-z-test-in-python/}{lower tailed}.

\hypertarget{case-4-variances}{%
\section{Case 4 (variances)}\label{case-4-variances}}

In many cases, experiments are run to test specific values of the dispersion of data.

Such as

\begin{itemize}
\item
  when complying with strict design standards where measurements must be between certain values.
\item
  when different treatments are applied to different groups, we want to see the dispersion of outcomes between the groups.
\end{itemize}

A \textbf{tow tailed} hypothesis contrast for the variance is of the form

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0:\sigma = \sigma_0\) (status quo)
\item
  \(H_1:\sigma \neq \sigma_0\) (research interest)
\end{enumerate}

This hypothesis for sigma (\textbf{case 4}) can be tested when

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \(X\) is a normal variable
\end{enumerate}

Remember that if we take a the sample of \(n\) Bernoulli trials \((1,0,1,...0)\), \(S^2=\frac{1}{n-1}\sum_{i=1}^n (X_i-\bar{X})^2\) is the sample variance. This is an estimator of \(\sigma^2\).

If we assume that the null hypothesis is true then \(X \rightarrow N(\mu, \sigma_0)\) and the \textbf{error ratio} that we make when we estimate \(\sigma^2\) with \(s^2\) is

\[W=\frac{(n-1)S^2}{\sigma_0^2}\]

when \(W=1\) we make no error. \(W\) has a \(\chi^2\) (chi-squared) distribution with n-1 degrees of freedom.

\[W \rightarrow \chi^2(n-1)\]

With \(W\), we can accept or reject the null hypothesis using any of the three testing criteria.

\textbf{Example (semiconductor)}

The production of a semiconductor chip is regulated by a process that requires that the thickness of a particular layer does not vary in more than \(\sigma_0=0.6mm\), from its mean of \(25mm\).

To keep control of the process every so often a sample of \(20\) specimens is taken.

On one occasion a sample of the thickness of 20 semiconductors is

\begin{verbatim}
##  [1] 24.51239 24.79975 26.35608 25.06134 25.11248 26.49211 25.40100 23.89940
##  [9] 24.40244 24.61227 26.06495 25.31304 25.34867 25.09629 24.51642 26.55461
## [17] 25.43313 23.28904 25.61018 24.58867
\end{verbatim}

The estimated standard deviation for this data is \(s=0.8462188\) was the process out of control at \(0.99\%\) confidence and should be stopped?

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sd}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.8462188
\end{verbatim}

We therefore want to contrast the upper tail hypotheses

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0:\sigma^2 \leq \sigma_0^2=0.6^2\) (Process is under control)
\item
  \(H_1:\sigma^2 > \sigma_0^2=0.6^2\) (Process is out of control)
\end{enumerate}

Let's test the hypothesis using the \textbf{acceptance region}.

The contrast statistics is \[W=\frac{(n-1)S^2}{\sigma_0^2} \rightarrow \chi^2(n-1)\]

and the threshold limit \(\alpha=0.01=0-0.99\). Therefore, the acceptance region \(P(W\leq \chi^2_{0.01,19})=0.99\) is

\[(0, \chi^2_{0.01,19})=(0,36.19)\]

In Python: \(\chi^2_{0.01,19}=\)chi2.ppf(0.99,19)\(= 36.19\)

For our data, the observed \textbf{standardized error ratio} is:

\[w_{obs}=\frac{19 (0.8462188)^2}{0.60^2}=37.79344\]

That falls outside the acceptance region

\[w_{obs}=37.79344\notin (0,36.19)\]

Therefore, we reject the null hypothesis and conclude that that yes! the process is out of control.

If we, alternativelly, calculate the upper tailed \(pvalue\)

\[pvalue=1-F_{\chi^2,19}(37.79344)= 0.006\]
we see that it is lower than \(\alpha=0.01\) and reject the null hypothesis.

R: 1-chi2.cdf(37.79344, 19)

\includegraphics{_main_files/figure-latex/unnamed-chunk-114-1.pdf}

For testing the hypothesis we can use the following code in Python

\begin{verbatim}
import numpy as np
from scipy import stats

# Sample data
x = np.array([24.51239, 24.79975, 26.35608, 25.06134, 25.11248, 
              26.49211, 25.40100, 23.89940, 24.40244, 24.61227, 
              26.06495, 25.31304, 25.34867, 25.09629, 24.51642, 
              26.55461, 25.43313, 23.28904, 25.61018, 24.58867])

# Hypothesized variance
hypothesized_variance = 0.6**2

# Degrees of freedom
df = len(x) - 1

# Calculate the test statistic
chi_square = (len(x) - 1) * np.var(x,ddof=1) / hypothesized_variance

# Calculate the critical value from the Chi-square distribution
alpha = 1 - 0.99
critical_value = stats.chi2.ppf(1 - alpha, df)

# Perform the variance test
p_value = 1 - stats.chi2.cdf(chi_square, df)

print("Variance Test:")
print("Chi-Square Statistic:", chi_square)
print("Critical Value:", critical_value)
print("P-Value:", p_value)
\end{verbatim}

\begin{verbatim}
Variance Test:
Chi-Square Statistic: 37.79345223227778
Critical Value: 36.19086912927004
P-Value: 0.006304215036982974
\end{verbatim}

\hypertarget{errors-in-hypothesis-testing}{%
\section{Errors in hypothesis testing}\label{errors-in-hypothesis-testing}}

The result of an upper tail hypothesis test may be to \textbf{reject} the null hypothesis:

\[H_0: \mu\leq\mu_0\]

when \(H_0\) is actually \textbf{true}. We must bear in mind that the decision is made based on the data. It may well be that the observed statistic has fallen, by chance, far from the null hypothesis, in the rejection zone of \(H_0\) even when this is true. When we perform the hypothesis test, we don't know if \(H_0\) is true. If we now know that \(H_0\) is true, it is because we are assuming that we have found it out in some other way. Still, the probability of rejecting \(H_0\) when it is true is precisely the level of statistical significance \(\alpha\). We call this probability the probability of making a \textbf{type 1} error. Taking the example for \textbf{case 1}, an upper tail test, and a confidence of \(95\%\) we have that

\[\alpha = P(Z> z_{0.05})=0.05\]

where \(z_{0.05}=\phi^{-1}(0.95)=\) norm.ppf(0.95)=1.644

\includegraphics{_main_files/figure-latex/unnamed-chunk-115-1.pdf}

A type 1 error is also called a \textbf{false positive} because our research interest is in \(H_1\). When we reject \(H_0\), we accept \(H_1\) and say that our test is \textbf{positive}. Accepting \(H_1\) translates to announcing a discovery, so the type 1 error is announcing a discovery when it doesn't exist: we did it because the data suggested it.

There is another type of error. The result of an upper tail hypothesis test can be \textbf{accepting} the null hypothesis:

\[H_0: \mu\leq\mu_0\]

when this is \textbf{not true}. In this case, it may be that the observed statistic has fallen, due to randomness, close to the null hypothesis, in the zone of acceptance of \(H_0\), when really \(H_1\) is true. If we found out somehow that, for example, \(\mu\) really does have a value of \(\mu_1\) then the alternative hypothesis would be exactly:

\[H_1: \mu=\mu_1\]

\includegraphics{_main_files/figure-latex/unnamed-chunk-116-1.pdf}

If \(H_1\) is indeed true (red line, which we don't know when we perform the hypothesis test) then the observed statistics are \textbf{really} random variables \(Y\) that are distributed with mean (case 1)

\[E(Y)=\frac{\mu_1-\mu_0}{\frac{\sigma}{\sqrt{n}}}\]

and most of them will fall close to this value, therefore, in the rejection area of \(H_0\), validating the hypothesis test. However, there are cases in which the observed statistic falls within the acceptance zone of \(H_0\) due to randomness, despite the fact that the statistics are produced by \(H_1\). In these cases we accept \(H_0\) when it is not true. This error is called \textbf{a type 2 error} or a \textbf{false negative}. For case 1, with an upper tailed test and a confidence level of \(95\%\), this is

\[\beta= P(Y < z_{0.05})\]
Where \(Y \rightarrow N(\frac{\mu_1-\mu_0}{\sigma/\sqrt{n}},1)\) is the \textbf{true distribution} of the observed statistics.

\textbf{Example (Light bulb)}

The energy efficiency of a new light bulb is a normal random variable with a standard deviation of \(5\) watts. We consider that the light bulbs we produce are efficient if their average does not exceed \(80\) watts, so we propose the hypothesis test

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0 : \mu \geq 80\) (efficient)
\item
  \(H_1 : \mu < 80\) (not efficient)
\end{enumerate}

We want to prove that we produce efficient light bulbs and we plan to draw a random sample of size 100, with a statistical significance level of \(5\%\). If previous studies have suggested that light bulbs may average \(\mu=\mu_1=79\) watts, what type 2 error do we expect?

The contrast is for \textbf{case 1} with a \textbf{lower tail}. Therefore the probability of accepting the null hypothesis (we do not produce efficient light bulbs) is

\[\alpha = P(Z< z_{0.95})=0.05\]
and \(z_{0.95}=\)norm.ppf(0.05)\(=-1.644\).

The type 2 error is therefore

\[\beta= P(Y > -1.644)\]

that is, the probability of accepting that we do not produce efficient light bulbs when in fact we do. Because we are in \textbf{case 1}, as we know \(\sigma\) and the variable is normal, the observed statistics are actually distributed as

\[Y \rightarrow N(\frac{79-80}{5/\sqrt{100}}=-2,1)\] and the type 2 error is

\[\beta = 1-F(-1.644)=0.36\]

computed in Python as 1-norm.cdf(-1.644,-2,1)=0.36. Therefore, only \(\alpha=5\%\) of the times we would announce that we produce efficient light bulbs when they really are not, while \(\beta=36\%\) of the times we would announce that we have a production that is not useful when it really does work.

When we carry out a hypothesis test we have two possibilities for each condition

\begin{itemize}
\tightlist
\item
  \(H_1\) is actually : \textbf{true} (\(\mu=\mu_1\)) or \textbf{false} (\(\mu=\mu_0\))
\item
  The test for \(H_1\) is: \textbf{positive} (\(z_{obs}\) in the acceptance zone of \(H_1\)) or \textbf{negative} (\(z_{obs}\) in the acceptance zone of \(H_0\))
\end{itemize}

\textbf{Example (PCR)}

We do \textbf{a} PCR to test for an infection. The hypothesis test is

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0\) no infection
\item
  \(H_1\) there is infection
\end{enumerate}

We do the PCR test and it gives us

\begin{enumerate}
\def\labelenumi{\roman{enumi}.}
\tightlist
\item
  negative: we reject the infection (\(H_1\))
\item
  positive: we accept the infection (\(H_1\))
\end{enumerate}

We can write the contingency table for the probabilities of the results of the hypothesis test as

\begin{longtable}[]{@{}ccc@{}}
\toprule\noalign{}
& \(H_1\) is true & \(H_0\) is true \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{The test on \(H_1\) is positive} & \(1-\beta\) & \(\alpha\) \\
\textbf{The test on \(H_1\) is negative} & \(\beta\) & \(1-\alpha\) \\
\textbf{sum} & 1 & 1 \\
\end{longtable}

we therefore have

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  The \textbf{type 2 error} rate: probability of a false negative (ignore a finding when it is true)
\end{enumerate}

\[\beta=P(negative|H_1)\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\item
  \textbf{True positive} rate: This is the power or sensitivity of a test (affirming a discovery when it is true, the main objective)
  \[1-\beta=P(positive|H_1)\]
\item
  \textbf{Type 1 error} rate: probability of a false positive (state a discovery when it is false)
  \[\alpha=P(positive|H_0)\]
\item
  \textbf{True Negative} rate: This is the specificity of a test (ignore a finding when it is false)
  \[1-\alpha=P(negative|H_0)\]
\end{enumerate}

\hypertarget{exercises-12}{%
\section{Exercises}\label{exercises-12}}

\hypertarget{exercise-1-11}{%
\subsubsection{Exercise 1}\label{exercise-1-11}}

Imagine we take a random sample of size \(n = 41\) of a normal random variable \(X\), and find that the sample average is \(10\) and the sample variance is \(1.5\).

\begin{itemize}
\tightlist
\item
  What is then the confidence interval for the mean of \(X\) at \(95\%\) confidence level?
\end{itemize}

Consider that \(t_{0.025,40}=\) t.ppf(0.975, 40) \(\sim 2\).

\begin{itemize}
\item
  Test the hypothesis that the mean of \(X\) is \textbf{different} than \(10.5\), using a \(5\%\) significance threshold.
\item
  Write the code to calculate the P-value to test the hypothesis that the mean of \(\mu\) is \textbf{lower} than \(10.5\), using a \(5\%\) significance threshold.
\end{itemize}

Consider that the code for the T probability distribution with \(n-1\) degrees of freedom is t.cdf(tobs, n-1).

\hypertarget{exercise-2-11}{%
\subsubsection{Exercise 2}\label{exercise-2-11}}

\(10\) gas condensates showed the following concentrations of mercury (in \(ng/ml\)):

\(23.3\), \(22.5\), \(21.9\), \(21.5\), \(19.9\), \(21.3\), \(21.7\), \(23.8\), \(22.6\), \(24.7\)

Assuming that the mercury concentration is distributed normally across gas condensates, test the hypothesis that condensate does not surpass the toxicity limit established at \(24 ng/ml\).

\hypertarget{exercise-3-8}{%
\subsubsection{Exercise 3}\label{exercise-3-8}}

The manufacturer of gene expression microarrays guarantees that at least \(97\%\) of the microarrays they produce have high-quality signals. A customer receives a batch of \(200\) pieces and finds that \(8\) unperformed.

Should the customer return the lot due to poor quality?

\hypertarget{practice-4}{%
\section{Practice}\label{practice-4}}

Load misophonia data \url{https://alejandro-isglobal.github.io/SDA/data/data_0.txt}

We have four measures of anxiety:

\begin{itemize}
\tightlist
\item
  Trait: ansiedad.rasgo (are you an anxious person?) continuous:0-100
\item
  State: ansiedad.estado (are you currently feeling anxious?) continuous:0-100
\item
  Diagnosed: ansiedad.medicada (have you been diagnosed with an anxiety disorder?) binary (si, no)
\item
  Excess: ansiedad.dif (difference between State and Trait)
\end{itemize}

We are interested in the variable misofonia.dif, that is the observed \textbf{excess} of anxiety from the trait

\(excess = state - trait\)

Test the following hypotheses

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\item
  Is excess in anxiety different from 0? is it higher?
\item
  Is excess in anxiety higher than 0 for men and women separately?
\item
  Is the proportion of anxious patients different from \(0.03\)?
\end{enumerate}

\hypertarget{contingency-tables}{%
\chapter{Contingency tables}\label{contingency-tables}}

\hypertarget{objective-10}{%
\section{Objective}\label{objective-10}}

In this chapter we will see how to test statistical independence between \textbf{two discrete} variables.

We will use the contingency table of conditional probabilities to derive the null hypothesis and test it with a \(\chi^2\) statistics.

We will also introduce the Fisher exact test for contingency tables

\hypertarget{difference-between-proportions}{%
\section{Difference between proportions}\label{difference-between-proportions}}

For disease surveillance, we want to know if more hepatitis C patients are being observed in hospital \(A\) than in hospital \(B\)?

\textbf{Example (Hepatitis C)}
We write down the status of hepatitis C of a patient who goes to \textbf{hospital A}. In hospital \(A\) we observe

\[1, 0, 0, 1, 0, ... 0\]

where the first patient has hepatitis and the last one did not.

Hepatitis C diagnosis is a Bernoulli trial \(X\) with outcomes (0:no hepatitis and 1:hepatitis) that has a probability mass function

\[X_A \rightarrow Bernoulli (p_A)\]
The parameter \(p_A\) is the probability of hepatitis at hospital \(A\).

We also write down the hepatitis status of a patient who goes to \textbf{hospital B}, and observe

\[0, 0, 1, 0, 0, ... 1\]

Diagnosis at this hospital is a Bernoulli trial with probability \(p_B\)

\[K_B \rightarrow Bernoulli (p_B)\]

\hypertarget{difference-between-proportions-1}{%
\section{Difference between proportions}\label{difference-between-proportions-1}}

In this study \textbf{one} random experiment has two outcomes: \((disease, hospital)\). That is the status of a patient is determined by two variables \textbf{both of which are categorical}

These are the possible outcomes of each variable:

\begin{itemize}
\tightlist
\item
  \(Disease \in\{no, yes\}\)
\item
  \(Hospital \in \{A,B\}\)
\end{itemize}

Repeating the experiment \(n\) times, the data for the first five patients look like

\begin{verbatim}
##   Hospital Disease
## 1        A     yes
## 2        A      no
## 3        B      no
## 4        A     yes
## 5        A      no
\end{verbatim}

The first patient was from hospital A and had hepatitis C.

\textbf{Question:}

Our research question is to find whether \(Disease\) and \(Hospital\) are \textbf{statistically independent} variables. We want to know if there is more infections in one hospital than another and perhaps emit an alarm to the affected hospital. Let's formulate the hypothesis contrast.

\hypertarget{contingency-table-of-conditional-probabilities}{%
\section{Contingency table of conditional probabilities}\label{contingency-table-of-conditional-probabilities}}

Our experiment is such that we make diagnosis \textbf{conditioned} to each hospital. We then have the conditional probability table

\begin{longtable}[]{@{}ccc@{}}
\toprule\noalign{}
& Hospital: \(A\) & Hospital: \(B\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Hepatitis} (no) & \(P(no|A)=(1-p_A)\) & \(P(no|B)=(1-p_B)\) \\
\textbf{Hepatitis} (yes) & \(P(yes|A)=p_A\) & \(P(yes|B)=p_B\) \\
\textbf{sum} & \(1\) & \(1\) \\
\end{longtable}

We want to know if for example the probability of infection in hospital \(A\) is different from the probability of infection in hospital \(B\), and therefore the hypothesis contrast is

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0: p_A=p_B\) (status quo) no differences of infection probability between hospitals.
\item
  \(H_1: p_A\neq p_B\) (research question) the infection probabilities are different between hospitals.
\end{enumerate}

\hypertarget{test-for-the-difference-between-proportions}{%
\section{Test for the difference between proportions}\label{test-for-the-difference-between-proportions}}

If we consider that the \textbf{null hypothesis} is true then, then the hospital tag (``A'' or ``B'') is statistically independent from whether a diagnosed of hepatitis C was observed. Remember the definition of statistical independence: if infection is independence of hospitals then
\[p=P(yes)=P(yes|A)=P(yes|B)\]
Therefore the hypothesis contrast is:

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0: p=p_A=p_B\)
\item
  \(H_1: p\neq p_A \neq p_B\)
\end{enumerate}

We do \textbf{not know} the values of \(p\), \(p_A\) and \(p_B\). Therefore we need to \textbf{estimate} them from the data.

\textbf{Example (Hepatitis C)}

We perform diagnostic surveillance in both hospitals and found

\begin{itemize}
\item
  Hospital \(A\) included in the study a total of \(n_A=200\) and observed \(18\) infections.
\item
  Hospital \(B\) included in the study a total of \(n_B=400\) and observed \(46\) infections.
\end{itemize}

For hospital \(A\) we have that the estimated probability of infection is the \textbf{relative frequency} of infections, that is

\begin{itemize}
\tightlist
\item
  \(\bar{x}_A=\hat{p}_A=18/200=0.09\)
\end{itemize}

Consequently, for hospital \(B\), we have that the estimated probability of infection is

\begin{itemize}
\tightlist
\item
  \(\bar{x}_B=\hat{p}_B=46/400=0.115\)
\end{itemize}

If the null hypothesis is true then the rate of infection \(p\) can be estimated from either hospital, or from the two hospitals \textbf{taken together}, as if they were same hospital:

\[\hat{p}=\frac{n_A\bar{x}_A+n_B\bar{x}_B}{n_A+n_B}=\frac{18+46}{200+400}=0.1066667\]

\hypertarget{chi2-test}{%
\section{\texorpdfstring{\(\chi^2\) test}{\textbackslash chi\^{}2 test}}\label{chi2-test}}

For the first hospital the \textbf{standardized error} observed when we estimate the rate of infection \(\hat{p}\) using only the average rate of infections at this hospital is

\[Z_A= \frac{\bar{X}_A-\hat{p}}{\sqrt\frac{\hat{p}(1-\hat{p})}{n_A}}\]

The error made in hospital \(B\) is

\[Z_B= \frac{\bar{X}_B-\hat{p}}{\sqrt\frac{\hat{p}(1-\hat{p})}{n_B}}\]

\includegraphics{_main_files/figure-latex/unnamed-chunk-118-1.pdf}

In the plot, each cross is a diagnosis (either \(1\) or \(0\)) the dotted line is the estimated probability \(\hat{p}\) of both hospitals taken together and the dots are the estimated probabilities of each separate hospital.

The conditional probability table by hospital is

\begin{longtable}[]{@{}ccc@{}}
\toprule\noalign{}
& Hospital: \(A\) & Hospital: \(B\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Hepatitis} (no) & \(0.910\) & \(0.885\) \\
\textbf{Hepatitis} (yes) & \(0.090\) & \(0.115\) \\
\textbf{sum} & \(1\) & \(1\) \\
\end{longtable}

Which we can illustrate in a barplot

\includegraphics{_main_files/figure-latex/unnamed-chunk-119-1.pdf}

The probabilities of infection within each hospital are different but look very similar. Is the difference significant, although small?

Using the CLT, the total \textbf{standardized squared error} from both hospitals is

\[W= Z_A^2+Z_B^2\rightarrow \chi^2(1)\]

which is a random variable that follows a \(\chi^2\) distribution with 1 degree of freedom.

Note: We formulated the null hypothesis from the statistical independence given by conditional probabilities. \textbf{Another alternative} is to formulate it from the product of the marginals.

Therefore, the hypothesis test can \textbf{also} be written as

\begin{itemize}
\tightlist
\item
  \(H_0:P(yes, A)=P(yes)*P(A)\) (Disease and Hospital A are statistically \textbf{independent} as the joint probability is the product of the marginals)
\item
  \(H_1:P(yes, A)\neq P(yes)*P(A)\)
  (Disease and Hospital A are statistically \textbf{dependent})
\end{itemize}

If hospitals and infection status are truly independent from each other then one can show that the variable \(W\) above \textbf{can also} be computed as the sum of the squared errors that we make when we estimate the joint probabilities using the marginals (i.e.~\(\hat{p}_{yes,A}=\hat{p}_{yes}\hat{p}_A\)), which we are allowed if the null hypothesis is true. Therefore the total \textbf{standardized squared error} of before can be re-written as:

\[W= \frac{(\hat{p}_{no,A}-\hat{p}_{no}\hat{p}_{A})^2}{\hat{p}_{no}\hat{p}_{A}}+\frac{(\hat{p}_{no,B}-\hat{p}_{no}\hat{p}_{B})^2}{\hat{p}_{no}\hat{p}_{B}}+\frac{(\hat{p}_{yes,A}-\hat{p}_{yes}\hat{p}_{A})^2}{\hat{p}_{yes}\hat{p}_{A}}+\frac{(\hat{p}_{yes,B}-\hat{p}_{yes}\hat{p}_{B})^2}{\hat{p}_{yes}\hat{p}_{B}}\]

If the observed value for \(W\) is a rare error from the null hypothesis, for a \(\chi^2\) variable, we then reject the null hypothesis.

\textbf{Example (Hepatitis C)}

When we compute the observed value of \(W\) we find

\[w_{obs}= \frac{0.09-0.1066667}{\sqrt{\frac{0.1066667(1-0.1066667)}{200}}}+ \frac{0.115-0.1066667}{\sqrt{\frac{0.1066667(1-0.1066667)}{400}}}= 0.87453\]

We can test whether this value is large under the null hypothesis. If the null is true this statistics is close to zero, otherwise is large. We can then compute the \(pvalue\) given by

\[pvalue=P(W \geq w_{obs}) =0.3497\]

or in Python

\begin{verbatim}
import numpy as np
from scipy.stats import chi2_contingency

# Create the 2x2 contingency table
observed = np.array([[182, 18], [354, 46]])

# Perform the chi-squared test
chi2, p, dof, expected = chi2_contingency(observed, correction=False)
print(f"Chi-squared statistic: {chi2:.4f}")
print(f"P-value: {p:.4f}")
\end{verbatim}

\begin{verbatim}
Chi-squared statistic: 0.8745
P-value: 0.3497
\end{verbatim}

This \(pvalue\) is not lower than the significance level \(\alpha=0.05\) and therefore we \textbf{do not} reject \(H_0\) and acept either

\begin{itemize}
\item
  that the frequencies of hepatitis C \textbf{are equal} between hospitals
\item
  or, equivalently, that the frequency of hepatitis C \textbf{is independent} from hospital
\item
  or, equivalently, that the frequency of hepatitis C \textbf{is not significantly associated} with the hospital.
\end{itemize}

\hypertarget{fishers-exact-test}{%
\section{Fisher's exact test}\label{fishers-exact-test}}

Another approach is \textbf{Fisher's exact test}: Take a ballot for each of the \(N=600\) patients of both studies into an urn:

There are a total of \(N\) ballots:

\begin{itemize}
\tightlist
\item
  There are \(K=64\) ballots that have hepatitis C
\item
  \(N-K=536\) ballots do not have hepatitis C
\end{itemize}

Then, if we take a \(n=200\) randomly selected ballots (similar in number to hospital \(A\)), we may ask: What is the probability of observing more than \(18\) patients with hepatitis C? Remember that \(18\) infections were actually observed. Therefore, we are asking how rare that observation in the case where the Hospital plays no role. That is the probability a more extreme observation under the null hypothesis, or put simply the \(pvalue\). More explicitly the hypothesis contrast is

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0: p_A \geq 64/600\)
\end{enumerate}

The null hypothesis (status quo) assumes that hospital \(A\) has the same parameter of both hospitals together.

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  \(H_1: p_A < 64/600\)
\end{enumerate}

The alternative hypothesis assumes that the parameter of hospital \(A\) is lower than the parameter for both hospitals together

\hypertarget{hypergeometric-distribution}{%
\section{Hypergeometric distribution}\label{hypergeometric-distribution}}

The probability of obtaining \(x\) hepatitis C cases in a sample of \(n\) drawn from a population of \(N\) where \(K\) have hepatitis C is

\(P(X=x)=P(one\,sample) \times (Number\, of\, ways\, of\, obtaining\, x)\)

\[=\frac{1}{\binom N n}\binom K x \binom {N-K} {n-x}\]

\[X \rightarrow Hypergeometric(N,K,n)\]

\includegraphics{_main_files/figure-latex/unnamed-chunk-120-1.pdf}

If the observed value for \(x=18\) is a rare \textbf{observation} from the null hypothesis, we then reject the null hypothesis. The lower tail \(pvalue\) for an observation \(X=18\) is

\[pvalue=P_{hyper}(X \leq 18) =0.2147683\]
In Python

\begin{verbatim}
from scipy.stats import hypergeom

# Calculate the hypergeometric probability
hypergeom.cdf(18, 600, 64, 200)
\end{verbatim}

Which is not lower than the significance level \(\alpha=0.05\) and therefore we \textbf{do not} reject \(H_0\) and conclude:

\begin{itemize}
\tightlist
\item
  that the frequency of hepatitis C \textbf{is not significantly associated} with the hospital.
\end{itemize}

The \textbf{odds ratio} gives us the \textbf{strength} of the of the change in the in the infection proportion between hospitals:

\[OR=\frac{p_A/(1-p_A)}{p_B/(1-p_B)}=0.76\]

It is a magnitude of the \textbf{observed statistical association} between hospital and disease. We use the \(OR\) to distinguish between the different cases

\begin{itemize}
\tightlist
\item
  When \(p_A\) is equal to \(p_B\) then \(OR=1\) (idependence of infection and hospital)
\item
  When \(p_A\) is lower to \(p_B\) then \(OR<1\)
\item
  When \(p_A\) is greater than \(p_B\) then \(OR>1\)
\end{itemize}

The way we report the \(OR\) in the case of the hospitals is: There was \textbf{a decrease} of \(24\%\) (\(1-0.76\)) in the risk of hepatitis C for hospital \(A\) in relation to hospital \(B\) but it was not statistically significant (\(pvalue=0.21\)).

This is how we compute it:

\begin{verbatim}
import numpy as np
from scipy.stats import fisher_exact

# Create the 2x2 contingency table
observed = np.array([[18, 182], [46, 354]])

# Perform the Fisher's exact test with "less" alternative hypothesis
odds_ratio, p_value = fisher_exact(observed, alternative="less")

print(f"Odds ratio: {odds_ratio:.4f}")
print(f"P-value: {p_value:.4f}")
\end{verbatim}

\begin{verbatim}
Odds ratio: 0.7611
P-value: 0.2148
\end{verbatim}

\hypertarget{difference-between-several-proportions}{%
\section{Difference between several proportions}\label{difference-between-several-proportions}}

Now, we want to know if the frequency of hepatitis C is different across \(5\) difference hospitals.

We then formulate the hypothesis contrast:

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0: p=p_A=p_B=p_C=p_D=p_E\)
\end{enumerate}

The null hypothesis (status quo) assumes that hospital (\(i=\{A,B,C,D,E\}\)) and disease (\(j=\{yes, no\}\)) are all independent and then they have the same infection rate.

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  \(H_1: p\neq p_{A,B,C,D,E}\)
\end{enumerate}

The alternative hypothesis assumed that \textbf{at least one hospital} is not independent from infection.

When we collect the data we can build a contingancy table for the observations

\begin{longtable}[]{@{}cccccc@{}}
\toprule\noalign{}
& \(A\) & \(B\) & \(C\) & \(D\) & \(E\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Hepatitis} (no) & \(182\) & \(354\) & \(375\) & \(85\) & \(90\) \\
\textbf{Hepatitis} (yes) & \(18\) & \(46\) & \(25\) & \(15\) & \(10\) \\
\textbf{sum} & \(200\) & \(400\) & \(400\) & \(100\) & \(100\) \\
\end{longtable}

We have that the \textbf{standardized squared error} from the null hypothesis can be written as:

\[W= Z_A^2+Z_B^2+Z_C^2+Z_D^2+Z_E^2\rightarrow \chi^2(4)\]

which is a random variable that follows a \(\chi^2\) distribution with \(4=5-1\) degrees of freedom (number of hospitals \(-1\)).

Each term in \(W\) is the squared \textbf{standardized error} observed when we estimate the rate of infection \(\hat{p}\) using only the average rate of infections at each hospital. And the average infections across hospitals is

\[\hat{p}=\frac{n_A\bar{x}_A+n_B\bar{x}_B+n_C\bar{x}_C+n_D\bar{x}_D+n_E\bar{x}_E}{n_A+n_B+n_C+n_D+n_E}=\frac{18+46+25+15+10}{200+400+400+100+100}=0.095\]

The computation of the observed \textbf{standardized squared error} is
\[w_{obs}=10.381\]

For which we can test how rare an observation is, using a \(pvalue\)

\[pvalue=P(W \geq w_{obs}) = 0.03448\]
These valeus can be obtained in Python with the following code

\begin{verbatim}
import numpy as np
from scipy.stats import chi2_contingency

# Create the 2x5 contingency table (adjust the data as needed)
observed = np.array([[18, 46, 25, 15, 10], [182, 354, 375, 85, 90]])

# Perform the chi-squared test
chi2_stat, p_value, dof, expected = chi2_contingency(observed)

print(f"Chi-squared statistic: {chi2_stat:.4f}")
print(f"P-value: {p_value:.4f}")
print(f"Degrees of freedom: {dof}")
\end{verbatim}

\begin{verbatim}
Chi-squared statistic: 10.3809
P-value: 0.0345
\end{verbatim}

The \(pvalue\) is lower than the significance level \(\alpha=0.05\) and therefore we \textbf{reject} \(H_0\) and conclude that: The frequency of hepatitis C \textbf{is significantly associated} with the hospital.

We can illustrate the result a conditinal frequency table by hospital or with a barplot. We see that Hospital C and D may have too low and too large infection rates

\begin{verbatim}
##    
##          A      B      C      D      E
##   0 0.9100 0.8850 0.9375 0.8500 0.9000
##   1 0.0900 0.1150 0.0625 0.1500 0.1000
\end{verbatim}

\includegraphics{_main_files/figure-latex/unnamed-chunk-122-1.pdf}

\hypertarget{questions-11}{%
\section{Questions}\label{questions-11}}

\textbf{1)} The \(\chi^2\) test for contingency table is used to

\textbf{\(\qquad\)a:} test the associations of a categorial variable;
\textbf{\(\qquad\)b:} test statistical independence between two categorical variables;
\textbf{\(\qquad\)c:} test statistical independence between a continuous and a categorical variable;
\textbf{\(\qquad\)d:} test significance of a categorial variable

\textbf{2)} In the Fisher test we compute the \(pvalue\) using

\textbf{\(\qquad\)a:} the central limit theorem;
\textbf{\(\qquad\)b:} a conditional probability;
\textbf{\(\qquad\)c:} the relative frequencies;
\textbf{\(\qquad\)d:} a parameric model

\textbf{3)} The probability to heal from an injury without treatment is 0.6. The probability to heal from an injury with treatment is 0.8. What is the odd ratio of healing with treatment with respect of healing without it.

\textbf{\(\qquad\)a:} 0.376;
\textbf{\(\qquad\)b:} 1.5;
\textbf{\(\qquad\)c:} 2.666;
\textbf{\(\qquad\)d:} 0.6666

\textbf{4)} The null hypothesis in testing for differences in proportions across different conditions assume

\textbf{\(\qquad\)a:} different conditions for different proportions;
\textbf{\(\qquad\)b:} the same condition across different proportion;
\textbf{\(\qquad\)c:} different proportions across the conditions;
\textbf{\(\qquad\)d:} the same proportion across the conditions\\
\textbf{5)} if the \(pvalue\) is lower than \(0.05\) in a test of several proportions then

\textbf{\(\qquad\)a:} we accept that at least one proportion is different from the rest;
\textbf{\(\qquad\)b:} We accept that all proportions are different between each other;
\textbf{\(\qquad\)c:} We accept the all proportions are equal;
\textbf{\(\qquad\)d:} We accept that there is one single proportion

\hypertarget{practice-5}{%
\section{Practice}\label{practice-5}}

Load hospital data (\url{https://alejandro-isglobal.github.io/SDA/data/hospital.txt})

\begin{itemize}
\item
  Test the hypothesis that the infection proportion at hospitals C and D are different. Use a \(\chi^2\) test and a exact Fisher test. Interpret the OR.
\item
  Make a bar plot
\item
  Test the hypothesis that the infection proportion at hospitals A, B and E are different.
\item
  Make a bar plot
\end{itemize}

\hypertarget{mean-differences-between-two-samples}{%
\chapter{Mean differences between two samples}\label{mean-differences-between-two-samples}}

\hypertarget{objective-11}{%
\section{Objective}\label{objective-11}}

In this chapter we will see how to test statistical independence of \textbf{one continuous} under two \textbf{discrete} conditions or group.

We will see the case where \(n\) is large and we can use a \(Z\) test. We will also introduce \(t\) test that allows testing for the cases of small \(n\) with equal and unequal variances.

We will introduce the concepts with the reanalysis of real data from reported studies relating sex differences in leptin levels.

\hypertarget{differece-in-means-between-two-groups}{%
\section{Differece in means between two groups}\label{differece-in-means-between-two-groups}}

We will consider an outcome of interest

\[ Y \rightarrow N(\mu, \sigma^2)\]

which we aim to measure several times under \textbf{two different conditions} or groups \(A\) and \(B\) and determine if the outcome's mean changes between the conditions. When testing hypothesis for the mean, we often do not know the value of the null \(\mu_0\). Therefore, we often use condition \(A\) as \textbf{the null} (controlled condition) and then compare it with the mean in a \textbf{new condition} where we have our research interest, condition \(B\) (treatment condition). This is the case of testing for example differences in clinical outcomes between cases and controls, or between administration of a drug and a placebo.

\textbf{Example (leptin)}

Leptin is an adipose tissue hormone that creates the sensation of satiety after eating. We want to study the serum leptin levels in obese children \href{https://pubmed.ncbi.nlm.nih.gov/18755049/}{(PMID: 18755049)} under different conditions, such as sex. We therefore assume two conditions: \(A:female\) and \(B:male\) and that

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  the level of leptin in a randomly chosen girl has a probability density
\end{enumerate}

\[Y_A \rightarrow N(\mu_A, \sigma_A^2)\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  the level in a boy has a probability density
\end{enumerate}

\[Y_B \rightarrow N(\mu_B, \sigma_B^2)\]

\hypertarget{data-1}{%
\section{Data}\label{data-1}}

One random experiment has two variables: \((y, c)\).

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \(Y\) a continuous variable, which is the outcome of interest
\item
  \(c \in \{A,B\}\) is a discrete variable with two possible outcomes.
\end{enumerate}

The repetition of the random experiment \(n\) times is therefore a table such as

\begin{longtable}[]{@{}ccc@{}}
\toprule\noalign{}
\(subject\) & \(Y\) & \(C\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(1\) & \(1.2\) & \(A\) \\
\(2\) & \(0.9\) & \(A\) \\
\ldots{} & \ldots{} & \ldots{} \\
\(n\) & \(1.4\) & \(B\) \\
\end{longtable}

\textbf{Example (leptin)}

In the leptin example, we have that the continuous outcome is the level of leptin in a subject

\begin{itemize}
\tightlist
\item
  \(leptin \in (0, 200)\)
\end{itemize}

And that the condition is the sex of the subject:

\begin{itemize}
\tightlist
\item
  \(sex \in \{girl:A,boy:B\}\)
\end{itemize}

\(190\) girls were tested for the level of leptin, while \(166\) boys were included in the studied. The first six subjects of the studied were

\begin{verbatim}
##     leptin  sex
## 1 32.81111 girl
## 2 41.76219 girl
## 3 90.24100 girl
## 4 49.91078 girl
## 5 51.50370 girl
## 6 94.47826 girl
\end{verbatim}

While the last subjects were

\begin{verbatim}
##        leptin sex
## 351  57.13473 boy
## 352 -10.23757 boy
## 353  24.82894 boy
## 354  37.01268 boy
## 355  14.39215 boy
## 356  41.87943 boy
\end{verbatim}

We want to know whether boys have different levels of leptin than girls. In other words, if the mean levels of leptin between sexes is different.

\textbf{Research question:} is \(Leptin\) statistically independent from \(Sex\)?

\hypertarget{difference-between-means}{%
\section{Difference between means}\label{difference-between-means}}

We took leptin levels \textbf{conditioned to} each sex, and observed:

\begin{itemize}
\item
  \(n_A=190\) girls had a mean of \(\bar{y}_A=48.13\) and \(s= 25.44\)
\item
  \(n_B=166\) boys has a mean of \(\bar{y}_B=35.42\) and \(s=21.99\)
\end{itemize}

Barplots are popular, although they do not show the spread of the data

\includegraphics{_main_files/figure-latex/unnamed-chunk-125-1.pdf}

We can draw histograms of leptin for each group to have a better idea of the distributions

\includegraphics{_main_files/figure-latex/unnamed-chunk-126-1.pdf}

Or we can overlay the histograms horizontally

\includegraphics{_main_files/figure-latex/unnamed-chunk-127-1.pdf}

The plots suggest that boys have lower levels of leptin but is the difference between the averages \(\bar{y}_A\) and \(\bar{y}_B\) \textbf{statistically significant}? How confident are we on the magnitude of the difference? That is, could have we got this lower levels of lepting in boys by chance alone (null hypothesis) or there is difference that cannot be fully explained by chance (alternative hypothesis)?

\hypertarget{hypothesis-test}{%
\section{hypothesis test}\label{hypothesis-test}}

Let us formulate the hypothesis contrast

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\item
  \(H_0: \mu_A=\mu_B\) The null hypothesis (status quo) assumes that both sexes have the same mean.
\item
  \(H_1: \mu_A \neq \mu_B\) The alternative hypothesis (research interest) is that they are different.
\end{enumerate}

If \(\delta\), the difference between means \(\delta=\mu_A-\mu_B=0\) then the hypothesis can be written as

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0: \delta=0\)
\item
  \(H_1: \delta\neq 0\)
\end{enumerate}

\(\delta\) is the \textbf{parameter of interest} in our study, and to test hypotheses on it, we need to find an \textbf{estimator} for it.

\hypertarget{estiamtor-of-the-mean-difference}{%
\section{Estiamtor of the mean difference}\label{estiamtor-of-the-mean-difference}}

The statistic \(D=\bar{Y}_A-\bar{Y}_B\), that is the difference in averages, is an estimator of \(\delta\). In particular, we can show that the the estimator is

\begin{itemize}
\tightlist
\item
  unbiased because its expected value is the parameter
\end{itemize}

\[E(D)=E(\bar{Y}_A-\bar{Y}_B)=\mu_A-\mu_B=\delta\]

\begin{itemize}
\tightlist
\item
  and consistent because its variance gets smaller when \(n=n_A+n_B\) gets bigger
\end{itemize}

\[V(D)=V(\bar{Y}_A-\bar{Y}_B)=\frac{\sigma^2_A}{n_A}+\frac{\sigma^2_B}{n_B}\]

This means that we can take one observed value of \(D\), that is \(d_{obs}\), for the estimation of the parameter \(\delta\).

It is important to have clear the different components in the the estimation and the hipothesis test

\includegraphics{_main_files/figure-latex/unnamed-chunk-128-1.pdf}

\hypertarget{standardized-error}{%
\section{Standardized error}\label{standardized-error}}

As both \(Y_A\) and \(Y_B\) are normal and independent variables, their averages are normal and so it is their difference

\[Z=\frac{D-\delta}{\sqrt{V(D)}}=\frac{\bar{Y}_A-\bar{Y}_B -\delta}{\sqrt{\frac{s^2_A}{n_A}+\frac{s^2_B}{n_B}}} \rightarrow_{approx} N(0,1)\]

is approximately a normal standard variable when both \(n_A\) and \(n_B\) are large. It is approximate because as we do not know the variances \(\sigma^2_A\) and \(\sigma^2_B\) we can estimated them with \(s_A^2\) and \(s_B^2\). We can also use this approximation when we do not know the distributions of \(Y_A\) and \(Y_B\), as a result of the central limit theorem.

\hypertarget{standardized-error-for-the-null}{%
\section{Standardized error for the null}\label{standardized-error-for-the-null}}

If the null hypothesis is true (\(\delta=0\)), then when we estimate \(\delta\) with \(D\) we make an error. The \textbf{standardized error} from the null hypothesis is the statistic

\[Z=\frac{\bar{Y}_A-\bar{Y}_B}{\sqrt{\frac{s_A^2}{n_A}+\frac{s^2_B}{n_B}}}\]
that follows a standard normal distribution.

To test the hypothesis we then ask if the observed \(z_{obs}\) is within the acceptance region of the null hypothesis.

In particular, we ask: is the probability of observing a more extreme value than \(z_{obs}\) lower than \(\alpha=0.05\)?

The value of \(z_{obs}\) is the standardized value of the observed difference between the averages:

\[z_{obs}=\frac{d_{obs}}{\sqrt{\frac{s_A^2}{n_A}+\frac{s^2_B}{n_B}}}\]

For our data, we have that the \textbf{observed} standardized mean difference is

\[z_{obs}=\frac{\bar{y}_A-\bar{y}_B }{\sqrt{\frac{s^2_A}{n_A}+\frac{s^2_B}{n_B}}}=\frac{48.13-34.42}{\sqrt{\frac{647.58}{190}+\frac{483.62}{166}}}=5.053\]

Since our hypothesis is two tailed then the the two-tailed \(pvalue\) is

\[pvalue=2(1-\phi(5.053))=4.32 \times 10^{-7}\]

which is much lower than \(\alpha\).

Therefore, we reject the null hypothesis that \(H_0:\delta=0\) that is that the leptin levels in obese children are equal between boys and girls. In other words, we have strong evidence that the mean leptin levels between sexes are different.

In Python

\begin{verbatim}
import pandas as pd
import math
from scipy.stats import norm

data = pd.read_csv('https://alejandro-isglobal.github.io/SDA/data/leptin_sex.txt', 
sep='\t')

groupA = data[data['sex']=="girl"]['leptin']
groupB = data[data['sex']=="boy"]['leptin']

yA_bar = np.mean(groupA)
yB_bar = np.mean(groupB)

s2A = np.var(groupA, ddof=1)
s2B = np.var(groupB, ddof=1)

d = (yA_bar-yB_bar)/math.sqrt(s2A/len(groupA)+s2B/len(groupB))
pval= 2*(1-norm.cdf(d))

d, pval
\end{verbatim}

\begin{verbatim}
(5.053890638648715, 4.32899547764265e-07)
\end{verbatim}

\textbf{Example (Abstract)}

\emph{Abstract:}

\emph{Obesity rates are different between boys and girls, suggesting that the physiopathology of the disease is different between the sexes.}

\emph{In this study, we tested the hypothesis that the leptin levels in serum are different between boys and girls.}

\emph{We analyzed data from 190 obese girls and 166 obese boys and found a significant difference in leptin between sexes (mean difference \(13.6\), \(P=2.195757 \times 10^{-7}\))}

\includegraphics{_main_files/figure-latex/unnamed-chunk-129-1.pdf}

Note that in a report we usually add the confidence intervals for the means. Non-overlapping confidence intervals also indicate that the difference between means is \textbf{statistically significant} (reject the null).

Another popular way to visualize the distributional differences between the groups is to use a box plot

\includegraphics{_main_files/figure-latex/unnamed-chunk-130-1.pdf}

In this plot, we do not show the means but a summary of the distribution properties of the data at each condition. Remember that the properties are the median (the middle line), the quartiles (the box edges) and the \(5\%\) and \(95\%\) quantiles (the wiskers).

Finally, you would see that violin plots are also widely used. These are boxplots with the (smoothed) mirrowed histograms overlayed. Here, you do not see the everages of each group but the modes (peaks of the hitograms) but you get the idea that the distribution for girls higher than the distribution for boys.

\includegraphics{_main_files/figure-latex/unnamed-chunk-131-1.pdf}

\hypertarget{mean-differences-when-n-is-small}{%
\section{\texorpdfstring{Mean differences when \(n\) is small}{Mean differences when n is small}}\label{mean-differences-when-n-is-small}}

In a study that wanted to test the effect of leptin in neurodevelopment, 7 male mice had their leptin gene knocked out. While 16 mice were left with normal leptin function \href{https://pubmed.ncbi.nlm.nih.gov/30694175/}{(PMID:30694175)}. An initial question was to test the effect of leptin on the body weight of the animals. Is the mean weight of the animals different between wild types and knock-outs?

We assume that

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  the weight of the control animals (wild type) has a probability density
\end{enumerate}

\[Y_A \rightarrow N(\mu_A, \sigma^2)\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  the weight of the animals with no leptin has a probability density
\end{enumerate}

\[Y_B \rightarrow N(\mu_B, \sigma^2)\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  both distributions have the same variance \(\sigma^2\).
\end{enumerate}

\hypertarget{data-2}{%
\section{Data}\label{data-2}}

One random experiment in this study has two outcomes: \((weight, leptin)\).

Continuous variable (outcome of interest)

\begin{itemize}
\tightlist
\item
  \(weigth \in (20, 60)\)
\end{itemize}

Categorical variable:

\begin{itemize}
\tightlist
\item
  \(leptin \in \{control:A,knockout:B\}\)
\end{itemize}

The data looks like

\begin{verbatim}
##    weight    group
## 1   27.67  Control
## 2   27.40  Control
## 3   25.77  Control
## 4   25.60  Control
## 5   25.03  Control
## 6   25.90  Control
## 7   26.67  Control
## 8   25.60  Control
## 9   28.93  Control
## 10  31.83  Control
## 11  25.90  Control
## 12  26.30  Control
## 13  27.90  Control
## 14  26.77  Control
## 15  25.83  Control
## 16  20.87  Control
## 17  46.57 leptinKO
## 18  40.43 leptinKO
## 19  41.97 leptinKO
## 20  41.17 leptinKO
## 21  41.57 leptinKO
## 22  46.17 leptinKO
## 23  53.83 leptinKO
\end{verbatim}

\hypertarget{difference-between-means-1}{%
\section{Difference between means}\label{difference-between-means-1}}

We take mice weights \textbf{conditioned to} each lepting group, and observed:

\begin{itemize}
\item
  \(n_A=16\) control mice had a weight mean of \(\bar{y}_A=26.49\) and \(s_A=2.24\)
\item
  \(n_B=7\) leptin KO mice had a weight mean of \(\bar{y}_B=44.53\) and \(s_B=4.77\)
\end{itemize}

We can draw violin plots per group

\includegraphics{_main_files/figure-latex/unnamed-chunk-133-1.pdf}

We see that the distributions are different and in particular that mice without leptin (leptin KO) have on average higher weights. Can we have a statistical test for this difference?

\hypertarget{hypothesis-test-1}{%
\section{hypothesis test}\label{hypothesis-test-1}}

We can again formulate the hypothesis on the difference between means \(\delta=\mu_{control} -\mu_{leptin}\)

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\item
  \(H_0: \delta=0\). The null hypothesis (status quo) assumes that both mice (control, leptin KO) have the same mean weight.
\item
  \(H_1: \delta \neq 0\). Therefore, the alternative hypothesis is that the mean weigth is different between groups.
\end{enumerate}

\hypertarget{estimator-of-the-mean-difference}{%
\section{Estimator of the mean difference}\label{estimator-of-the-mean-difference}}

The statistic \(D=\bar{Y}_A-\bar{Y}_B\) is again an unbiased estimator of \(\delta\)

\[E(D)=\delta\]

Since the weights for \(A\) and \(B\) are normal variables with the same variance \(\sigma^2\) each sample variance in each group is an estimator of \(\sigma^2\). That is \[\hat{\sigma}^2=s^2_A=s^2_B\]

then (Theorem) the \textbf{standardized error}

\[T=\frac{\bar{Y}_A-\bar{Y}_B -\delta}{\sqrt{s_p^2(\frac{1}{n_A}+\frac{1}{n_B})}} \rightarrow T(n_A+n_B-2)\]

follows exactly a T-distribution with \(n_A+n_B-2\) degrees of freedom.

The \textbf{pooled variance} \(s_p^2\), is an estimator of \(\sigma^2\)

\[\hat{\sigma}^2=s_p^2= \frac{(n_A-1) s^2_A+(n_B-1) s^2_B}{n_A+n_B-2}\]

\hypertarget{standardized-error-for-the-null-1}{%
\section{Standardized error for the null}\label{standardized-error-for-the-null-1}}

If the null hypothesis is true (\(\delta=0\)), then when we estimate \(\delta\) with \(D\) we make an error. The \textbf{standardized error} from the null hypothesis is the statistic

\[T=\frac{\bar{Y}_A-\bar{Y}_B }{\sqrt{s_p^2(\frac{1}{n_A}+\frac{1}{n_B})}} \rightarrow T(n_A+n_B-2)\]

that follows a T-distribution.

To test the hypothesis we then ask if the observed \(t_{obs}\) within the acceptance region of the null hypothesis.

In particular, we ask: is the probability of observing a more extreme value than \(t_{obs}\) lower than \(\alpha=0.05\)?

The value of \(t_{obs}\) is the standardized value of the observed difference between the averages:

\(t_{obs}=\frac{d_{obs}}{\sqrt{s_p^2(\frac{1}{n_A}+\frac{1}{n_B})}}\)

\[=\frac{\bar{y}_A-\bar{y}_B }{\sqrt{\frac{s^2_p}{n_A}+\frac{s^2_p}{n_B}}}=\frac{26.49-44.53}{\sqrt{\frac{10.12}{16}+\frac{10.12}{7}}}=-12.508\]

The two-tailed \(pvalue\) of \(t_{obs}\) is

\[pvalue=2(1-F_{t,21}(12.508))=3.37 \times 10^{-11}\]

which is lower than \(\alpha=0.05\).

Therefore, the data shows a very significant increase in \(18.03\)gr (\(P=3.376854 \times 10^{-11}\)) in weight between the wild-type mice and leptin knockouts. ``Absence of leptin signaling in early life alters the energy balance and predisposes the animals to obesity''

in Python

\begin{verbatim}
import numpy as np
from scipy import stats

data = pd.read_csv('https://alejandro-isglobal.github.io/SDA/data/leptin.txt', 
sep='\t')

groupA = data["Control"]
groupB = data["LepNull"]

stats.ttest_ind(groupA, groupB, equal_var=True, nan_policy='omit')
\end{verbatim}

\begin{verbatim}
Ttest_indResult(statistic=-12.507930602554847, pvalue=3.377211689857233e-11)
\end{verbatim}

\hypertarget{unequal-variances}{%
\section{Unequal variances}\label{unequal-variances}}

The box plot suggests that the variances for each group are different because the box for the control group is thinner than the box for the leptin KO group. Therefore is better to assume that

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  the weight of the control animals (wild type) has a probability density
\end{enumerate}

\[Y_A \rightarrow N(\mu_A, \sigma_A^2)\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  the weight of the animals with no leptin has a probability density
\end{enumerate}

\[Y_B \rightarrow N(\mu_B, \sigma_B^2)\]

The \textbf{standardized error} for the null hypothesis (\(\delta=0\))

\[T=\frac{\bar{Y}_A-\bar{Y}_B }{\sqrt{\frac{s_A^2}{n_A}+\frac{s_B^2}{n_B}}} \rightarrow_{aprox} T(\nu)\]
approximately follows a t-distribution with
\[\nu=\frac{(\frac{s_A^2}{n_A}+\frac{s_B^2}{n_B})^2}{\frac{(s_A^2/n_B)^2}{n_A-1}+\frac{(s_B^2/n_B)^2}{n_B-1}}\]
degrees of freedom.

In Python

\begin{verbatim}
import numpy as np
from scipy import stats

data = pd.read_csv('https://alejandro-isglobal.github.io/SDA/data/leptin.txt', 
sep='\t')

groupA = data["Control"]
groupB = data["LepNull"]

stats.ttest_ind(groupA, groupB, equal_var=False, nan_policy='omit')
\end{verbatim}

\begin{verbatim}
Ttest_indResult(statistic=-9.541047987836473, pvalue=2.4443518964606636e-05)
\end{verbatim}

Therefore, the data \textbf{still} shows a very significant increase in \(18.03\)gr (\(P=2.444 \times 10^{-5}\)) in weight between the wild-type mice and leptin knockouts (under a more appropriate test).

\includegraphics{_main_files/figure-latex/unnamed-chunk-134-1.pdf}

\hypertarget{questions-12}{%
\section{Questions}\label{questions-12}}

\textbf{1)} We test for the difference between the means of two random variables when we have measured

\textbf{\(\qquad\)a:} two continuous random variables;
\textbf{\(\qquad\)b:} two categorical random variables;
\textbf{\(\qquad\)c:} one dichotomic variable and one continuous random variable;
\textbf{\(\qquad\)d:} any categorical variable and one continuous random variable;

\textbf{2)} The statistic \(D=\bar{Y}_A-\bar{Y}_B\) estimates

\textbf{\(\qquad\)a:} The difference between the averages of \(Y_A\) and \(Y_B\);
\textbf{\(\qquad\)b:} The difference between the means of \(Y_A\) and \(Y_B\);
\textbf{\(\qquad\)c:} The variation of \(\bar{Y}_A\) with respect to \(\bar{Y}_B\);
\textbf{\(\qquad\)d:} \(d_{obs}\)

\textbf{3)} We can use a \(Z\)-test only when

\textbf{\(\qquad\)a:} we have a large sample of the continuous variable in one of the conditions;
\textbf{\(\qquad\)b:} we have large samples of the continuous variable in each condition;
\textbf{\(\qquad\)c:} the variances of the continuous variable are equal in each conditions;
\textbf{\(\qquad\)d:} when the distributions of the continuous variable in each condition are normal

\textbf{4)} We can use a \(t\)-test only when

\textbf{\(\qquad\)a:} we have small samples of the continuous variable in
each condition;
\textbf{\(\qquad\)b:} the distributions of the continuous variable in each condition are normal;
\textbf{\(\qquad\)c:} \(D\) is unbiased;
\textbf{\(\qquad\)d:} we cannot use a \(Z\)-test

\textbf{5)} For the data

\begin{longtable}[]{@{}ccc@{}}
\toprule\noalign{}
\(subject\) & \(Y\) & \(C\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(1\) & \(1.1\) & \(A\) \\
\(2\) & \(0.9\) & \(A\) \\
\(3\) & \(0.8\) & \(B\) \\
\(4\) & \(0.6\) & \(B\) \\
\end{longtable}

assuming that \(Y\) is normally distributed, which is the best test?

\textbf{\(\qquad\)a:} \(t\)-test with equal variances
\textbf{\(\qquad\)b:} \(t\)-test with unequal variances
\textbf{\(\qquad\)c:} \(z\)-test with equal variances
\textbf{\(\qquad\)d:} \(z\)-test with unequal variances

\hypertarget{practice-6}{%
\section{Practice}\label{practice-6}}

Load leptin data \url{https://alejandro-isglobal.github.io/SDA/data/dataleptin.txt}

\begin{itemize}
\item
  Test the hypothesis that in the control animals, the weight of females is different than the weight of males
\item
  Test the hypothesis that the leptin KO animals have higher weight than the KO animals with supplemented leptin
\item
  Make a bar plot and a boxplot for the latter case. Compute the confidence intervals for the weight, in each group.
\end{itemize}

\hypertarget{mean-differences-across-several-groups}{%
\chapter{Mean differences across several groups}\label{mean-differences-across-several-groups}}

\hypertarget{objective-12}{%
\section{Objective}\label{objective-12}}

In this chapter, we will generalize the test for difference between means across many groups. That is many levels of a categorical variables. We will do this by using the analysis of variance (ANOVA) that compares the variance within the groups and the variance between the groups.

We will see that ANOVA can be further used to describe the mean of a continuous variable across two different categorical variables with many levels each. This is called a 2-way ANOVA.

Finally we will use the ANOVA to test that at least one combination of the two categorical variables can not be explained by the independent contributions of each condition. This is called a 2-way ANOVA plus interaction.

\hypertarget{different-means-across-several-conditions}{%
\section{Different means across several conditions}\label{different-means-across-several-conditions}}

In a study that wanted to test the effect of leptin in neurodevelopment, 7 male mice had their leptin gene knocked out. Whereas, 16 mice were left with normal leptin function. In a third group, 10 mice with knocked out leptin were injected leptin protein \href{https://pubmed.ncbi.nlm.nih.gov/30694175/}{(PMID:30694175)}. An initial question was to test the effect of the leptin group on the body weight of the animals. We therefore aassume three conditions and that

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  the weight of the control animals (wild type) has a probability density
\end{enumerate}

\[Y_A \rightarrow N(\mu_A, \sigma^2)\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  the weight of the animals with no leptin gene (KO) but were injected leptin protein has a probability density
\end{enumerate}

\[Y_B \rightarrow N(\mu_B, \sigma^2)\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  the weight of the animals with no leptin gene (KO) has a probability density
\end{enumerate}

\[Y_C \rightarrow N(\mu_C, \sigma^2)\]

\hypertarget{data-3}{%
\section{Data}\label{data-3}}

One random experiment has two outcomes: \((weight, leptin)\).

Continuous variable (outcome of interest)

\begin{itemize}
\tightlist
\item
  \(weight \in (20, 60)\)
\end{itemize}

Categorical variable has three conditions (levels)

\begin{itemize}
\tightlist
\item
  \(leptin \in \{control:A,KOplus:B, leptinKO:C\}\)
\end{itemize}

The data looks like

\begin{verbatim}
##    weight    group
## 1   27.67  Control
## 2   27.40  Control
## 3   25.77  Control
## 4   25.60  Control
## 5   25.03  Control
## 6   25.90  Control
## 7   26.67  Control
## 8   25.60  Control
## 9   28.93  Control
## 10  31.83  Control
## 11  25.90  Control
## 12  26.30  Control
## 13  27.90  Control
## 14  26.77  Control
## 15  25.83  Control
## 16  20.87  Control
## 17  46.57 leptinKO
## 18  40.43 leptinKO
## 19  41.97 leptinKO
## 20  41.17 leptinKO
## 21  41.57 leptinKO
## 22  46.17 leptinKO
## 23  53.83 leptinKO
## 24  24.33   KOplus
## 25  22.37   KOplus
## 26  26.10   KOplus
## 27  17.50   KOplus
## 28  35.17   KOplus
## 29  25.97   KOplus
## 30  27.67   KOplus
## 31  23.37   KOplus
## 32  31.83   KOplus
## 33  22.37   KOplus
\end{verbatim}

\hypertarget{difference-between-means-2}{%
\section{Difference between means}\label{difference-between-means-2}}

We take weights \textbf{conditioned to} each leptin group, and observed:

\begin{itemize}
\item
  \(n_A=16\) control mice had a weight mean of \(\bar{y}_A=26.49813\) and \(s_A=2.247577\)
\item
  \(n_B=10\) leptin KO mice with leptin replacement had a weight mean of \(\bar{y}_B=25.668\) and \(s_B=5.034161\)
\item
  \(n_C=7\) leptin KO mice had a weight mean of \(\bar{y}_C=44.53\) and \(s_C=4.774167\)
\end{itemize}

We can draw a barplot for each mean with a confidence interval

\includegraphics{_main_files/figure-latex/unnamed-chunk-136-1.pdf}

and we see that the wild type (control) has a similar mean weight to the mice without the leptin gene but which have been injected leptin (KOplus). The mice without leptin gene and no leptin protein (leptinKO) have mean higher mean weight. As the confidence intervals for this group does not overlap with the other two, we say that the mean of the knock outs is singificanlty higher than for the other two cases.

We can see the differences in distributions with a violin plot

\includegraphics{_main_files/figure-latex/unnamed-chunk-137-1.pdf}

When we test for the difference in means between \textbf{two groups}, we test in null hypothesis if the means are equal. When we consider more than two groups, we ask if \textbf{at least one} of the means is different.

\hypertarget{hypothesis-test-2}{%
\section{hypothesis test}\label{hypothesis-test-2}}

Let us formulate the hypothesis contrast

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\item
  \(H_0: \mu_A=\mu_B=\mu_C\) The null hypothesis (status quo) assumes that there are no differences between group means.
\item
  \(H_1\): at least one mean \(\mu_i\)is different from the rest (research interest).
\end{enumerate}

How can we test this hypothesis? Is there a statistic that we can formulate such that its value give us information on whether we should accept or reject \(H_0\)?

Let's look at the dispersion of \textbf{all the data points} at wach group.
Within each group the data disperses about their averages. Therefore an estimator of the variance for each group. For example for group \(A\) the sample variance

\[S_A^2=\frac{1}{n-1} \sum_{i=1}^n (Y_{Ai}-\bar{Y}_{A})^2\]

is an estimator of the variance \(\sigma^2\) of the weights at group \(A\). \(n\) is the number of observations made in group \(A\). Since we are assuming that in all groups the data disperses with the same variance \(\sigma^2\) then the average of the sample variances

\[Se^2 = \frac{1}{3}(S_A^2+S_B^2+S_C^2)\]

is another estimator of the variance \(\sigma^2\) that takes into account the estimators at each group. \(S_e^2\) is called the \textbf{mean square error}.

\includegraphics{_main_files/figure-latex/unnamed-chunk-138-1.pdf}

Let's now look at the dispersion of \textbf{averages} of each group, instead. That is the right part of the plot above (\(Y\_bar\) tag), where we look at how the averages disperse about the overall mean of the data. We know, for instance, that \(\bar{Y}_A\) is normal with mean \(\mu_A\) and variance \(\frac{\sigma^2}{n}\).

If the \textbf{null hypothesis is true} there are no differences between the means and then

\[\mu_A=\mu_B=\mu_C=\mu\]
Therefore \(\bar{Y}_A, \bar{Y}_B, \bar{Y}_C \rightarrow N(\mu, \sigma^2/n)\) and \((\bar{y}_A, \bar{y}_B, \bar{y}_C )\) is the observed sample of size \(k=3\) of the same random experiment: one that takes averages on the weights of animals in groups that are identical between each other (no differences between grups). In that case, the sample variance

\[S^2_{tr}=\frac{1}{k-1} \sum_{j=1}^k(\bar{Y}_{j}-\bar{Y})^2\]

estimates the sample maen variance \(\sigma^2/n\). \(j\) indicates the groups (\(A\), \(B\), \(C\)) and \(\bar{Y}\) is the average of the averages or put simply: the mean of all observations (the black dot in the figure) \[\bar{Y}=\frac{1}{nk}\sum_j \sum_i Y_{ji}\]

If the null \textbf{hypothesis is true} and we take more and more observations in each group then all the averages get closer to the grand mean, and the grand mean gets closer to \(\mu\). Since \(S_{tr}^2\) estimates \(\sigma^2/n\) and \(S_e^2\) estimates \(\sigma^2\) then the ratio

\[F=\frac{n S_{tr}^2}{S_e^2}\]
is a statistic that is close to \(1\), when \(H_0\) is true.

If the null \textbf{hypothesis is not true} and we take more and more observations in each group then at least one average will not get close to the other averages, for instance \(\mu_A=\mu_B=\mu \neq \mu_C\). Therefore the expected value of \(nS^2_{tr}\) will not get close to \(\sigma^2\), as there is an irreducible variance given by the group that is different, for instance group \(C\). We also say that there is an additional variance in the data given by the treatment. In this case the statistic

\[F=\frac{n S_{tr}^2}{S_e^2}=\frac{MST}{MSE}\]

will be greater than 1 with high probability. The numerator \(MST\) is called the mean sum of squares of treatments (groups) and the denominator \(MSE\) is the sum of squares of errors (residuals). Since the variables within each group are considered normal, the variance estimators follow \(\chi^2\) distributions with their respective degrees of freedom, and the ratio \(F\) follows an (\(F\)) Fisher distribution with \(k-1\) and \(kn-1)\) degrees of freedom

\[F \rightarrow Fisher(k-1, k(n-1))\]

where \(k\) is the number of groups and \(n\) is the average number of observations per group.

\hypertarget{analysis-of-variance-anova}{%
\section{Analysis of variance (ANOVA)}\label{analysis-of-variance-anova}}

The hypothesis test for the difference in means across several groups is then

\begin{itemize}
\tightlist
\item
  \(H_0: \mu_1=\mu_2, ...=\mu_k\) There are no difference between group means
\end{itemize}

Then, the observed value of \(F\), \emph{e.g} \(f_{obs}\) will be near \(1\).

\begin{itemize}
\tightlist
\item
  \(H_1\) at least one \(\mu_i\) is different
\end{itemize}

Then, the observed value of \(F\), \emph{e.g} \(f_{obs}\) will be \textbf{greater} than \(1\).

\textbf{Example (mice knockouts)}

The value of the \(f_{obs}\) computes from the group (treatments) mean and residual (error) mean squares can be calculated in statistical software that usually output the ANOVA table

\begin{verbatim}
import pandas as pd
import statsmodels.api as sm
from statsmodels.formula.api import ols

data = pd.read_csv('https://alejandro-isglobal.github.io/SDA/data/dataleptin.txt', 
sep=' ')

filtsex = data['sex']=='M'
filtered_data = data[filtsex]

model = ols('weight ~ group', data=filtered_data).fit()

anova_table = sm.stats.anova_lm(model, typ=1)

print(anova_table)
\end{verbatim}

\begin{verbatim}
            df       sum_sq     mean_sq          F        PR(>F)
group      2.0  1861.549820  930.774910  63.373347  1.693725e-11
Residual  30.0   440.615004   14.687167        NaN           NaN
\end{verbatim}

In this table \(MST\) is the Mean squares for the group, computed as the Sum of squares divided by the degrees of freedom (\(k-1=2\)).

\[MST=\frac{1}{k-1}SSq_{group}=930.77\]
\(MST\) is the Mean squares for the group, computed as the Sum of squares divided by the degrees on freedom (\(k(n-1)=30\)), where \(n=(16 + 7 + 10)/3=11\) is the mean number of observations in each group

\[MSE=\frac{1}{k(n-1)}SSq_{Residual}=14.69\]

The observed value of the statistics is

\[f_{obs}=\frac{MST}{MSE}=63.373\]

To test the the null hypothesis we then compute the probability that in a future experiment we observe a higher value than \(63.373\): \(P(F>63.373)\). This probability is the \textbf{upper tailed p-value}

\[pvalue=1-F_{Fisher,2,30}(63.373)=1.694 \times 10^{-11}\]

which is much lower than \(\alpha=0.05\), suggesting significant differences in at least one group mean. Therefore we reject the null hypothesis and accept that at least one of the groups has a different mean from the rest.

\emph{Conclusion:}

\emph{We observed a significant difference between groups (ANOVA test \(F(2,30)=63.373, P= 1.69 \times 10^{-11}\)), due to the higher gain in weight of the knockout mice. Note that knocked-out mice with replacement recovered wild-type weight (t-test difference between means \(-0.83\), \(P=0.63\))}

\hypertarget{anova-for-two-groups}{%
\section{ANOVA for two groups}\label{anova-for-two-groups}}

We can explicitly compute the observed value of \(F\) when we have only two groups:

\[f_{obs}=\frac{n(\bar{y}_{A}-\bar{y}_{B})^2}{s^2_p}\]
where \(s^2p\) is the pooled variance:
\[s^2_p= \frac{s_A^2 + s_B^2}{{2}}\]
taking the square root of \(f_{obs}\) and rearranging we find

\[t_{obs}=\sqrt{f_{obs}}=\frac{(\bar{y}_{A}-\bar{y}_{B})}{\frac{s_p}{\sqrt{n}}}\]
and thus recover the t-test for the difference between two groups.

\textbf{Example (wild type and knockout mice)}

When we compared the weights between wild types (group A) and knock out mice (group C), we performed a t-test. The observed statistic was

\[t_{obs}=\frac{\bar{y}_A-\bar{y}_B }{\sqrt{\frac{s^2_p}{n_A}+\frac{s^2_p}{n_B}}}=\frac{26.49813-44.53}{\sqrt{\frac{3.18127^2}{16}+\frac{3.18127^2}{7}}}=-12.508\]

Therefore the observed \(F\) is

\[f_{obs}=t_{obs}^2=(−12.508)^2=156.45\]
The upper tailed p-value for \(f_{obs}\) using the Fisher distribution is

\[pvalue=1-F_{Fisher,1,21}(156.45)=3.377 \times 10^{-11}\] with \(k=2\) and \(n=11.5\) is the average number of observations per group.

in R: 1-pf(156.45, 1,21)

\includegraphics{_main_files/figure-latex/unnamed-chunk-139-1.pdf}

This p-value is exactly the same as the one we obtained with the t-test with equal variances. Therefore, we reject the hypothesis that the weights between wild types and leptin knock outs are the same.

We can check the ANOVA table

\begin{verbatim}
## Analysis of Variance Table
## 
## Response: weight
##           Df  Sum Sq Mean Sq F value    Pr(>F)    
## group      1 1583.33 1583.33  156.45 3.377e-11 ***
## Residuals 21  212.53   10.12                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{verbatim}
import pandas as pd
import statsmodels.api as sm
from statsmodels.formula.api import ols

data = pd.read_csv('https://alejandro-isglobal.github.io/SDA/data/dataleptin.txt', 
sep=' ')

filtsex = data['sex']=='M'
filtgroups = (data['group']=='Control') | (data['group']=='leptinKO')

filtered_data = data[filtsex & filtgroups]

model = ols('weight ~ group', data=filtered_data).fit()

anova_table = sm.stats.anova_lm(model, typ=1)

print(anova_table)
\end{verbatim}

\begin{verbatim}
            df       sum_sq      mean_sq           F        PR(>F)
group      1.0  1583.331904  1583.331904  156.448328  3.377212e-11
Residual  21.0   212.530044    10.120478         NaN           NaN
\end{verbatim}

and compare it with the t-test

\begin{verbatim}
import numpy as np
from scipy import stats

data = pd.read_csv('https://alejandro-isglobal.github.io/SDA/data/leptin.txt', 
sep='\t')

groupA = data["Control"]
groupB = data["LepNull"]

stats.ttest_ind(groupA, groupB, equal_var=True, nan_policy='omit')
\end{verbatim}

\begin{verbatim}
Ttest_indResult(statistic=-12.507930602554847, pvalue=3.377211689857233e-11)
\end{verbatim}

\hypertarget{linear-model}{%
\section{Linear model}\label{linear-model}}

The following formulation is useful to integrate the different types of analysis. Let's classify the observations of the random variable \(Y\) by the the group \(j\) and the particular observation \(i\). Let's assume that we can separate the \textbf{random error}

\[Y_{ji} = \mu + \alpha_j +E_{ji}\]

\begin{itemize}
\tightlist
\item
  \(E_{ji}\) is new \textbf{random variable} with expected value \(E(E_{ji})=0\) and variance \(V(E_{ji})=\sigma^2\)
\end{itemize}

\textbf{Fixed parameters}:

\begin{itemize}
\tightlist
\item
  \(\mu\) is the overall mean
\item
  \(\alpha_j\) is the deviation of group \(j\) to the overall mean: \(j \in (A,B, C, ...)\) and \(\alpha_A=\mu_A-\mu\), \(\alpha_B=\mu_B-\mu\), \ldots.
\end{itemize}

\textbf{Random error within each group}:

Then the expected value of \(Y\) in the group \(j\) is

\[E(Y| j)=\mu_j=\mu + \alpha_j\]

and the variance of \(Y\) in the group \(j\) is

\[V(Y| j)=\sigma^2\]

\textbf{Hypothesis contrast}

In this formulation the hypothesis contrast can be simply written as

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\item
  \(H_0:\alpha_j=0\) for all \(j\). There are no difference between the group means and the overall mean \(\mu\).
\item
  \(H_1:\alpha_j\neq0\) for at least one \(j\). There is at least one group whose mean in different from the overall mean \(\mu\).
\end{enumerate}

This in only a formulation, as we again use the \(F\) statistics to decide between the two hypothesis.

\hypertarget{way-anova}{%
\section{2-way ANOVA}\label{way-anova}}

The ANOVA approach allows for the analysis of the joint effect of \textbf{two} or more different factors each with different groups.

Let us include an additional factor given by the sex of the mice and ask: Is there an effect of sex when leptin groups are taken into account?

Here there are two simultaneous questions:

\begin{itemize}
\item
  Is there an effect of \textbf{sex} on the weight of the mice?
\item
  Is that effect different between leptin groups?
\end{itemize}

\hypertarget{data-4}{%
\section{Data}\label{data-4}}

We will introduce an additional outcome. One random experiment has three outcomes: \((weight, leptin, sex)\).

Continuous variable (outcome of interest)

\begin{itemize}
\tightlist
\item
  \(weight \in (20, 60)\)
\end{itemize}

Categorical variable:

\begin{itemize}
\tightlist
\item
  \(leptin \in \{KOplus:A,knockout:B\}\)
\end{itemize}

Categorical variable:

\begin{itemize}
\tightlist
\item
  \(sex \in \{male:a,female:b\}\)
\end{itemize}

The data looks like

\begin{verbatim}
##    weight    group sex
## 17  46.57 leptinKO   M
## 18  40.43 leptinKO   M
## 19  41.97 leptinKO   M
## 20  41.17 leptinKO   M
## 21  41.57 leptinKO   M
## 22  46.17 leptinKO   M
## 23  53.83 leptinKO   M
## 24  24.33   KOplus   M
## 25  22.37   KOplus   M
## 26  26.10   KOplus   M
## 27  17.50   KOplus   M
## 28  35.17   KOplus   M
## 29  25.97   KOplus   M
## 30  27.67   KOplus   M
## 31  23.37   KOplus   M
## 32  31.83   KOplus   M
## 33  22.37   KOplus   M
## 58  65.80 leptinKO   F
## 59  51.40 leptinKO   F
## 60  54.60 leptinKO   F
## 61  48.30 leptinKO   F
## 62  50.60 leptinKO   F
## 63  48.90 leptinKO   F
## 64  51.20 leptinKO   F
## 65  46.80 leptinKO   F
## 66  50.90 leptinKO   F
## 67  42.70 leptinKO   F
## 68  28.70   KOplus   F
## 69  25.60   KOplus   F
## 70  26.40   KOplus   F
## 71  22.90   KOplus   F
## 72  30.00   KOplus   F
## 73  29.70   KOplus   F
## 74  26.10   KOplus   F
## 75  21.40   KOplus   F
## 76  29.50   KOplus   F
## 77  21.90   KOplus   F
## 78  23.70   KOplus   F
## 79  21.00   KOplus   F
\end{verbatim}

\hypertarget{modeling-residuals}{%
\section{Modeling residuals}\label{modeling-residuals}}

We see that there is no effect of sex when the leptin groups are ignored. No significant differences in means between sexes is observed

\begin{verbatim}
import pandas as pd
import statsmodels.api as sm
from statsmodels.formula.api import ols


data = pd.read_csv('https://alejandro-isglobal.github.io/SDA/data/dataleptin.txt', 
sep=' ')

filtgroups = (data['group']=='leptinKO') | (data['group']=='KOplus')

filtered_data = data[filtgroups]

model = ols('weight ~ sex', data=filtered_data).fit()

anova_table = sm.stats.anova_lm(model, typ=1)

print(anova_table)
\end{verbatim}

\begin{verbatim}
            df       sum_sq     mean_sq         F    PR(>F)
sex        1.0   134.975026  134.975026  0.854439  0.361289
Residual  37.0  5844.862933  157.969268       NaN       NaN
\end{verbatim}

\includegraphics{_main_files/figure-latex/unnamed-chunk-142-1.pdf}

We see however that the points are clustered by leptin group, suggesting that we should adjust by the differences in the lepting before we test the differences in sex. It is possible that when we subtract the differences in lepting the mean weight of males is lower than that of females.

The way we subtract the effect of leptin is to perform an ANVOVA of mice weight on lepting group and then to obtain the residuals os each observations. The residuals are the observed values of the error \(E_{ij}\) and are computes as

\[r_{ji}=y_{ji}-\bar{y}_j\]
That is, we subtract the mean of the group \(j\) to each observation \(i\) in leptin group \(j\). In this example we only consider two groups of leptin (KOplus y leptinKO).

Then we can perform another ANOVA test for the residuals on sex differences

\begin{verbatim}
import pandas as pd
import statsmodels.api as sm
from statsmodels.formula.api import ols

data = pd.read_csv('https://alejandro-isglobal.github.io/SDA/data/dataleptin.txt', 
sep=' ')

filtgroups = (data['group']=='leptinKO') | (data['group']=='KOplus')

filtered_data = data[filtgroups]

model1 = sm.OLS.from_formula('weight ~ group', data=filtered_data).fit()

filtered_data["residuals"] = model1.resid

model2 = ols('residuals ~ sex', data=filtered_data).fit()

anova_table = sm.stats.anova_lm(model2, typ=1)

print(anova_table)
\end{verbatim}

\begin{verbatim}
              sum_sq    df         F    PR(>F)
sex        73.938528   1.0  2.955976  0.093917
Residual  925.489697  37.0       NaN       NaN
\end{verbatim}

\includegraphics{_main_files/figure-latex/unnamed-chunk-145-1.pdf}

We see that we have adjusted by the differences in leptin, as the dots are mixed together. The lower weight in males is almost significant for the residuals. However, from this model we do not know the contribution of the leptin group to the variability of the data (points). Also, if \(n\) is large, it is possible that even if the null hypothesis is true, the means of each sex do not get closer to the grand mean if there is a significant effect of leptin.

The data are between explained by the simultaneous and added contributions of sex and leptin group.

\hypertarget{difference-between-means-3}{%
\section{Difference between means}\label{difference-between-means-3}}

\hypertarget{linear-model-1}{%
\section{Linear model}\label{linear-model-1}}

The ANOVA approach allows for the analysis of two factors (each with many groups or levels).

Let's consider the \textbf{linear model}

\[Y_{jri} = \mu + \alpha_j + \beta_r + E_{jri}\]

with \textbf{Random error}:

\begin{itemize}
\tightlist
\item
  \(E_{jri}\) is a \textbf{random variable} with mean \(E(E_{jri})=0\), and variance \(V(E_{jri})=\sigma^2\)
\end{itemize}

and \(k\) groups for factor 1 (leptin).

\begin{itemize}
\tightlist
\item
  \(\alpha_j, j \in\{j...k\}\) such that \(\sum_j \alpha_j=0\) are the deviations of the group means to the the overall mean.
\end{itemize}

\[\mu_{j\cdot}=\mu + \alpha_j\]

and \(m\) groups for factor 2 (sex).

\[\mu_{\cdot r}=\mu + \beta_r\]
The dot indicates that we ignore the other factor.

The model can also be written as

\[Y_{jri} = \mu_{jr} + E_{jri}\]

where \[\mu_{jr} = \mu_{j \cdot} + \mu_{\cdot r} - \mu\] is the mean in the condition given by the groups \((j,r)\) of factors 1 and 2, respectively.

\hypertarget{hypothesis-test-3}{%
\section{Hypothesis test}\label{hypothesis-test-3}}

ANOVA allows testing simultaneously for two hypothesis tests

First

\begin{itemize}
\item
  \(H_0: \alpha_1=\alpha_2, ...=\alpha_k=0\) There are no difference between group means for the fist factor
\item
  \(H_1\) at least one \(\alpha_i\) is different
\end{itemize}

Second

\begin{itemize}
\item
  \(H_0: \beta_1=\beta_2, ...=\beta_m\) There are no difference between group means for the second factor
\item
  \(H_1\) at least one \(\beta_i\) is different
\end{itemize}

\hypertarget{variance-components}{%
\section{Variance components}\label{variance-components}}

To decide between each hypothesis in each hypothesis contrast, we need test statistics. We can again measure the dispersion of the observations from their means in each condition given by both factors. For instance the mean \(\mu_{M,KO}=\mu_{M \cdot} + \mu_{\cdot KO} - \mu\) is estimated by

\[\hat{\mu}_{M,KO}= \bar{Y}_{M \cdot}+\bar{Y}_{\cdot KO} - \bar{Y}\]

and represent the dots in the following plot

\includegraphics{_main_files/figure-latex/unnamed-chunk-146-1.pdf}

The dispersion of the data about this means at condition \((M,KO)\) is given by the statistics

\[S^2_{M,KO}=\frac{1}{n-1}\sum_{i=1}^n (Y_{i,M,KO}-\hat{\mu}_{M,KO})^2\]

If we assume that the variance of the weight in all conditions, given by both factors, is \(\sigma^2\) then we can estimate it with the statistic

\[Se^2= \frac{1}{km}\sum_j \sum_r S^2_{jr}\]
winch is the sum of the depressions across the conditions in both factors.

We can also estimate the variance of the averages in each group of factor 1 about the grand mean

\[S^2_{tr1}=\frac{1}{k-1} \sum_{j=1}^k(\bar{Y}_{j\cdot}-\bar{Y})^2\]
and define the \(F\) statistics

\[F_1=\frac{kmS_{tr1}^2}{S_{e}^2} \rightarrow Fisher(k-1,(kmn-1)-(k-1)-(m-1))\]

that will be close to \(1\) if the first null hypothesis is true: There is no difference between means \(\mu_{j\cdot}\) across the groups of factor 1. In this case the variance of treatments (groups) of factor \(1\) will reduce to zero with large \(n\), because all the means are treatment means of factor 1 are similar to the grand mean (\(\mu_{j\cdot}=\mu\)). If the alternative is true then the treatment means are different and the statistic will be far from \(1\) because the treatment means do not get close to the grand mean (at least one \(\mu_{j\cdot}\neq\mu\)).

We can also define another statistic that test the second hypothesis contrast. For factor 2, we can estimate the dispersion of the means of each group of the factor to the grand mean, using the statistics

\[S^2_{tr2}=\frac{1}{m-1} \sum_{r=1}^m(\bar{Y}_{\cdot r}-\bar{Y})^2\]

and we can define \[F_2=\frac{kmS_{tr2}^2}{S_{e}^2}\rightarrow Fisher(m-1,(kmn-1)-(k-1)-(m-1))\]

Then, observed values of \(F_2\) far from \(1\) suggest that the means between groups of the second factor significantly \textbf{differ}, rejecting the null.

All this is summarized in the two-way ANOVA table

\begin{verbatim}
import pandas as pd
import statsmodels.api as sm
from statsmodels.formula.api import ols

data = pd.read_csv('https://alejandro-isglobal.github.io/SDA/data/dataleptin.txt', 
sep=' ')

filtgroups = (data['group']=='leptinKO') | (data['group']=='KOplus')

filtered_data = data[filtgroups]

model = ols('weight ~ sex + group', data=filtered_data).fit()

anova_table = sm.stats.anova_lm(model, typ=1)

print(anova_table)
\end{verbatim}

\begin{verbatim}
            df       sum_sq      mean_sq           F        PR(>F)
sex        1.0   134.975026   134.975026    5.251072  2.788981e-02
group      1.0  4919.508806  4919.508806  191.388693  5.593450e-16
Residual  36.0   925.354127    25.704281         NaN           NaN
\end{verbatim}

where for example the observed value of \(F_1\) is

\[f_{1obs}=\frac{MST1}{MSE}=\frac{\frac{1}{k-1}SSq_{sex}}{\frac{1}{(kmn-1)-(k-1)-(m-1)}SSq_{Residual}}=5.2511\]

We can see that there is a significant effect of sex when we also take into account the effect of leptin. From the dispersion plot, we see that males seem to have lower weights than females, whether they are in the group with supplemented leptin (KOplus) or with out it (leptinKO).

\hypertarget{way-anova-with-interaction}{%
\section{2-way ANOVA with interaction}\label{way-anova-with-interaction}}

In the previous ANOVA model, we computed the means at each condition \((jr)\) by the contribution of the group \(j\) from factor 1 (sex) and group \(r\) from factor 2 (leptin) to the overall mean

\[\mu_{jr} = \alpha_{j} + \beta_{r} + \mu\]

However, we can see that the distribution of the data about these means is not symmetrical because these are not the means computed within each condition.

When we take weights \textbf{conditioned to} each leptin by sex group we observed:

\begin{itemize}
\item
  \(n_{F,plus}=12\) supplemented leptin \textbf{female} mice had a weight average of \(\bar{y}_{F,plus}=25.575\).
\item
  \(n_{M,plus}=10\) supplemented leptin \textbf{male} mice had a weight average of \(\bar{y}_{M,plus}=25.668\).
\item
  \(n_{F,KO}=10\) control \textbf{female} mice had a weight average of \(\bar{y}_{F,KO}=51.120\).
\item
  \(n_{M,KO}=7\) leptin KO \textbf{male} mice had a weight average of \(\bar{y}_{M,KO}=44.530\).
\end{itemize}

For these estimations we can draw a barplot with confidence intervals.

\includegraphics{_main_files/figure-latex/unnamed-chunk-147-1.pdf}

From this plot we can see that most of the difference between male and female weights comes from the knock out condition. In the supplemented leptin groups sexes seem the have similar weights. How can we test the hypothesis that there is a particular combination of conditions that has an effect on the weight of mice?

The apparent less-than-expected gain in weight of leptin KO males seems like a specific interaction between these two conditions.

\hypertarget{linear-model-2}{%
\section{Linear model}\label{linear-model-2}}

We then formulate the \textbf{linear model} with an \textbf{interaction term} that takes into account the specific contribution of the condition given by the groups \((j,r)\) of each factor

\[Y_{jri} = \mu + \alpha_j + \beta_r + (\alpha\beta)_{jr} + E_{jri}\]

Such that each observation in the condition, given by the groups \((jr)\), has a specific contribution given by the condition

\[E(Y|jr)=\mu + \alpha_j+ \beta_r + (\alpha\beta)_{jr}\]

This is the mean \textbf{conditioned} to the groups \((j,r)\). The condition mean can be computed as the mean given the independent contributions of each group (\(\mu_{jr}\)) plus a specific contribution of the condition \((\alpha\beta)_{jr}\)

\[E(Y|jr)=\mu_{jr}  + (\alpha\beta)_{jr}\]

\hypertarget{hypothesis-test-4}{%
\section{Hypothesis test}\label{hypothesis-test-4}}

This ANOVA model allows testing three null hypothesis

\textbf{First}

\begin{itemize}
\tightlist
\item
  \(H_0: \alpha_1=\alpha_2, ...=\alpha_k=0\). There are no difference between group means in the fist factor
\end{itemize}

\textbf{Second}

\begin{itemize}
\tightlist
\item
  \(H_0: \beta_1=\beta_2, ...=\beta_m=0\). There are no difference between group means in second factor
\end{itemize}

\textbf{Third}

\begin{itemize}
\tightlist
\item
  \(H_0: (\alpha\beta)_{jr}=0\). There is no difference between specific condition means
\end{itemize}

And the alternatives are that at least one of the terms is different from \(0\)

\hypertarget{variance-components-1}{%
\section{Variance components}\label{variance-components-1}}

The first two hypothesis contrasts can be tested as shown in the previous section. To test the first contrast, we define the \(F_1\) statistic that measures the dispersion of the group means of factor 1 with respect the dispersion of the residuals

\[F_1=\frac{MS1}{MSE} \rightarrow Fisher(k-1,(n-1)-(k-1)-(m-1))\]
To test the second contrast, we define the corresponding \(F_2\) statistic for factor 2

\[F_2=\frac{MS2}{MSE} \rightarrow Fisher(m-1,(n-1)-(k-1)-(m-1))\]
Finally, to test the hypothesis contrast for the interaction term, we compute the \(F_I\) statistic given by the dispersion of conditioned means to the grand mean with respect the the dispersion of the residuals

\[F_I=\frac{MSI}{MSE}\rightarrow Fisher((k-1)(m-1),(nkm-1) -(k-1)-(m-1)-(k-1)(m-1))\]

These statistics are given in the ANOVA table with interaction

\begin{verbatim}
## Analysis of Variance Table
## 
## Response: weight
##           Df Sum Sq Mean Sq  F value  Pr(>F)    
## group      1 4980.4  4980.4 212.4335 < 2e-16 ***
## sex        1   74.1    74.1   3.1595 0.08418 .  
## group:sex  1  104.8   104.8   4.4699 0.04169 *  
## Residuals 35  820.6    23.4                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{verbatim}
import pandas as pd
import statsmodels.api as sm
from statsmodels.formula.api import ols

data = pd.read_csv('https://alejandro-isglobal.github.io/SDA/data/dataleptin.txt', 
sep=' ')

filtgroups = (data['group']=='leptinKO') | (data['group']=='KOplus')

filtered_data = data[filtgroups]

model = ols('weight ~ sex*group', data=filtered_data).fit()

anova_table = sm.stats.anova_lm(model, typ=1)

print(anova_table)
\end{verbatim}

\begin{verbatim}
             df       sum_sq      mean_sq           F        PR(>F)
sex         1.0   134.975026   134.975026    5.757201  2.187963e-02
group       1.0  4919.508806  4919.508806  209.835870  2.367238e-16
sex:group   1.0   104.794667   104.794667    4.469893  4.169367e-02
Residual   35.0   820.559460    23.444556         NaN           NaN
\end{verbatim}

As we observed from the barplots, the statistical inference confirms that there are significant differences in weight between leptin groups, significant differences between sexes, and significant interactions between sex and leptin groups. In particular, the effect of leptin knockout in weight is higher in females than males, opposite to what was observed in mice supplemented with leptin protein.

Interactions are better represented in plots displaying the conditioned means across both factors. Significant interactions are therefore given by non-parallel lines.

\includegraphics{_main_files/figure-latex/unnamed-chunk-149-1.pdf}

\hypertarget{questions-13}{%
\section{Questions}\label{questions-13}}

\textbf{1)} We test ANOVA when we have

\textbf{\(\qquad\)a:} several continuous random variables;
\textbf{\(\qquad\)b:} several categorical variables;
\textbf{\(\qquad\)c:} several continuous random variables and several categorical variables;
\textbf{\(\qquad\)d:} a continuous random variable and several categorical outcomes;

\textbf{2)} The statistic \(F=\frac{MST}{MSE}\) is

\textbf{\(\qquad\)a:} the estimation of \(\sigma^2\) by the residuals;
\textbf{\(\qquad\)b:} the estimation of \(\sigma^2\) by the group means;
\textbf{\(\qquad\)c:} the estimation of \(\sigma^2\) by the group means minus by the estimation of \(\sigma^2\) by the residuals;
\textbf{\(\qquad\)d:} the estimation of \(\sigma^2\) by the group means divided by the estimation of \(\sigma^2\) by the residuals

\textbf{3)} We accept the null hypothesis that the groups have equal means when the value of \(F=\frac{MST}{MSE}\) is

\textbf{\(\qquad\)a:} close to 1;
\textbf{\(\qquad\)b:} different from 1;
\textbf{\(\qquad\)c:} small;
\textbf{\(\qquad\)d:} large;

\textbf{4)} ANOVA assumes that the observations in each condition have

\textbf{\(\qquad\)a:} the same mean \(\mu\);
\textbf{\(\qquad\)b:} the same variance \(\sigma^2\);
\textbf{\(\qquad\)c:} different variances;
\textbf{\(\qquad\)d:} different means;

\textbf{5)} The interaction term in a an ANOVA tests that

\textbf{\(\qquad\)a:} the group means of factor 1 are different from the group means of factor 2 ;
\textbf{\(\qquad\)b:} the mean of a group of factor 1 is different from the mean of the other groups of factor 1;
\textbf{\(\qquad\)c:} the means of the groups across both factors are not added contributions of each factor;
\textbf{\(\qquad\)d:} the means of the groups across both factors are different;

\hypertarget{practice-7}{%
\section{Practice}\label{practice-7}}

Load leptin data (
\url{https://alejandro-isglobal.github.io/SDA/data/dataleptin.txt})

\begin{itemize}
\item
  Use a t-test to test the hypothesis that the weight between sexes is different.
\item
  Use an ANOVA to test that the weight between sexes is different.
\item
  Extract residuals from the ANOVA on leptin group and do a second anova on sex.
\item
  Use an ANOVA on sex and group to test the whether sex and leptin groups are significantly associated with weight
\item
  Include an interaction term in the previous ANOVA
\item
  Make a bar plot of weight across all conditions given by both factors
\end{itemize}

\hypertarget{regression-and-correlation}{%
\chapter{Regression and correlation}\label{regression-and-correlation}}

\hypertarget{objective-13}{%
\section{Objective}\label{objective-13}}

In this chapter we will see how to test the statistical independence of two continuous random variables. We will introduce the \textbf{correlation} as a parameter of a 2 dimensional normal distribution. We will perform statistical test on the correlation.

We will also see how to test statistical independence when we consider one of the variables as an outcome (dependent) and another as a condition (independent). We will introduce \textbf{regression analysis} to test the linear dependence between the variables. Finally, we will talk bout multiple regression, when we want to adjust the associations by other variables.

\hypertarget{correlations}{%
\section{Correlations}\label{correlations}}

Leptin is a hormone produced by adipose tissue. We want to study the serum leptin levels in the adult population (\href{https://pubmed.ncbi.nlm.nih.gov/23628382/}{PMID: 23628382}, data available at \href{https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE45987}{GEO:GSE45987}) under a \textbf{continuous} condition, such as the amount in kilograms of body fat. We assume that

\begin{itemize}
\tightlist
\item
  The levels of leptin in blood have a probability density
\end{itemize}

\[Y \rightarrow N(\mu_y, \sigma_y^2)\]

\begin{itemize}
\tightlist
\item
  The levels of fat mass have a probability density
\end{itemize}

\[X \rightarrow N(\mu_x, \sigma_x^2)\]

\hypertarget{data-5}{%
\section{Data}\label{data-5}}

One random experiment in our study has two outcomes: \((leptin, fatmass)\).

Continuous variable (outcome of interest)

\begin{itemize}
\tightlist
\item
  \(lepting \in (0, 5)\)
\end{itemize}

Continuous variable (explanatory variable)

\begin{itemize}
\tightlist
\item
  \(fatmass \in (20,80)\)
\end{itemize}

Repeating the experiment \(n\) times, the data for the first five repetitions look like

\begin{verbatim}
##     leptin fatmass
## 1 3.355677  45.721
## 2 2.272126  43.895
## 3 1.071584  47.871
## 4 3.921082  65.801
## 5 1.536867  56.644
## 6 1.177115  56.355
\end{verbatim}

In this study we are interested in finding out whether individuals with higher fat mass will have higher circulating levels of leptin. In statistical terms we are asking whether fat mass and leptin are statistically independent. How can we test this?

We need to formulate a hypothesis test on a parameter of a distribution.

\hypertarget{normal-bivariate}{%
\section{Normal bivariate}\label{normal-bivariate}}

Let's consider that one random experiment of the study consists on drawing a pair of measurements of both leptin levels \textbf{and} a fat mass of an individual. We therefore have a random variable that its a pair of measurements that follows a probability distribution. We will assume that the distribution is the 2 dimensional version of a normal probability density

\[(Y, X) \rightarrow N(\mu_y, \sigma^2_y, \mu_x, \sigma^2_x, \rho)\]

This is function has five parameters. More explicitly the function is of the form

\[f(y,x)=\frac{1}{2\pi \sigma_y\sigma_x \sqrt{1-\rho^2}}e^{\frac{(y-\mu_y)^2}{\sigma_y^2}-\frac{2\rho(y-\mu_y)(x-\mu_x)}{\sigma_y\sigma_x}+\frac{(x-\mu_x)^2}{\sigma_x^2}}\]

and the parameters are \(\mu_y, \mu_x, \sigma^2_y, \sigma_x^2, \rho\). These are

The marginal mean and variance of \(Y\)

\begin{itemize}
\tightlist
\item
  \(\mu_y=E(Y)\), \(\sigma^2_y=V(Y)\)
\end{itemize}

The marginal mean and variance of \(X\)

\begin{itemize}
\tightlist
\item
  \(\mu_x=E(X)\), \(\sigma^2_x=V(X)\)
\end{itemize}

The \textbf{correlation} between \(X\) and \(Y\)

\begin{itemize}
\tightlist
\item
  \(\rho=\frac{E[(Y-\mu_y)(X-\mu_x)]}{\sigma_y\sigma_x}\)
\end{itemize}

\(\rho\) is called the \textbf{correlation coefficient}.

When we draw the probability density in two dimensions, we see that the marginal densities, these are the projections of the densities on each axis, define the densities

\[X \rightarrow N(\mu_x, \sigma_x^2)\]

and

\[Y \rightarrow N(\mu_y, \sigma_y^2)\]

with its parameters. We can plot the 2D density as contour lines and the marginal densities on each axis

\includegraphics{_main_files/figure-latex/unnamed-chunk-152-1.pdf}

We can also plot the density in a 3D plot, where the \(Z\) axis is the value of the probability density.

\includegraphics{_main_files/figure-latex/unnamed-chunk-153-1.pdf}

If we keep the contour plots of the 2D distribution, we see that the fifth parameter \(\rho\) defines the direction on which the ellipses are elongated (mayor axis).

\includegraphics{_main_files/figure-latex/unnamed-chunk-154-1.pdf}

The density is threfore determined with 5 parameters.

\hypertarget{estimators}{%
\section{Estimators}\label{estimators}}

We can derive the estimator of all 5 parameters, if we formulate the likelihood function

\[L=\Pi_{i=1}^n f(y_i,x_i; \mu_x, \mu_y, \sigma^2_x, \sigma_y^2, \rho)\]
and maximize it for each parameter. As a result, we obtain the following estimators of the parameters.

The estimators for the means are the usual averages

\begin{itemize}
\tightlist
\item
  \(\bar{Y}=\frac{1}{n}\sum_{i=1}^n y_i\) estimates \(\mu_y\)
\item
  \(\bar{X}=\frac{1}{n}\sum_{i=1}^n x_i\) estimates \(\mu_x\)
\end{itemize}

The estimators for the variances are

\begin{itemize}
\tightlist
\item
  \(S^2_y=\frac{1}{n}\sum_{i=1}^n (y_i-\bar{y})^2\) estimates \(\sigma^2_y\)
\item
  \(S^2_x=\frac{1}{n}\sum_{i=1}^n (x_i-\bar{x})^2\) estimates \(\sigma^2_x\)
\end{itemize}

The estimator for the correlation

\begin{itemize}
\tightlist
\item
  \(R=\frac{\sum_{i=0}^n(X_i-\bar{X})(Y_i-\bar{Y})}{\sqrt{\sum_{i=1}^n(X_i-\bar{X})^2}\sqrt{\sum_{i=1}^n(Y_i-\bar{Y})^2}}\) estimates \(\rho\).
\end{itemize}

\hypertarget{correlation-coefficient}{%
\section{Correlation coefficient}\label{correlation-coefficient}}

\(R\) is then a \textbf{statistics} that can be computed from the data and we can take one value as an estimate of \(\rho\). The sampling distribution of \(R\) can be obtained if we transform it into a new variable (Fisher's z transformation)

\[Z=\frac{1}{2}\ln (\frac{1+R}{1-R})\]
The new variable \(Z\) is a normal variable

\[Z \rightarrow_{aprox} N(\frac{1}{2}\ln (\frac{1+\rho}{1-\rho}), \frac{1}{n-3})\]

with mean \(\frac{1}{2}\ln (\frac{1+\rho}{1-\rho})\) and variance \(\frac{1}{n-3}\).

As \(R\) estimates \(\rho\) we have that

\begin{itemize}
\item
  If \(R\) is near \(0\) then there is no linear relationship between \(y\) and \(x\) (the mayor and minor axes of the 2D plot are the x and y axes).
\item
  If \(R\) is near \(1\) there is strong evidence of a linear relationship between \(y\) and \(x\) (the mayor axis does not align with neither the x or the y axis).
\end{itemize}

\(R\) is then a measure of the statistical dependence between \(Y\) and \(X\). We can use it to test that hypothesis.

\hypertarget{hypothesis-contrast}{%
\section{Hypothesis contrast}\label{hypothesis-contrast}}

The hypothesis contrast for the independence on the relationship between \(Y\) and \(X\) can be formulated as

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\item
  \(H_0: \rho=0\) (null hypothesis). Therefre, \(Y\) and \(X\) are consider statistically \textbf{independent} and consequently \(f(y,x)=f(x)f(y)\)
\item
  \(H_1: \rho \neq 0\) (alternative hypothesis). Therefore, \(Y\) and \(X\) are statistically \textbf{dependent}.
\end{enumerate}

We then use the statistic \(R\) to test whether there is a dependency between \(y\) and \(x\). For testing the hypothesis contrast , we take the observed value of \(R\)

\[r_{obs}=\hat{\rho}=\frac{\sum_{i=0}^n(x_i-\bar{x})(y_i-\bar{y})}{\sqrt{\sum_{i=1}^n(x_i-\bar{x})^2}\sqrt{\sum_{i=1}^n(y_i-\bar{y})^2}}\]

and compute its \(pvalue\). That is the probability that we obtain a larger value if we repeat the sample when the \textbf{null hypothesis} is true. Under the null hypothesis \(\rho=0\), we then we compute the two-tailed \(pvalue\)

\[pvalue=2(1- F(|r_{obs}|)= 2(1- F_{normal}(|z_{obs}|)  \]

where

\[Z \rightarrow_{aprox} N(0, \frac{1}{n-3})\]

\textbf{Example (leptin and fat mass)}

\begin{verbatim}
import pandas as pd
from scipy.stats import pearsonr

data = pd.read_csv('https://alejandro-isglobal.github.io/SDA/data/leptinFatmass.txt', 
sep=' ')

leptin = data['leptin']
fatmass = data['fatmass']

pearsonr(leptin, fatmass)
\end{verbatim}

\begin{verbatim}
PearsonRResult(statistic=-0.27664924595293827, pvalue=0.00012143760304939414)
\end{verbatim}

For our data we have that the observed correlation coefficient is \(r_{obs}=-0.2766492\) and its transformed value

\[z_{obs}=ln((1-0.2766492)/(1+0.2766492))/2=-0.2840499\]

The \(pvalue\) is therefore

\[pvalue=2(1- F_{N(0,1/185)}(0.2840499))=0.0001\]

Therefore, since it is lower than \(\alpha=0.05\), we reject the null hypothesis that leptin and fat mass are independent. Note that leptin and fat mass are weakly correlated because \(r=-0.28\) but the correlation is highly significant because \(pvalue=0.0001\).

We should take this result with caution:

\begin{itemize}
\item
  Looking at the data we see that the fitted 2D probability function and we see that the \textbf{marginal} histograms are not quite normally distributed.
\item
  From literature we know that as we increase fat mass we should obtain \textbf{more} leptin, not the contrary, as it is released from adipose tissue.
\end{itemize}

\includegraphics{_main_files/figure-latex/unnamed-chunk-156-1.pdf}

So how can we improve our analysis, so that our results are as expected?

\hypertarget{regression-analysis}{%
\section{Regression analysis}\label{regression-analysis}}

To determine if \(leptin\) and \(fatmass\) are statistically independent, we can rather ask: What is the probability density of leptin at a \textbf{given value} of fat mass. Remember, two variables \(Y\) and \(X\) are independent if

\[P(Y|X)=P(Y)\]

Therefore, we first calculate the \textbf{conditional probability density} of \(Y\) (leptin) given \(X\) (fat mass) from the definition

\[f(y|x)=\frac{f(y,x)}{f(y)}
=N(\mu_{y|x}, \sigma^2_{y|x})\]

This turns up to be a normal distribution. The conditional probability is the profile, or a slice, of the 2D distribution at a given value of \(x\).

\includegraphics{_main_files/figure-latex/unnamed-chunk-157-1.pdf}

The mean of the conditional distribution is (the red dot)

\[\mu_{y|x}=\mu_y+\frac{\sigma_y\rho}{\sigma_x}(x-\mu_x)\]

If we manipulate this equation, we see that the \textbf{conditional mean} is a linear function of \(x\)

\[\mu_{y|x}=(\mu_y-\mu_x \frac{\sigma_y\rho}{\sigma_x})+\frac{\sigma_y \rho}{\sigma_x} x=\alpha + \beta x\]

where \(\alpha=\mu_y-\mu_x \beta\) and \(\beta=\frac{\sigma_y \rho}{\sigma_x}\). This line is called a \textbf{regression} line (red dotted line in the plot). That is, when we move along the \(X\) axis, the conditional mean of \(Y\) moves linearly.

The variance of the conditional density is

\[\sigma^2_{y|x}= \sigma_y^2(1-\rho^2)\]
Solving for \(\rho^2\), we have

\[\rho^2=\frac{\sigma_y^2-\sigma^2_{y|x}}{\sigma_y^2} \]
\(\rho^2\) is the proportion of the total variance that is explained by the regression line. For instance, \(\rho^2=1\) when there is no variability \(\sigma^2_{y|x}\); that is, all the observations fall on the regression line.

\hypertarget{linear-model-3}{%
\section{Linear model}\label{linear-model-3}}

Consider the \textbf{linear model} for the values of \(Y\) \textbf{conditioned} to the value of \(x_i\)

\[Y_{x_i} = \alpha + \beta x_i +E_{i}\]

with \textbf{Random error}:

\begin{itemize}
\item
  \(E_{i}\) is a \textbf{random variable} with expected value \(E(E_{i})=0\) and variance \(V(E_{i})=\sigma_{y|x}^2\)
\item
  \(i\) is the index of the observation: \(1...n\) (typically one for every \(x_i\) as \(x_i\) is continuous)
\end{itemize}

and the expected value of \(Y_{x_i}\) is the regression line

\[\mu_{y|x_i}=\alpha + \beta x_i\]
with

\[\alpha=\mu_y-\beta\mu_x\]
and

\[\beta=\rho\frac{\sigma_y}{\sigma_x}\]

\hypertarget{hypothesis-contrast-1}{%
\section{Hypothesis contrast}\label{hypothesis-contrast-1}}

Null hypothesis:

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  \(H_0: \beta=0\). \(Y\) and \(X\) are statistically \textbf{independent}, and therefore \(f(y|x)=f(y)\). If this is the case then the regression line is flat and we have the following model
\end{enumerate}

\includegraphics{_main_files/figure-latex/unnamed-chunk-158-1.pdf}

Note that all marginal probability (projection of the probability on the \(y\) axis) would be identical to all the conditional probabilities.

Alternative hypothesis:

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  \(H_1: \beta\neq 0\). \(Y\) and \(X\) are statistically \textbf{dependent}. If this is the case then we have the following model
\end{enumerate}

Note that all marginal probability would be the combination of the conditional probabilities.

\includegraphics{_main_files/figure-latex/unnamed-chunk-159-1.pdf}

\hypertarget{estimators-1}{%
\section{Estimators}\label{estimators-1}}

\(\beta\) is therefore our parameter of interest and we need a probability distribution to test its hypothesis contrast

\begin{itemize}
\tightlist
\item
  \(\beta=\rho\frac{\sigma_y}{\sigma_x}\) suggest the estimator for \(\beta\)
\end{itemize}

\[B=\frac{\sum_{i=1}^m(x_i-\bar{x})(Y_i-\bar{Y})}{\sum_{i=1}^n(x_i-\bar{x})^2}\]

\begin{itemize}
\tightlist
\item
  \(\alpha=\mu_y-\beta\mu_x\) suggests the estimator for \(\alpha\)
\end{itemize}

\[A=\bar{Y}- \hat{\beta}\bar{x}\]

The estimators \(A\) and \(B\) for \(\alpha\) and \(\beta\) can formally be derived from \textbf{minimizing the sum of squares} for the error given \(x_i\)

\[SSE=\sum_{i=1}^n(Y_i-\bar{Y_i})^2=\sum_{i=1}^n(Y_i-\alpha + \beta x_i)^2\]
with respect to \(\alpha\) and \(\beta\). If \(\bar{Y_i}\) is normal then

\[B \rightarrow N(\beta, \frac{n\sigma^2_y}{{(n-2)s^2_x}})\]

with mean \(E(B)=\beta\) and, therefore, it is an unbiased estimator.

\hypertarget{hypothesis-testing-2}{%
\section{Hypothesis testing}\label{hypothesis-testing-2}}

Under the null hypothesis, \(\beta=0\) and the standardized error from the null hypothesis are

\[\frac{\hat{\beta}}{\sqrt{\frac{ns^2_y}{{(n-2)s^2_x}}}} \rightarrow T(n-2)\]
follows a t-distribution with \(n-2\) degrees of freedom.

\textbf{Example (leptin and fatmass)}

We can perform the statistical test

\begin{verbatim}
import pandas as pd
from scipy.stats import pearsonr

data = pd.read_csv('https://alejandro-isglobal.github.io/SDA/data/leptinFatmass.txt', 
sep='\t')

model = ols('leptin ~ fatmass', data=data).fit()

print(model.summary())
\end{verbatim}

\begin{verbatim}
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 leptin   R-squared:                       0.077
Model:                            OLS   Adj. R-squared:                  0.072
Method:                 Least Squares   F-statistic:                     15.42
Date:                Mon, 04 Sep 2023   Prob (F-statistic):           0.000121
Time:                        09:33:40   Log-Likelihood:                -231.59
No. Observations:                 188   AIC:                             467.2
Df Residuals:                     186   BIC:                             473.7
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P>|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      3.7201      0.295     12.604      0.000       3.138       4.302
fatmass       -0.0226      0.006     -3.926      0.000      -0.034      -0.011
==============================================================================
Omnibus:                       10.660   Durbin-Watson:                   1.753
Prob(Omnibus):                  0.005   Jarque-Bera (JB):                4.983
Skew:                          -0.141   Prob(JB):                       0.0828
Kurtosis:                       2.254   Cond. No.                         249.
==============================================================================

\end{verbatim}

where the observed value of \(B\) is

\[\beta_{obs}= \frac{\sum_{i=1}^m(x_i-\bar{x})(y_i-\bar{y})}{\sum_{i=1}^n(x_i-\bar{x})^2}= -0.02262\]
and

\[\alpha_{obs}=\bar{y}-\beta_{obs}\bar{x}= 3.72012\]
and only \(7\%\) of the variability is explained by the regression line

\[R^2=0.07653\]

We can draw the regression line

\includegraphics{_main_files/figure-latex/unnamed-chunk-161-1.pdf}

We can see that the regression line is negative and there is quite a bit of dispersion about it. Remember that The correct way to interpret the line is to think that these are the values of \(Y\) conditioned on \(X\).

\hypertarget{stratified-analysis}{%
\section{Stratified analysis}\label{stratified-analysis}}

We can include other conditions in the regression, such as sex or age. In general it is important \textbf{to adjust} for other factors that we believe are correlated with the outcome \(Y\) and the condition \(x\), as they may explain part of the association.

Our study then includes the outcome \(Y\) with multiple regressors, or explanatory variables. For instance, the first observations of the complete dataset look like

\begin{verbatim}
##     leptin fatmass sex age
## 1 3.355677  45.721   F  45
## 2 2.272126  43.895   F  77
## 3 1.071584  47.871   M  79
## 4 3.921082  65.801   F  58
## 5 1.536867  56.644   M  42
## 6 1.177115  56.355   M  75
\end{verbatim}

Consider the previous regression and color the points according to their sex

\includegraphics{_main_files/figure-latex/unnamed-chunk-163-1.pdf}

We clearly see that the negative association between leptin and fat mass is given by the effect of sex. As males have lower leptin levels and higher fat mass then the negative correlation between leptin and fatma mass is due to sex.

If we run regression \textbf{separating}, or stratifying, by sex we find a positive association between leptin and fat mass, as it is expected from the litterature.

\includegraphics{_main_files/figure-latex/unnamed-chunk-164-1.pdf}

\hypertarget{multiple-regression}{%
\section{Multiple Regression}\label{multiple-regression}}

The linear regression can be extended to include several number of factors. Consider the \textbf{linear model} with one additional factor

\[Y_{jr} = \alpha + \beta x_j +\gamma z_{r}+E_{jr}\]

Here, our effect of interest is the coefficient \(\beta\) of \(x_i\) (leptin) and we want to adjust for the effect of \(z_j\) (sex). The mode is similar to the linear model we used for ANOVA, only that now the treatment effects are continous and depend on the variable \(X\).

When we include both sex and age as additional factors in the regression, we observe that there is a positive increase in leptin when we correct for sex. Males have a negative assotiation with leptin, compared with women, and age has an almost significant association with leptin. Now, everything fits.

\begin{verbatim}
import pandas as pd
from scipy.stats import pearsonr

data = pd.read_csv('https://alejandro-isglobal.github.io/SDA/data/leptinFatmass.txt', 
sep='\t')

model = ols('leptin ~ fatmass + sex + age', data=data).fit()

print(model.summary())
\end{verbatim}

\begin{verbatim}
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 leptin   R-squared:                       0.491
Model:                            OLS   Adj. R-squared:                  0.482
Method:                 Least Squares   F-statistic:                     59.09
Date:                Mon, 04 Sep 2023   Prob (F-statistic):           8.47e-27
Time:                        09:40:31   Log-Likelihood:                -175.66
No. Observations:                 188   AIC:                             359.3
Df Residuals:                     184   BIC:                             372.3
Df Model:                           3                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P>|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      1.4826      0.304      4.870      0.000       0.882       2.083
sex[T.M]      -1.6120      0.136    -11.864      0.000      -1.880      -1.344
fatmass        0.0276      0.006      4.596      0.000       0.016       0.039
age            0.0054      0.003      1.811      0.072      -0.000       0.011
==============================================================================
Omnibus:                        4.457   Durbin-Watson:                   1.685
Prob(Omnibus):                  0.108   Jarque-Bera (JB):                4.067
Skew:                          -0.345   Prob(JB):                        0.131
Kurtosis:                       3.207   Cond. No.                         475.
==============================================================================
\end{verbatim}

\hypertarget{multiple-regression-interaction}{%
\section{Multiple Regression interaction}\label{multiple-regression-interaction}}

We can furthermore include interactions between conditions in the regression.

Consider the \textbf{linear model}

\[Y_{jr} = \alpha + \beta x_{j} +\gamma z_{r} + \delta (xz)_{jr} +E_{jr}\]
The parameter \(\delta\) will add a contribution to the slope \(\beta\) that is \textbf{specific} to the condition \(r\). For instance, if \(z_i \in (0,1)\) then when \(z=0\) the coefficient of \(x_i\) is \(\beta\). But when \(z=1\) the coefficient of \(x_i\) is \(\beta+\gamma\).

In our example, if \(z\) is sex, then \(\gamma\) will test the differences in \(\beta\)s between males and females. We can furhter adjust by age.

\[Y_{jrs} = \alpha + \beta\times fatmass_{j} +\gamma\times sex_{r} + \delta\times (fatmass\times sex)_{jr} + \epsilon_s age+E_{jrs}\]

\begin{verbatim}
import pandas as pd
from scipy.stats import pearsonr

data = pd.read_csv('https://alejandro-isglobal.github.io/SDA/data/leptinFatmass.txt', 
sep='\t')

model = ols('leptin ~ fatmass*sex + age', data=data).fit()

print(model.summary())
\end{verbatim}

\begin{verbatim}

                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 leptin   R-squared:                       0.503
Model:                            OLS   Adj. R-squared:                  0.492
Method:                 Least Squares   F-statistic:                     46.25
Date:                Mon, 04 Sep 2023   Prob (F-statistic):           8.19e-27
Time:                        09:43:38   Log-Likelihood:                -173.41
No. Observations:                 188   AIC:                             356.8
Df Residuals:                     183   BIC:                             373.0
Df Model:                           4                                         
Covariance Type:            nonrobust                                         
====================================================================================
                       coef    std err          t      P>|t|      [0.025      0.975]
------------------------------------------------------------------------------------
Intercept            1.8001      0.337      5.337      0.000       1.135       2.466
sex[T.M]            -3.2180      0.775     -4.151      0.000      -4.748      -1.688
fatmass              0.0200      0.007      2.881      0.004       0.006       0.034
fatmass:sex[T.M]     0.0284      0.014      2.104      0.037       0.002       0.055
age                  0.0058      0.003      1.989      0.048    4.81e-05       0.012
==============================================================================
Omnibus:                        7.164   Durbin-Watson:                   1.699
Prob(Omnibus):                  0.028   Jarque-Bera (JB):                6.943
Skew:                          -0.459   Prob(JB):                       0.0311
Kurtosis:                       3.209   Cond. No.                     1.27e+03
==============================================================================
\end{verbatim}

Our data suggest a steeper increase of leptin with body fat in males than in females (interaction: \(0.028427\), \(pvalue=0.03\)), as we saw in the figures of the stratified analysis. The model now explains \(50\%\) of the variance \(R^2=0.5\)

\hypertarget{model-diagnostics}{%
\section{Model diagnostics}\label{model-diagnostics}}

All linear models have been made on the supposition that

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Errors are distributed normally
\item
  Errors have the same variance
\end{enumerate}

There are a number of plots to check that at least the data is consistent with these suppositions. In particular, we are interested to see that the residuals distribute symmetrically against the fitted values, revealing equal variance (homoscedasticity). We also want to check that the points in a quantile-quantile (QQ) plot fall in the line, revealing how close the rediduals distribute normally.

\includegraphics{_main_files/figure-latex/unnamed-chunk-167-1.pdf} \includegraphics{_main_files/figure-latex/unnamed-chunk-167-2.pdf} \includegraphics{_main_files/figure-latex/unnamed-chunk-167-3.pdf} \includegraphics{_main_files/figure-latex/unnamed-chunk-167-4.pdf}

\hypertarget{questions-14}{%
\section{Questions}\label{questions-14}}

\textbf{1)} We perform a regression analysis when we have

\textbf{\(\qquad\)a:} one categorical variable;
\textbf{\(\qquad\)b:} two categorical variables;
\textbf{\(\qquad\)c:} one continuous random variable;
\textbf{\(\qquad\)d:} two continuous random variables;

\textbf{2)} The correlation coefficient \(\rho\) is

\textbf{\(\qquad\)a:} a parameter of a 2D probability density;
\textbf{\(\qquad\)b:} a statistic of the relationship between two continuous variables;
\textbf{\(\qquad\)c:} the linear coefficient btween of two variables;
\textbf{\(\qquad\)d:} the variance explained by one continuous variable on other;

\textbf{3)} \(\beta\) in the linear model

\[Y_{x_i} = \alpha + \beta x_i +E_{i}\]

\textbf{\(\qquad\)a:} is a statistic that measure the linear relationship between \(x\) and \(y\);
\textbf{\(\qquad\)b:} is zero for the null hypothesis;
\textbf{\(\qquad\)c:} is a parameter with expected value of zero;
\textbf{\(\qquad\)d:} is the correlation between \(x\) and \(y\);

\textbf{4)} Why do we adjust for a variable in a regression coefficient?

\textbf{\(\qquad\)a:} to test the interaction between the variable and \(x\);
\textbf{\(\qquad\)b:} to stratify the relationship between \(x\) and \(y\);
\textbf{\(\qquad\)c:} to remove confounding in the relationship between \(x\) and \(y\);
\textbf{\(\qquad\)d:} to improve the significance of the relationship between \(x\) and \(y\);

\textbf{5)} The regression analysis assumes that

\textbf{\(\qquad\)a:} the errors have mean 0 and equal variances;
\textbf{\(\qquad\)b:} the errors distribute normally with mean 0 and equal variances;
\textbf{\(\qquad\)c:} the errors distribute normally with different mean and equal variances;
\textbf{\(\qquad\)d:} the errors distribute normally with different mean and different variances;

\hypertarget{practice-8}{%
\section{Practice}\label{practice-8}}

\hypertarget{practice-9}{%
\subsubsection{Practice}\label{practice-9}}

Load misophonia data \url{https://alejandro-isglobal.github.io/SDA/data/data_0.txt}

We have four measures of anxiety:

\begin{itemize}
\tightlist
\item
  Trait: ansiedad.rasgo (are you an anxious person?) continuous:0-100
\item
  State: ansiedad.estado (are you currently feeling anxious?) continuous:0-100
\item
  Diagnosed: ansiedad.medicada (have you been diagnosed with an anxiety disorder?) binary (si, no)
\item
  Excess: ansiedad.dif (difference between State and Trait)
\end{itemize}

We formulate the following hypothesis:

Participants who enrolled in the study had an increased level of anxiety from their baseline (trait) that is related to their:

\begin{itemize}
\tightlist
\item
  age
\item
  sex
\item
  anxiety state.
\end{itemize}

We are interested in the variable anxiety.dif, that is the observed \textbf{excess} of anxiety from the trait

\(excess = state - trait\)

Answer the following questions:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Are the state and trait of anxiety correlated?
\item
  Is excess in anxiety higher in older people?
\item
  Is excess in anxiety higher in older people after adjusting by sex?
\item
  Is the interaction between age and sex significant on excess anxiety?
\end{enumerate}

\hypertarget{group-work-sessions}{%
\chapter{Group Work sessions}\label{group-work-sessions}}

\hypertarget{objectives}{%
\section{Objectives}\label{objectives}}

\begin{itemize}
\item
  The objective of the work sessions is to work together with a student of a \textbf{different background} to perform a full analysis of the \textbf{misophonia dataset}.
\item
  The analysis is \textbf{open}. You can formulate the analysis you consider interesting, trying to cover as much as possible the material we have seen in theory and bootcamps.
\item
  \textbf{Justify} your analysis and \textbf{discuss} them.
\item
  We will have \textbf{two sessions} to perform the report that will be done in colab and handed in through \textbf{google classroom}.
\item
  \emph{Work together, follow your interests and have fun!}
\end{itemize}

Next, we \textbf{describe} the data and show an \textbf{example} of the kind of analysis that can be performed in both group sessions.

\hypertarget{misophonia-dataset}{%
\section{Misophonia dataset}\label{misophonia-dataset}}

Misophonia is a recently described neurological condition whereby patients feel strong anxiety when hearing particular noises (someone blowing their nose, mobile ringing, trains passing, etc..). It is believed that 5\% of the population suffers from this condition without knowing it, likely blaming their anxiety on other causes.

The misophonia dataset is from a recent (unpublished) study that aimed to describe the relationships between misophonia and anxiety, depression, and cephalometric measures (shape of the jaw).

\begin{verbatim}
##   Misofonia Misofonia.dic     Estado Estado.dic ansiedad.rasgo
## 1        si             4 divorciado          2             99
## 2        si             2     casado          1             75
## 3        no             0 divorciado          2             77
## 4        si             3     casado          1             95
## 5        no             0     casado          1             30
## 6        no             0     casado          1             30
##   ansiedad.rasgo.dic ansiedad.estado ansiedad.estado.dic ansiedad.medicada
## 1                  1              99                   1                no
## 2                  1              75                   1                no
## 3                  1              55                   0                no
## 4                  1              99                   1                no
## 5                  0              40                   0                no
## 6                  0              30                   0                no
##   ansiedad.medicada.dic depresion depresion.dic Sexo Edad CLASE
## 1                     0     33.65             1    M   44   III
## 2                     0     19.77             0    M   43    II
## 3                     0     29.57             0    M   24     I
## 4                     0      1.40             0    M   33   III
## 5                     0      5.98             0    H   41     I
## 6                     0     13.87             0    H   35     I
##   Angulo_convexidad protusion.mandibular Angulo_cuelloYtercio Subnasal_H
## 1              7.97                 13.0                 89.6        1.5
## 2             18.23                 -5.0                107.2        7.3
## 3             12.27                 11.5                101.4        5.0
## 4              7.81                 16.8                 75.3        2.7
## 5              9.81                 33.0                105.5        6.0
## 6             13.50                  2.0                105.0        7.0
##   cambio.autoconcepto Misofonia.post Misofonia.pre ansiedad.dif
## 1                   1             21            14            0
## 2                   0             14            13            0
## 3                  NA             NA            NA          -22
## 4                   1             NA            NA            4
## 5                  NA             NA            NA           10
## 6                  NA             NA            NA            0
\end{verbatim}

Here is the description of the variables

{[}1{]} ``Misofonia'': Binary (si: misophinic, no: no misophinic)\\
{[}2{]} ``Misofonia.dic'': Categorical (0: no misophinic, 1: severity 1, 2: severity 2, 3: severity 3, 4: severity 4)\\
{[}3{]} ``Estado'': Marital status (casado: married, soltero: single, viuda: widow, divorciado:divorced)\\
{[}4{]} ``Estado.dic'': Numeric Marital status\\
{[}5{]} ``ansiedad.rasgo'': Score from 0-100 with anxiety personality trait\\
{[}6{]} ``ansiedad.rasgo.dic'': Binary score (0,1) of anxiety personality trait\\
{[}7{]} ``ansiedad.estado'': Score from 0-100 with current state of anxiety\\
{[}8{]} ``ansiedad.estado.dic'': Binary score (0,1) with current state of anxiety\\
{[}9{]} ``ansiedad.medicada'': Diagnosed with anxiety disorder (si, no)\\
{[}10{]} ``ansiedad.medicada.dic'': Diagnosed with anxiety disorder (1, 0)\\
{[}11{]} ``depresion'': Score from 0-50 with current state of depression\\
{[}12{]} ``depresion.dic'' : Binary score (0,1) with current state of depression\\
{[}13{]} ``Sexo'': Male=H, Female:M\\
{[}14{]} ``Edad'': Age\\
{[}15{]} ``CLASE'': Type of jaw\\
{[}16{]} ``Angulo\_convexidad'': convexity angle\\
{[}17{]} ``protusion.mandibular'': Projection of the jaw
{[}18{]} ``Angulo\_cuelloYtercio'': angle between jaw and neck
{[}19{]} ``Subnasal\_H'': Nasal angle\\
{[}20{]} ``cambio.autoconcepto'': Whether people changed their self-concept after treatment.\\
{[}21{]} ``Misofonia.post'': Misophionia diagnosed (A-MISO) after an educational program, where patients were made aware of a condition called misophonia.\\
{[}22{]} ``Misofonia.pre'': Misophionia diagnosed (A-MISO) before an educational program, where patients were made aware of a condition called misophonia\\
{[}23{]} ``ansiedad.dif'': Difference between anxiety state and anxiety trait scores

\hypertarget{group-work-session-1-data-description}{%
\section{Group Work session 1: Data description}\label{group-work-session-1-data-description}}

When reporting the results of a study, we first describe the variables of interest in tables and figures.

\begin{itemize}
\tightlist
\item
  We describe demographics (sex, age, marital status, etc..)
\item
  We describe outcome variables (misophonia)
\item
  We describe explanatory variables (cephalometric measures, anxiety, depression)
\end{itemize}

\textbf{Example:}

Imagine we want to study the anxiety of participants in the misophonia study

We load the data

\begin{verbatim}
##   Misofonia Misofonia.dic     Estado Estado.dic ansiedad.rasgo
## 1        si             4 divorciado          2             99
## 2        si             2     casado          1             75
## 3        no             0 divorciado          2             77
## 4        si             3     casado          1             95
## 5        no             0     casado          1             30
## 6        no             0     casado          1             30
##   ansiedad.rasgo.dic ansiedad.estado ansiedad.estado.dic ansiedad.medicada
## 1                  1              99                   1                no
## 2                  1              75                   1                no
## 3                  1              55                   0                no
## 4                  1              99                   1                no
## 5                  0              40                   0                no
## 6                  0              30                   0                no
##   ansiedad.medicada.dic depresion depresion.dic Sexo Edad CLASE
## 1                     0     33.65             1    M   44   III
## 2                     0     19.77             0    M   43    II
## 3                     0     29.57             0    M   24     I
## 4                     0      1.40             0    M   33   III
## 5                     0      5.98             0    H   41     I
## 6                     0     13.87             0    H   35     I
##   Angulo_convexidad protusion.mandibular Angulo_cuelloYtercio Subnasal_H
## 1              7.97                 13.0                 89.6        1.5
## 2             18.23                 -5.0                107.2        7.3
## 3             12.27                 11.5                101.4        5.0
## 4              7.81                 16.8                 75.3        2.7
## 5              9.81                 33.0                105.5        6.0
## 6             13.50                  2.0                105.0        7.0
##   cambio.autoconcepto Misofonia.post Misofonia.pre ansiedad.dif
## 1                   1             21            14            0
## 2                   0             14            13            0
## 3                  NA             NA            NA          -22
## 4                   1             NA            NA            4
## 5                  NA             NA            NA           10
## 6                  NA             NA            NA            0
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  We describe the participants' sex, age, and marital status
\end{enumerate}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  Sex
\end{enumerate}

\begin{verbatim}
## sex
##         H         M 
## 0.3658537 0.6341463
\end{verbatim}

\includegraphics{_main_files/figure-latex/unnamed-chunk-170-1.pdf}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Age, mean and standard deviation
\end{enumerate}

\begin{verbatim}
## [1] 43.93496
\end{verbatim}

\begin{verbatim}
## [1] 14.18654
\end{verbatim}

\includegraphics{_main_files/figure-latex/unnamed-chunk-171-1.pdf} \includegraphics{_main_files/figure-latex/unnamed-chunk-171-2.pdf}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Age by sex, mean and standard deviation for males, and mean and standard deviation for females
\end{enumerate}

\begin{verbatim}
## [1] 40.64444
\end{verbatim}

\begin{verbatim}
## [1] 10.75165
\end{verbatim}

\begin{verbatim}
## [1] 45.83333
\end{verbatim}

\begin{verbatim}
## [1] 15.58339
\end{verbatim}

\includegraphics{_main_files/figure-latex/unnamed-chunk-172-1.pdf}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{3}
\tightlist
\item
  Marital status
\end{enumerate}

\begin{verbatim}
## Mstate
##     casado divorciado    soltero      viuda 
## 0.52032520 0.21138211 0.23577236 0.03252033
\end{verbatim}

\includegraphics{_main_files/figure-latex/unnamed-chunk-173-1.pdf}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  We describe the clinical outcome, for example, anxiety.
\end{enumerate}

We have four measures of anxiety:

\begin{itemize}
\tightlist
\item
  Trait: ansiedad.rasgo (are you an anxious person?) continuous:0-100
\item
  State: ansiedad.estado (are you currently feeling anxious?) continuous:0-100
\item
  Diagnosed: ansiedad.medicada (have you been diagnosed with an anxiety disorder?) binary (si, no)
\item
  Excess: ansiedad.dif (difference between State and Trait)
\end{itemize}

we describe these clinical outcomes

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  Trait (min, max, quantiles, median)
\end{enumerate}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##    1.00   60.00   80.00   68.77   89.00   99.00      15
\end{verbatim}

\includegraphics{_main_files/figure-latex/unnamed-chunk-175-1.pdf} \includegraphics{_main_files/figure-latex/unnamed-chunk-175-2.pdf}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  State (min, max, quantiles, median)
\end{enumerate}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##    1.00   45.00   77.00   67.85   90.00   99.00      15
\end{verbatim}

\includegraphics{_main_files/figure-latex/unnamed-chunk-176-1.pdf} \includegraphics{_main_files/figure-latex/unnamed-chunk-176-2.pdf}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Diagnosed
\end{enumerate}

\includegraphics{_main_files/figure-latex/unnamed-chunk-177-1.pdf}

We can look at relationships between outcomes

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{3}
\tightlist
\item
  Trait Vs Estate
\end{enumerate}

\includegraphics{_main_files/figure-latex/unnamed-chunk-178-1.pdf}

We can also look at the relationships between the clinical outcomes and the features of the participants

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{4}
\tightlist
\item
  Trait by sex
\end{enumerate}

\includegraphics{_main_files/figure-latex/unnamed-chunk-179-1.pdf}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{5}
\tightlist
\item
  State by sex
\end{enumerate}

\includegraphics{_main_files/figure-latex/unnamed-chunk-180-1.pdf}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{6}
\tightlist
\item
  Diagnosed by sex
\end{enumerate}

\begin{verbatim}
##          sex
## diagnosed  H  M
##        no 42 71
##        si  3  7
\end{verbatim}

\includegraphics{_main_files/figure-latex/unnamed-chunk-181-1.pdf}

\begin{verbatim}
##          sex
## diagnosed          H          M
##        no 0.93333333 0.91025641
##        si 0.06666667 0.08974359
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{7}
\tightlist
\item
  Trait Vs age
\end{enumerate}

\includegraphics{_main_files/figure-latex/unnamed-chunk-182-1.pdf}

\begin{enumerate}
\def\labelenumi{\roman{enumi}.}
\tightlist
\item
  State Vs age
\end{enumerate}

\includegraphics{_main_files/figure-latex/unnamed-chunk-183-1.pdf}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{9}
\tightlist
\item
  age by diagnosis
\end{enumerate}

\includegraphics{_main_files/figure-latex/unnamed-chunk-184-1.pdf}

\hypertarget{group-work-session-2-inference}{%
\section{Group Work session 2: Inference}\label{group-work-session-2-inference}}

When reporting the results of a study, we first describe the variables of interest in tables and figures.

\begin{itemize}
\tightlist
\item
  We describe demographics (sex, age, marital status, etc..)
\item
  We describe outcome variables (misophonia/axiety/depression/etc..)
\item
  We describe explanatory variables (cephalometric measures, anxiety, depression)
\end{itemize}

We then test the main hypotheses of the study.

\begin{itemize}
\item
  We state the main relationships we want to study and formulate the statistical hypothesis (Introduction)
\item
  We describe how the study was performed and the statistical methods to test the hypothesis (Methods)
\item
  We describe the results of the hypothesis tests with statistics, and significance measures.
\item
  We illustrate the results with figures.
\end{itemize}

\textbf{Example:}

Imagine we want to study the anxiety of participants in the misophonia study.

We formulate the following hypothesis:

Participants who enrolled in the study had an increased level of anxiety from their baseline (trait) that is related to their:

\begin{itemize}
\tightlist
\item
  age
\item
  sex
\item
  anxiety state.
\end{itemize}

We are interested in the variable anxiety.dif, that is the observed \textbf{excess} of anxiety from the trait

\(excess = state - trait\)

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Are the state and trait of anxiety correlated?
\end{enumerate}

\includegraphics{_main_files/figure-latex/unnamed-chunk-185-1.pdf}

\begin{verbatim}
## 
##  Pearson's product-moment correlation
## 
## data:  state and trait
## t = 23.282, df = 121, p-value < 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.8656964 0.9320106
## sample estimates:
##       cor 
## 0.9041609
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Is excess in anxiety higher than \(0\)?
\end{enumerate}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  We describe the Excess variable with summary statistics and figures (histogram)
\end{enumerate}

\includegraphics{_main_files/figure-latex/unnamed-chunk-186-1.pdf}

\begin{verbatim}
##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.     NA's 
## -45.0000  -8.0000   0.0000  -0.9187   8.0000  37.0000       15
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  We then perform a hypothesis test for the mean of anxiety excess \(H_0:\mu=0\) against \(H_1:\mu \neq 0\).
\end{enumerate}

\begin{verbatim}
## 
##  One Sample t-test
## 
## data:  excess
## t = -0.79192, df = 122, p-value = 0.4299
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  -3.215212  1.377814
## sample estimates:
##  mean of x 
## -0.9186992
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  We conclude: We do not see significant large values of the difference in anxiety; Enrollment in the study does not seem to detect individuals with an excess of anxiety.
\end{enumerate}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Is excess in anxiety higher than \(0\) for men and women separately?
\end{enumerate}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  We first describe the conditional distributions
\end{enumerate}

\includegraphics{_main_files/figure-latex/unnamed-chunk-188-1.pdf}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  We perform the hypothesis test for each sex separately
\end{enumerate}

\begin{verbatim}
## 
##  One Sample t-test
## 
## data:  excess[sex == "M"]
## t = -1.6994, df = 77, p-value = 0.09328
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  -5.5685793  0.4403741
## sample estimates:
## mean of x 
## -2.564103
\end{verbatim}

\begin{verbatim}
## 
##  One Sample t-test
## 
## data:  excess[sex == "H"]
## t = 1.1158, df = 44, p-value = 0.2706
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  -1.558796  5.425462
## sample estimates:
## mean of x 
##  1.933333
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  We conclude: We see that women (M) have a reduction in the excess of anxiety (almost significant), while men (H) had an increase (no significant). Why? perhaps because females tend to consult doctors before men do.
\end{enumerate}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Is the excess of anxiety significantly different between the sexes?
\end{enumerate}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  We test the hypothesis \(H_0:\mu_{men}=\mu_{women}\) against \(H_1:\mu_{men}\neq \mu_{women}\) using a group t.test
\end{enumerate}

\begin{verbatim}
## 
##  Welch Two Sample t-test
## 
## data:  excess[sex == "M"] and excess[sex == "H"]
## t = -1.9574, df = 102.39, p-value = 0.05302
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -9.05452801  0.05965621
## sample estimates:
## mean of x mean of y 
## -2.564103  1.933333
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  We conclude: we see that the difference between the group means is within the limit of significance with women having less excess anxiety than men.
\end{enumerate}

\begin{verbatim}
## 
## Call:
## lm(formula = excess ~ sex)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -42.436  -7.436   2.067   7.564  39.564 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)  
## (Intercept)    1.933      1.898   1.019   0.3105  
## sexM          -4.497      2.384  -1.887   0.0616 .
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 12.73 on 121 degrees of freedom
##   (15 observations deleted due to missingness)
## Multiple R-squared:  0.02858,    Adjusted R-squared:  0.02055 
## F-statistic:  3.56 on 1 and 121 DF,  p-value: 0.06158
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{3}
\tightlist
\item
  Is excess in anxiety higher in older people?
\end{enumerate}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  We make a plot between anxiety and age
\end{enumerate}

\includegraphics{_main_files/figure-latex/unnamed-chunk-192-1.pdf}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  We fit the regression model
\end{enumerate}

\[excess = \alpha + \beta * age + \epsilon\]

and test the hypothesis \(H_0: \beta=0\) against \(H_1: \beta\neq 0\)

\begin{verbatim}
## 
## Call:
## lm(formula = excess ~ age)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -43.151  -7.776   0.912   8.516  37.057 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)
## (Intercept)  -5.4917     3.7799  -1.453    0.149
## age           0.1041     0.0819   1.271    0.206
## 
## Residual standard error: 12.83 on 121 degrees of freedom
##   (15 observations deleted due to missingness)
## Multiple R-squared:  0.01317,    Adjusted R-squared:  0.005016 
## F-statistic: 1.615 on 1 and 121 DF,  p-value: 0.2062
\end{verbatim}

\includegraphics{_main_files/figure-latex/unnamed-chunk-193-1.pdf}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  We conclude: The association, while positive it is not significant. If we adjust by sex the association is a bit stronger but still not significant.
\end{enumerate}

\begin{verbatim}
## 
## Call:
## lm(formula = excess ~ age + sex)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -40.969  -6.849   0.781   8.019  34.124 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)  
## (Intercept) -3.57179    3.82807  -0.933   0.3527  
## age          0.13545    0.08198   1.652   0.1011  
## sexM        -5.20025    2.40467  -2.163   0.0326 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 12.64 on 120 degrees of freedom
##   (15 observations deleted due to missingness)
## Multiple R-squared:  0.05019,    Adjusted R-squared:  0.03436 
## F-statistic:  3.17 on 2 and 120 DF,  p-value: 0.04553
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{4}
\tightlist
\item
  Is excess in anxiety different between misophonic grades?
\end{enumerate}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\item
  We plot the excess anxiety across groups (boxplot)
  \includegraphics{_main_files/figure-latex/unnamed-chunk-195-1.pdf}
\item
  We test the hypothesizes \(H_0: \mu_{0}=\mu_{1} ... =\mu_{4}\) against \(H_1:\) at least one of them is different. We fit an ANOVA model.
\end{enumerate}

\begin{verbatim}
## 
## Call:
## lm(formula = excess ~ misophonic)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -39.902  -8.257   1.243   7.152  42.098 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)   
## (Intercept)   -5.098      1.944  -2.622  0.00988 **
## misophonic1   17.098      5.896   2.900  0.00445 **
## misophonic2    3.854      2.822   1.366  0.17464   
## misophonic3    6.904      2.962   2.331  0.02148 * 
## misophonic4    7.986      4.582   1.743  0.08391 . 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 12.45 on 118 degrees of freedom
##   (15 observations deleted due to missingness)
## Multiple R-squared:  0.09483,    Adjusted R-squared:  0.06414 
## F-statistic:  3.09 on 4 and 118 DF,  p-value: 0.01847
\end{verbatim}

\begin{verbatim}
## Analysis of Variance Table
## 
## Response: excess
##             Df Sum Sq Mean Sq F value  Pr(>F)  
## misophonic   4   1915  478.76  3.0904 0.01847 *
## Residuals  118  18280  154.92                  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  We conclude: We see that anxiety excess of misophonia grade 1 is significantly higher than misophonia grade 0 (no misophonia), as it is grade 3. The ANOVA table shows that we accept the alternative hypothesis, where the differences between groups are significantly higher than within groups.
\end{enumerate}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{5}
\tightlist
\item
  Are the differences in excess anxiety between monophonic grades modulated by sex?
\end{enumerate}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  We plot excess anxiety for each misophonic group, for men and women separately
\end{enumerate}

\includegraphics{_main_files/figure-latex/unnamed-chunk-197-1.pdf}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  We perform an ANOVA test for the interaction
\end{enumerate}

\begin{verbatim}
## Analysis of Variance Table
## 
## Response: excess
##                 Df  Sum Sq Mean Sq F value  Pr(>F)  
## misophonic       4  1915.0  478.76  3.0366 0.02026 *
## sex              1   179.7  179.74  1.1400 0.28792  
## misophonic:sex   4   284.5   71.13  0.4512 0.77137  
## Residuals      113 17815.9  157.66                  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  We conclude: We do not see a significant interaction (modulation) of the effect of sex on the group differences. We cannot say that the profiles of anxiety excess across misophonia grades are different between sexes.
\end{enumerate}

\hypertarget{solutions-to-questions}{%
\chapter{Solutions to Questions}\label{solutions-to-questions}}

\hypertarget{chapter-2}{%
\section{Chapter 2}\label{chapter-2}}

\(\qquad\) 1.c; \(\qquad\) 2.a; \(\qquad\) 3.d; \(\qquad\) 4.d; \(\qquad\) 5.b

\hypertarget{chapter-3}{%
\section{Chapter 3}\label{chapter-3}}

\(\qquad\) 1.a; \(\qquad\) 2.b; \(\qquad\) 3.b; \(\qquad\) 4.b; \(\qquad\) 5.a

\hypertarget{chapter-4}{%
\section{Chapter 4}\label{chapter-4}}

\(\qquad\) 1.c; \(\qquad\) 2.b; \(\qquad\) 3.d; \(\qquad\) 4.b; \(\qquad\) 5.b

\hypertarget{chapter-5}{%
\section{Chapter 5}\label{chapter-5}}

\(\qquad\) 1.d; \(\qquad\) 2.c; \(\qquad\) 3.d; \(\qquad\) 4.d; \(\qquad\) 5.b

\hypertarget{chapter-7}{%
\section{Chapter 7}\label{chapter-7}}

\(\qquad\) 1.d; \(\qquad\) 2.a; \(\qquad\) 3.d; \(\qquad\) 4.a; \(\qquad\) 5.b

\hypertarget{chapter-8}{%
\section{Chapter 8}\label{chapter-8}}

\(\qquad\) 1.b; \(\qquad\) 2.b; \(\qquad\) 3.a

\hypertarget{chapter-9}{%
\section{Chapter 9}\label{chapter-9}}

\(\qquad\) 1.a; \(\qquad\) 2.a; \(\qquad\) 3.c; \(\qquad\) 4.d; \(\qquad\) 5.b

\hypertarget{chapter-10}{%
\section{Chapter 10}\label{chapter-10}}

\(\qquad\) 1.a; \(\qquad\) 2.b; \(\qquad\) 3.d; \(\qquad\) 4.d; \(\qquad\) 5.c

\hypertarget{chapter-11}{%
\section{Chapter 11}\label{chapter-11}}

\(\qquad\) 1.b; \(\qquad\) 2.b; \(\qquad\) 3.b

\hypertarget{chapter-12}{%
\section{Chapter 12}\label{chapter-12}}

\(\qquad\) 1.d; \(\qquad\) 2.d; \(\qquad\) 3.b; \(\qquad\) 4.a

\hypertarget{chapter-13}{%
\section{Chapter 13}\label{chapter-13}}

\(\qquad\) 1.b; \(\qquad\) 2.a; \(\qquad\) 3.d; \(\qquad\) 4.b; \(\qquad\) 5.b

\hypertarget{chapter-15}{%
\section{Chapter 15}\label{chapter-15}}

\(\qquad\) 1.b; \(\qquad\) 2.d; \(\qquad\) 3.c; \(\qquad\) 4.d; \(\qquad\) 5.a

\hypertarget{chapter-16}{%
\section{Chapter 16}\label{chapter-16}}

\(\qquad\) 1.c; \(\qquad\) 2.b; \(\qquad\) 3.b; \(\qquad\) 4.b; \(\qquad\) 5.a

\hypertarget{chapter-17}{%
\section{Chapter 17}\label{chapter-17}}

\(\qquad\) 1.d; \(\qquad\) 2.d; \(\qquad\) 3.a; \(\qquad\) 4.b; \(\qquad\) 5.c

\hypertarget{chapter-18}{%
\section{Chapter 18}\label{chapter-18}}

\(\qquad\) 1.d; \(\qquad\) 2.a; \(\qquad\) 3.b; \(\qquad\) 4.c; \(\qquad\) 5.b

  \bibliography{book.bib,packages.bib}

\end{document}
